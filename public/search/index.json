[{"content":" Introduction åŠŸèƒ½å¯Œé›†åˆ†ææ˜¯ä¸€ç§ç”¨äºåˆ†æåŸºå› é›†åˆæˆ–åŸºå› ç»„æ•°æ®ä¸­åŠŸèƒ½æ¨¡å¼å¯Œé›†ç¨‹åº¦çš„è®¡ç®—æ–¹æ³•ã€‚å®ƒå¯ä»¥å¸®åŠ©æ­ç¤ºåœ¨ç‰¹å®šç”Ÿç‰©å­¦èƒŒæ™¯ä¸‹ï¼Œå“ªäº›åŠŸèƒ½æ¨¡å—ã€ä»£è°¢é€šè·¯ã€åŸºå› å®¶æ—ç­‰åœ¨ç»Ÿè®¡ä¸Šå¯Œé›†æˆ–æ˜¾è‘—è¿‡è¡¨ç¤ºã€‚\nåŠŸèƒ½å¯Œé›†åˆ†æé€šå¸¸åŒ…æ‹¬ä»¥ä¸‹æ­¥éª¤ï¼š\næ•°æ®é¢„å¤„ç†ï¼šæ ¹æ®ç ”ç©¶é—®é¢˜å’Œæ•°æ®ç±»å‹ï¼Œé€‰æ‹©é€‚å½“çš„åŸºå› é›†åˆæˆ–åŸºå› ç»„æ•°æ®ï¼Œä¾‹å¦‚åŸºå› è¡¨è¾¾æ•°æ®ã€åŸºå› æ³¨é‡Šæ•°æ®æˆ–åŸºå› åˆ—è¡¨ã€‚\næ³¨é‡Šå’ŒåŠŸèƒ½åˆ†ç±»ï¼šå°†åŸºå› é›†åˆä¸å·²çŸ¥çš„åŠŸèƒ½æ³¨é‡Šæ•°æ®åº“è¿›è¡Œæ¯”è¾ƒï¼Œä¾‹å¦‚åŸºå› æœ¬ä½“è®ºï¼ˆGene Ontologyï¼‰ã€KEGGï¼ˆKyoto Encyclopedia of Genes and Genomesï¼‰é€šè·¯æ•°æ®åº“ç­‰ã€‚è¿™ä¸€æ­¥å°†åŸºå› ä¸ç‰¹å®šçš„åŠŸèƒ½æˆ–ç”Ÿç‰©è¿‡ç¨‹ç›¸å…³è”ã€‚\nç»Ÿè®¡åˆ†æï¼šä½¿ç”¨åˆé€‚çš„ç»Ÿè®¡æ–¹æ³•ï¼Œå¦‚è¶…å‡ ä½•åˆ†å¸ƒã€Fisherâ€™s exact testã€GSEAï¼ˆåŸºå› é›†å¯Œé›†åˆ†æï¼‰ç­‰ï¼Œè¯„ä¼°æ¯ä¸ªåŠŸèƒ½çš„å¯Œé›†ç¨‹åº¦ã€‚è¿™äº›æ–¹æ³•ä¼šè®¡ç®—ä¸€ä¸ªå¾—åˆ†æˆ–På€¼ï¼Œç”¨äºåˆ¤æ–­åŠŸèƒ½æ˜¯å¦åœ¨ç»™å®šåŸºå› é›†åˆä¸­å¯Œé›†ã€‚\nç»“æœè§£é‡Šå’Œå¯è§†åŒ–ï¼šæ ¹æ®ç»Ÿè®¡åˆ†æçš„ç»“æœï¼Œè¯†åˆ«åœ¨ç»™å®šæ¡ä»¶ä¸‹æ˜¾è‘—å¯Œé›†çš„åŠŸèƒ½æ¨¡å—ï¼Œå¹¶å°†ç»“æœè¿›è¡Œè§£é‡Šå’Œå¯è§†åŒ–ã€‚è¿™å¯ä»¥å¸®åŠ©ç ”ç©¶äººå‘˜ç†è§£åŸºå› é›†åˆæˆ–åŸºå› ç»„æ•°æ®ä¸­çš„ç”Ÿç‰©å­¦ç‰¹å¾å’ŒåŠŸèƒ½ã€‚\nåŠŸèƒ½å¯Œé›†åˆ†æå¯åº”ç”¨äºå¤šä¸ªç ”ç©¶é¢†åŸŸï¼Œå¦‚åŸºå› è¡¨è¾¾åˆ†æã€è›‹ç™½è´¨ç»„å­¦ã€å¾®ç”Ÿç‰©ç»„å­¦ç­‰ã€‚å®ƒå¯ä»¥å¸®åŠ©ç ”ç©¶äººå‘˜ç†è§£åŸºå› é›†åˆçš„ç”Ÿç‰©å­¦æ„ä¹‰ï¼Œä»è€Œæ­ç¤ºç”Ÿç‰©è¿‡ç¨‹ã€ä»£è°¢é€šè·¯ã€ç»†èƒç»„åˆ†ç­‰åœ¨ç‰¹å®šæ¡ä»¶ä¸‹çš„è°ƒæ§æœºåˆ¶ï¼Œå¹¶ä¸ºè¿›ä¸€æ­¥çš„å®éªŒè®¾è®¡å’Œç ”ç©¶æä¾›æœ‰ä»·å€¼çš„æŒ‡å¯¼ã€‚\n$$ P=1-\\sum_{i=0}^{m-1}\\frac{C_M^iC_{N-M}^{n-i}}{C_N^n} $$\n**Pï¼š**æŸpathwayçš„å¯Œé›†æ˜¾è‘—æ€§ï¼›**Nï¼š**æ³¨é‡Šä¸ŠKEGGçš„æ‰€æœ‰åŸºå› çš„æ•°é‡ï¼›**nï¼š**æ‰€æœ‰æ˜¾è‘—å·®å¼‚çš„åŸºå› æ•°é‡ï¼›**Mï¼š**æ‰€æœ‰åŸºå› ä¸­æ³¨é‡Šåˆ°æŸpathwayçš„åŸºå› æ•°é‡ï¼›**mï¼š**æ‰€æœ‰å·®å¼‚åŸºå› ä¸­æ³¨é‡Šåˆ°æŸpathwayçš„åŸºå› æ•°é‡\nRå‡½æ•°phyper:\n1 2 1-phyper(k-1,m, N-m, n,) phyper(k-1,M, N-M, n, lower.tail=F) Table 1: Methods for microbial enrichment analysis. Method Type Notes Hypergeometric test / Fisherâ€™ exact test algorithm The most common method used in enrichment analysis. There are many enrichment analysis platforms or software developed based on it, including DAVID, clusterprofile, etc. Gene set enrichment analysis (GSEA) software Gene Set Enrichment Analysis (GSEA) is a computational method that determines whether an a priori defined set of genes shows statistically significant, concordant differences between two biological states (e.g.Â phenotypes). Clusterprofiler R package ClusterProfiler automates the process of biological-term classification and the enrichment analysis of gene clusters, which calculates enrichment test for GO terms and KEGG pathways based on hypergeometric distribution. Reporter score algorithm The plus or minus sign of reporter score does not represent regulation direction. Reporter feature analysis algorithm Reporter feature can achieve enrichment ananlysis for non-directional, mixed-directional up/down-regulation, and distinct-directional up/down-regulation classes. Piano R package Piano is a R package that implements the Reporter Features algorithm. Piano performs gene set analysis using various statistical methods, from different gene level statistics and a wide range of gene-set collections. Furthermore, the Piano package contains functions for combining the results of multiple runs of gene set analyses. Reporter scoreæ˜¯ä¸€ç§æ”¹è‰¯çš„å¾®ç”Ÿç‰©å¯Œé›†åˆ†æçš„æ–°æ–¹æ³•ï¼Œæ­¤æ–¹æ³•æœ€åˆæ˜¯ä¸ºäº†æ­ç¤ºä»£è°¢ç½‘ç»œä¸­çš„è½¬å½•è°ƒæ§æ¨¡å¼è€Œå¼€å‘çš„ï¼Œç›®å‰å·²è¢«å¼•å…¥å¾®ç”Ÿç‰©ç ”ç©¶ä¸­è¿›è¡ŒåŠŸèƒ½å¯Œé›†åˆ†æã€‚\nMethod Reporter scoreç®—æ³•æœ€åˆç”±Patilå’ŒNielsenäº2005å¹´å¼€å‘ï¼Œç”¨äºè¯†åˆ«ä»£è°¢è°ƒèŠ‚çƒ­ç‚¹çš„ä»£è°¢ç‰© (1)ã€‚\nåº”ç”¨äºå®åŸºå› ç»„åˆ†æï¼Œåˆ™æ˜¯åŸºäºåŸºå› çš„KOï¼ˆKEGG orthologyï¼ŒåŒæºåŸºå› ï¼‰æ³¨é‡Šï¼Œè·å¾—KOçš„å·®å¼‚ä¿¡æ¯ï¼Œå†â€ä¸Šå‡â€è‡³KEGG pathwayçš„åŠŸèƒ½å±‚é¢ã€‚ä¸»è¦æ­¥éª¤å¦‚ä¸‹ï¼š\nä½¿ç”¨Wilcoxonç§©å’Œæ£€éªŒè·å¾—ä¸¤åˆ†ç»„é—´æ¯ä¸ªKOå·®å¼‚æ˜¾è‘—æ€§çš„På€¼ï¼ˆå³$P_{koi}$ï¼Œiä»£è¡¨æŸä¸ªKOï¼‰ï¼›\né‡‡ç”¨é€†æ­£æ€åˆ†å¸ƒï¼Œå°†æ¯ä¸ªKOçš„På€¼è½¬åŒ–ä¸ºZå€¼ï¼ˆ$Z_{koi}$ï¼‰,å…¬å¼ï¼š$Z_{koi}=\\theta ^{-1}(1-P_{koi})$ï¼›\nå°†KOâ€ä¸Šå‡â€ä¸ºpathwayï¼š$Z_{koi}$ï¼Œè®¡ç®—é€šè·¯çš„Zå€¼,$Z_{pathway}=\\frac{1}{\\sqrt{k}}\\sum Z_{koi}$ï¼Œå…¶ä¸­kè¡¨ç¤ºå¯¹åº”é€šè·¯å…±æ³¨é‡Šåˆ°kä¸ªKOï¼›\nè¯„ä¼°æ˜¾è‘—ç¨‹åº¦ï¼šç½®æ¢ï¼ˆpermutationï¼‰1000æ¬¡ï¼Œè·å¾—$Z_{pathway}$çš„éšæœºåˆ†å¸ƒï¼Œå…¬å¼ï¼š$Z_{adjustedpathway}=(Z_{pathway}-\\mu _k)/\\sigma _k$ï¼Œ$Î¼_k$ä¸ºéšæœºåˆ†å¸ƒçš„å‡å€¼ï¼Œ$Ïƒ_k$ä¸ºéšæœºåˆ†å¸ƒçš„æ ‡å‡†å·®ã€‚\næœ€ç»ˆè·å¾—çš„$Z_{adjustedpathway}$ï¼Œå³ä¸ºæ¯æ¡ä»£è°¢é€šè·¯å¯Œé›†çš„Reporter scoreå€¼ï¼ŒReporter scoreæ˜¯éæ–¹å‘æ€§çš„ï¼ŒReporter scoreè¶Šå¤§ä»£è¡¨å¯Œé›†è¶Šæ˜¾è‘—ï¼Œä½†ä¸èƒ½æŒ‡ç¤ºé€šè·¯çš„ä¸Šä¸‹è°ƒä¿¡æ¯ã€‚\nMisuse æœ€è¿‘æœ‰ä¸€ç¯‡æ–‡ç« å°±è®¨è®ºäº†reporter-scoreçš„æ­£è´Ÿå·è¯¯ç”¨é—®é¢˜ (2)ï¼š\nhttps://mp.weixin.qq.com/s?__biz=MzUzMjA4Njc1MA==\u0026mid=2247507105\u0026idx=1\u0026sn=d5a0f0aaf176e245de7976f0a48f87a8#rd\nä¸»è¦ç»“è®ºæ˜¯ reporter scoreç®—æ³•ï¼ˆä¸Šè¿°ï¼‰æ˜¯ä¸€ç§å¿½ç•¥é€šè·¯ä¸­KOsä¸Š/ä¸‹è°ƒèŠ‚ä¿¡æ¯çš„å¯Œé›†æ–¹æ³•ï¼Œç›´æ¥å°†reporter scoreçš„ç¬¦å·è§†ä¸ºé€šè·¯çš„è°ƒèŠ‚æ–¹å‘æ˜¯ä¸æ­£ç¡®çš„ã€‚\nä½†æ˜¯æˆ‘ä»¬åº”è¯¥å¯ä»¥å°†å…¶æ”¹ä¸ºèƒ½å¤Ÿè€ƒè™‘é€šè·¯å†…KOä¸Šä¸‹è°ƒçš„æ–¹å¼ï¼Œæˆ‘ç§°ä¸ºdirected æ¨¡å¼, å‚è€ƒè‡ªhttps://github.com/wangpeng407/ReporterScoreã€‚\nå…·ä½“æ­¥éª¤å¦‚ä¸‹:\nä½¿ç”¨Wilcoxonç§©å’Œæ£€éªŒæˆ–è€…t.testè·å¾—ä¸¤åˆ†ç»„é—´æ¯ä¸ªKOå·®å¼‚æ˜¾è‘—æ€§çš„På€¼ï¼ˆå³$P_{koi}$ï¼Œiä»£è¡¨æŸä¸ªKOï¼‰ï¼Œå†å°†På€¼é™¤ä»¥2ï¼Œå³å°†(0,1]çš„èŒƒå›´å˜ä¸º(0,0.5]ï¼Œ$P_{koi}=P_{koi}/2$ï¼›\né‡‡ç”¨é€†æ­£æ€åˆ†å¸ƒï¼Œå°†æ¯ä¸ªKOçš„På€¼è½¬åŒ–ä¸ºZå€¼ï¼ˆ$Z_{koi}$ï¼‰,å…¬å¼ï¼š$Z_{koi}=\\theta ^{-1}(1-P_{koi})$ï¼Œç”±äºä¸Šè¿°På€¼å°äº0.5ï¼Œåˆ™Zå€¼å°†å…¨éƒ¨å¤§äº0ï¼›\nè€ƒè™‘æ¯ä¸ªKOæ˜¯ä¸Šè°ƒè¿˜æ˜¯ä¸‹è°ƒï¼Œè®¡ç®—$\\Delta KO_i$ï¼Œ\n$$ \\Delta KO_i=\\overline {KO_{i_{g1}}}-\\overline {KO_{i_{g2}}} $$\nå…¶ä¸­ï¼Œ$\\overline {KO_{i_{g1}}}$ æ˜¯ç»„1çš„$KO_i$ çš„å¹³å‡ä¸°åº¦,$\\overline {KO_{i_{g2}}}$ æ˜¯ç»„2çš„$KO_i$ çš„å¹³å‡ä¸°åº¦ï¼Œç„¶åï¼š\n$$ Z_{koi} = \\begin{cases} -Z_{koi}, \u0026amp; (\\Delta KO_i\u0026lt;0) \\ Z_{koi}, \u0026amp; (\\Delta KO_i \\ge 0) \\end{cases} $$\nè¿™æ ·çš„è¯$Z_{koi}$å¤§äº0ä¸ºä¸Šè°ƒï¼Œ$Z_{koi}$å°äº0ä¸ºä¸‹è°ƒã€‚\nå°†KOâ€ä¸Šå‡â€ä¸ºpathwayï¼š$Z_{koi}$ï¼Œè®¡ç®—é€šè·¯çš„Zå€¼,$Z_{pathway}=\\frac{1}{\\sqrt{k}}\\sum Z_{koi}$ï¼Œå…¶ä¸­kè¡¨ç¤ºå¯¹åº”é€šè·¯å…±æ³¨é‡Šåˆ°kä¸ªKOï¼›\nè¯„ä¼°æ˜¾è‘—ç¨‹åº¦ï¼šç½®æ¢ï¼ˆpermutationï¼‰1000æ¬¡ï¼Œè·å¾—$Z_{pathway}$çš„éšæœºåˆ†å¸ƒï¼Œå…¬å¼ï¼š$Z_{adjustedpathway}=(Z_{pathway}-\\mu _k)/\\sigma _k$ï¼Œ$Î¼_k$ä¸ºéšæœºåˆ†å¸ƒçš„å‡å€¼ï¼Œ$Ïƒ_k$ä¸ºéšæœºåˆ†å¸ƒçš„æ ‡å‡†å·®ã€‚\næœ€ç»ˆè·å¾—çš„$Z_{adjustedpathway}$ï¼Œå³ä¸ºæ¯æ¡ä»£è°¢é€šè·¯å¯Œé›†çš„Reporter scoreå€¼ï¼Œåœ¨è¿™ç§æ¨¡å¼ä¸‹ï¼ŒReporter scoreæ˜¯éæ–¹å‘æ€§çš„ï¼Œæ›´å¤§çš„æ­£å€¼ä»£è¡¨æ˜¾è‘—ä¸Šè°ƒå¯Œé›†ï¼Œæ›´å°çš„è´Ÿå€¼ä»£è¡¨æ˜¾è‘—ä¸‹è°ƒå¯Œé›†ã€‚\nä½†æ˜¯è¿™ç§æ–¹æ³•çš„ç¼ºç‚¹æ˜¯å½“ä¸€æ¡é€šè·¯æ˜¾è‘—ä¸Šè°ƒKOå’Œæ˜¾è‘—ä¸‹è°ƒKOå·®ä¸å¤šæ—¶ï¼Œæœ€ç»ˆçš„Reporter scoreç»å¯¹å€¼å¯èƒ½ä¼šè¶‹è¿‘0ï¼Œæˆä¸ºæ²¡æœ‰è¢«æ˜¾è‘—å¯Œé›†çš„é€šè·¯ã€‚\nRpackage å› ä¸ºæˆ‘çœ‹ç›®å‰æ²¡æœ‰ç°æˆçš„å·¥å…·å®ŒæˆReporter Scoreåˆ†æï¼ˆé™¤äº†ä¸€äº›äº‘å¹³å°ï¼Œä½†å¯èƒ½ä¸å¤ªæ–¹ä¾¿ï¼‰ï¼Œæ‰€ä»¥æˆ‘å‚è€ƒhttps://github.com/wangpeng407/ReporterScore å†™äº†ä¸€ä¸ªRåŒ…å¸®åŠ©åˆ†æï¼ˆè™½ç„¶ä¹Ÿä¸æ˜¯ç‰¹åˆ«å¤æ‚ï¼‰\nåœ°å€ï¼šhttps://github.com/Asa12138/ReporterScore\nå®‰è£…æ–¹æ³•ï¼š\n1 2 install.packages(\u0026#34;devtools\u0026#34;) devtools::install_github(\u0026#39;Asa12138/ReporterScore\u0026#39;,dependencies=T) ä½¿ç”¨æ–¹æ³•ï¼š\n1 2 3 4 5 6 7 library(ReporterScore) library(dplyr) library(ggplot2) #å‡†å¤‡KOä¸°åº¦è¡¨å’Œå®éªŒmetadata data(KO_test) head(KO_abundance) ## CG1 CG2 CG3 CG4 CG5 CG6 ## K03169 0.002653545 0.005096380 0.002033923 0.000722349 0.003468322 0.001483028 ## K07133 0.000308237 0.000280458 0.000596527 0.000859854 0.000308719 0.000878098 ## K03088 0.002147068 0.002030742 0.003797459 0.004161979 0.002076596 0.003091182 ## CG7 CG8 CG9 CG10 CG11 CG12 ## K03169 0.002261685 0.004114644 0.002494258 0.002793671 0.004053729 0.002437170 ## K07133 0.000525566 0.000356138 0.000445409 0.000268306 0.000293546 0.000465780 ## K03088 0.003098506 0.002558730 0.002896506 0.002618472 0.002367986 0.002082786 ## CG13 CG14 CG15 EG1 EG2 EG3 ## K03169 0.002187500 0.001988374 0.002304885 0.003317368 0.001150671 0.002610814 ## K07133 0.000507992 0.000409447 0.000327910 0.002916018 0.004820742 0.001973789 ## K03088 0.002680792 0.003066870 0.002975895 0.002257401 0.002889640 0.001997586 ## EG4 EG5 EG6 EG7 EG8 EG9 ## K03169 0.000900673 0.001545374 0.001640295 0.001445024 0.001096728 0.001026556 ## K07133 0.003359927 0.001913932 0.001384079 0.001321643 0.002376473 0.004391014 ## K03088 0.002613441 0.002803388 0.002251835 0.002981244 0.002944061 0.003113215 ## EG10 EG11 EG12 EG13 EG14 EG15 ## K03169 0.001513195 0.001812732 0.003256782 0.006723067 0.001769819 0.001233307 ## K07133 0.002479040 0.003484868 0.000790457 0.000127818 0.000634529 0.004746572 ## K03088 0.003177522 0.002790092 0.001607913 0.002574928 0.001662157 0.002614489 ## [ reached 'max' / getOption(\u0026quot;max.print\u0026quot;) -- omitted 3 rows ] 1 head(Group_tab) ## Group ## CG1 CG ## CG2 CG ## CG3 CG ## CG4 CG ## CG5 CG ## CG6 CG åˆ†ç»„æ£€éªŒè·å¾—På€¼,threadså¤šçº¿ç¨‹å¯åŠ é€Ÿ 1 ko_pvalue=ko_test(KO_abundance,\u0026#34;Group\u0026#34;,Group_tab,threads = 1,verbose = F) ## Compared groups: CG and EG ## Total KO number: 4535 ## Time use: 1.348 1 head(ko_pvalue) ## KO_id avg_CG sd_CG avg_EG sd_EG diff_mean ## 1 K03169 0.0026728975 0.0011094132 0.0020694937 0.0014922004 0.00060340387 ## 2 K07133 0.0004554658 0.0001951678 0.0024480601 0.0014916566 -0.00199259427 ## 3 K03088 0.0027767713 0.0006253559 0.0025519275 0.0004966801 0.00022484380 ## 4 K03530 0.0005779169 0.0008952163 0.0005197504 0.0001435245 0.00005816647 ## 5 K06147 0.0020807307 0.0007731661 0.0014321838 0.0004273716 0.00064854693 ## 6 K05349 0.0021064422 0.0005243558 0.0017419317 0.0005382770 0.00036451047 ## p.value ## 1 0.03671754164 ## 2 0.00002654761 ## 3 0.48636476395 ## 4 0.01125600770 ## 5 0.00987482265 ## 6 0.12614740102 2.å°†På€¼çŸ«æ­£å¹¶è½¬ä¸ºZ-Scoreï¼Œè¿™é‡Œæä¾›ä¸¤ç§æ–¹æ³•ï¼ˆmixedå°±æ˜¯ç»å…¸çš„æ–¹æ³•ï¼Œå¦ä¸€ç§æ˜¯directedæ–¹æ³•ï¼‰\n1 ko_stat=pvalue2zs(ko_pvalue,mode=\u0026#34;directed\u0026#34;) ## ================================================================================ ## ## Chi-squared test for given probabilities ## ## data: up_down_ratio ## X-squared = 21.823, df = 1, p-value = 0.000002991 1 head(ko_stat) ## KO_id avg_CG sd_CG avg_EG sd_EG diff_mean ## 1 K03169 0.0026728975 0.0011094132 0.0020694937 0.0014922004 0.00060340387 ## 2 K07133 0.0004554658 0.0001951678 0.0024480601 0.0014916566 -0.00199259427 ## 3 K03088 0.0027767713 0.0006253559 0.0025519275 0.0004966801 0.00022484380 ## 4 K03530 0.0005779169 0.0008952163 0.0005197504 0.0001435245 0.00005816647 ## 5 K06147 0.0020807307 0.0007731661 0.0014321838 0.0004273716 0.00064854693 ## 6 K05349 0.0021064422 0.0005243558 0.0017419317 0.0005382770 0.00036451047 ## p.value sign type q.value Z_score ## 1 0.01835877082 1 Enriched 0.0669268695 1.4990767 ## 2 0.00001327381 -1 Depleted 0.0004777517 -3.3033110 ## 3 0.24318238198 1 Enriched 0.3058325297 0.5076981 ## 4 0.00562800385 1 Enriched 0.0304570375 1.8741186 ## 5 0.00493741133 1 Enriched 0.0277461715 1.9150013 ## 6 0.06307370051 1 Enriched 0.1607865272 0.9912305 3.å°†KOâ€ä¸Šå‡â€ä¸ºpathwayï¼Œè®¡ç®—ReporterScoreï¼š\n1 reporter_s=get_reporter_score(ko_stat) ## =================================Checking file================================= ## ==================================load KOlist================================== ## ===================KOlist download time: 2023-05-12 00:07:41=================== ## ============================Calculating each pathway============================ ## ID number: 479 ## Time use: 4.641 1 head(reporter_s) ## ID ReporterScore Description K_num ## 1 map00010 -1.6255358 Glycolysis / Gluconeogenesis 106 ## 2 map00020 -1.8906022 Citrate cycle (TCA cycle) 67 ## 3 map00030 -0.8261448 Pentose phosphate pathway 88 ## 4 map00040 -0.6685755 Pentose and glucuronate interconversions 89 ## 5 map00051 -2.2494558 Fructose and mannose metabolism 112 ## 6 map00052 -0.4196662 Galactose metabolism 78 ç»“æœè¿›è¡Œç»˜å›¾ 1 2 plot_report(reporter_s,rs_threshold=c(2,-7),y_text_size=10,str_width=40)+ labs(title = \u0026#34;CG vs EG\u0026#34;) 1 2 plot_report(reporter_s,rs_threshold=c(2,-7),mode = 2,y_text_size=10,str_width=40)+ labs(title = \u0026#34;CG vs EG\u0026#34;) 5.æŒ‘é€‰ä¸€æ¡é€šè·¯è¿›è¡Œç»˜åˆ¶\n1 plot_KOs_in_pathway(map_id = \u0026#34;map00780\u0026#34;,ko_stat = ko_stat) Reference 1. K. R. Patil, J. Nielsen, Uncovering transcriptional regulation of metabolism by using metabolic network topology. Proceedings of the National Academy of Sciences of the United States of America. 102, 2685â€“2689 (2005).\n2. L. Liu, R. Zhu, D. Wu, Misuse of reporter score in microbial enrichment analysis. iMeta. n/a, e95.\n","date":"2023-05-10T00:00:00Z","image":"/p/reporter-score/images/misuse_huc67289fcd675657fb391b94803a3cc8a_1235442_120x120_fill_box_smart1_3.png","permalink":"/p/reporter-score/","title":"Reporter Score å¾®ç”Ÿç‰©åŠŸèƒ½å¯Œé›†åˆ†æ"},{"content":"ä¸Šæ¬¡å·²ç»ä»‹ç»è¿‡äº†ä½¿ç”¨Rç»˜åˆ¶ç³»ç»Ÿå‘è‚²æ ‘çš„åŸºæœ¬ç”¨æ³•ï¼Œä¹ŸåŸ‹ä¸‹ä¸€ä¸ªå°å‘ï¼šå¤ç°æ–‡ç« é‡Œå¥½çœ‹çš„æ ‘ï¼Œç°åœ¨è¿‡æ¥å¡«å‘äº†ï¼Œå“ˆå“ˆå“ˆã€‚\næˆ‘å‡†å¤‡äº†ä¸€äº›æ–‡ç« é‡Œè‡ªå·±è§‰å¾—å¾ˆä¸é”™çš„æ ‘ï¼ˆå½“ç„¶å°½å¯èƒ½é£æ ¼ä¸åŒï¼‰ï¼Œç„¶åè‡ªå·±ç”Ÿæˆéšæœºçš„æ ‘å’Œä¸€äº›éšæœºçš„æ— ç§‘å­¦æ„ä¹‰çš„æ³¨é‡Šï¼ˆä»…ä¾›ç”»å›¾å‚è€ƒï¼ï¼ï¼ï¼‰ï¼Œä¸»è¦æ˜¯ç”¨ggtreeå’ŒggtreeExtraè¿›è¡Œä»£ç å¤ç°ï¼Œäº‰å–æŠŠæ ‘çš„ä¸»ä½“éƒ½ç”¨ä»£ç å®Œæˆï¼Œå½“ç„¶ä¸€äº›å°ç»†èŠ‚å°±è¿˜æ˜¯ä¸å¾—ä¸ä½¿ç”¨AIç­‰pdfç¼–è¾‘è½¯ä»¶è¿›è¡Œæ·»åŠ äº†ã€‚\nPreparation é¦–å…ˆè¿˜æ˜¯è¦æŠŠæˆ‘ä»¬è¦ç”¨çš„ä¸€äº›åŒ…éƒ½å®‰è£…å¥½å¹¶å¯¼å…¥è¿›æ¥ã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 #tree if (!requireNamespace(\u0026#34;BiocManager\u0026#34;, quietly=TRUE)) install.packages(\u0026#34;BiocManager\u0026#34;) BiocManager::install(\u0026#34;YuLab-SMU/treedataverse\u0026#34;) BiocManager::install(\u0026#34;ggtree\u0026#34;) BiocManager::install(\u0026#34;ggtreeExtra\u0026#34;) library(treedataverse) library(ggtree) library(ggtreeExtra) library(treeio) #plot library(dplyr) library(ggplot2) library(ggnewscale) library(reshape2) library(ggrepel) ç„¶åéœ€è¦å‡†å¤‡ä¸€äº›å‡½æ•°ï¼š\n1 2 3 4 5 6 7 #å†™ä¸ªå‡½æ•°ç±»ä¼¼childè·å–å­èŠ‚ç‚¹ï¼Œä½†æ˜¯å¯ä»¥æŒ‡å®šå±‚æ•° child2=function(tree,node,depth=1){ if(depth==1){return(child(tree,node))} else { return(child2(tree,child(tree,node)%\u0026gt;%unlist()%\u0026gt;%unname(),depth-1)%\u0026gt;%unlist()%\u0026gt;%unname()) } } Example1 ç¬¬ä¸€ä¸ªä¾‹å­æ¥è‡ªNature Communicationçš„ä¸€ç¯‡æ–‡ç«  (1)ï¼Œè¿™æ˜¯ä¸€ä¸ªç›¸å¯¹ç®€å•çš„æ ‘ã€‚\næŒ‰ç…§ggplotæ­ç§¯æœ¨çš„é€»è¾‘ï¼Œæˆ‘ä»¬çœ‹çœ‹æœ‰å“ªäº›éœ€è¦ç”»çš„ï¼š\næ ‘çš„ä¸»ä½“ï¼Œåœ†å½¢å¸ƒå±€ï¼Œå¹¶æ‰“å¼€ä¸€ä¸ªå°è§’åº¦ï¼Œæ–¹ä¾¿å±•ç¤ºæ³¨é‡Šä¿¡æ¯çš„xè½´label å¤–åœˆæ³¨é‡Š1ï¼Œçƒ­å›¾å½¢å¼ï¼ˆtileï¼‰ï¼Œé¢œè‰²ä»£è¡¨æ¯ä¸€ä¸ªtipçš„Phylumï¼Œé€æ˜åº¦ä»£è¡¨ç›¸å¯¹ä¸°åº¦ å¤–åœˆæ³¨é‡Š2ï¼ŒæŸ±å½¢å›¾å½¢å¼ï¼ˆcolæˆ–barï¼‰ï¼Œé¢œè‰²ä»£è¡¨æ¯ä¸€ä¸ªtipçš„Phylumï¼Œé«˜åº¦ä»£è¡¨SVMç³»æ•° ç›¸åº”çš„æˆ‘ä»¬ç”Ÿæˆæ•°æ®ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 #ç”Ÿæˆä¸€ä¸ª2000tipçš„æ ‘ ntips=2000 set.seed(123) tree=rtree(ntips,rooted = T) #å˜æˆtbl_treeå¯¹è±¡ï¼Œæ–¹ä¾¿æ“ä½œ ggtree::fortify(tree)-\u0026gt;tree_df #ç”Ÿæˆä¸€äº›å‡çš„taxonomyä¿¡æ¯ phylums=c(\u0026#34;Arthropoda\u0026#34;,\u0026#34;Streptophyta\u0026#34;,\u0026#34;Cyanobacteria\u0026#34;,\u0026#34;Acidobacteriota\u0026#34;,\u0026#34;Bacteroidetes\u0026#34;,\u0026#34;Firmicutes\u0026#34;,\u0026#34;Actinobacteria\u0026#34;,\u0026#34;Proteobacteria\u0026#34;,\u0026#34;Others\u0026#34;) phy_nodes=child2(tree,ntips+1,depth = 4) set.seed(123) phy_nodes=setNames(phy_nodes,sample(phylums,length(phy_nodes),replace = T)) tree_df=groupClade(tree_df,phy_nodes,group_name = \u0026#34;Phylum\u0026#34;) anno=filter(tree_df,isTip==\u0026#34;TRUE\u0026#34;)%\u0026gt;%select(label,Phylum) #ç”Ÿæˆéšæœºæ•°ä½œä¸ºä¸°åº¦å’ŒSVM anno=cbind(anno,sapply(1:4, \\(i)rexp(ntips,3))%\u0026gt;%vegan::decostand(.,\u0026#34;total\u0026#34;,2)) anno=cbind(anno,rexp(ntips)/10) colnames(anno)=c(\u0026#34;node\u0026#34;,\u0026#34;Phylum\u0026#34;,\u0026#34;Ice/Snow\u0026#34;,\u0026#34;Terrestrial\u0026#34;,\u0026#34;Marine\u0026#34;,\u0026#34;Freshwater\u0026#34;,\u0026#34;SVM\u0026#34;) head(anno) ## node Phylum Ice/Snow Terrestrial Marine Freshwater ## 1 t339 Cyanobacteria 0.0007693819 0.000448952905 0.00003100616 0.00034017986 ## 2 t1180 Cyanobacteria 0.0002356377 0.000483643521 0.00124672220 0.00009722752 ## 3 t1807 Cyanobacteria 0.0002908480 0.000035084895 0.00074445757 0.00011096549 ## 4 t572 Cyanobacteria 0.0019889166 0.000108407239 0.00098076293 0.00014436096 ## 5 t1739 Cyanobacteria 0.0004149838 0.000004413762 0.00006021236 0.00006270886 ## 6 t1245 Cyanobacteria 0.0004753852 0.000004451763 0.00015540813 0.00011400371 ## SVM ## 1 0.0001332960 ## 2 0.0474528998 ## 3 0.0222924708 ## 4 0.0001208082 ## 5 0.0169753369 ## 6 0.0277805382 æœ‰äº†æ ‘å’Œæ³¨é‡Šæ•°æ®ï¼Œæˆ‘ä»¬å¼€å§‹ç»˜å›¾ï¼š\n1 2 3 4 # 1. æ ‘çš„ä¸»ä½“,æ ‘æå¤ªå¤šæŠŠsizeè°ƒå°ï¼Œåœ†å½¢å¸ƒå±€ï¼Œå¹¶æ‰“å¼€ä¸€ä¸ªå°è§’åº¦ p=ggtree(tree,size=0.1,layout = \u0026#34;fan\u0026#34;,open.angle = 10) #(p=ggtree(tree_df,aes(color=Phylum),size=0.1,layout = \u0026#34;fan\u0026#34;,open.angle = 20)) p 1 2 3 # 2. å¤–åœˆæ³¨é‡Š1ï¼Œçƒ­å›¾å½¢å¼ï¼ˆtileï¼‰ï¼Œé¢œè‰²ä»£è¡¨æ¯ä¸€ä¸ªtipçš„Phylumï¼Œé€æ˜åº¦ä»£è¡¨ç›¸å¯¹ä¸°åº¦ anno1=melt(anno[,1:6],id.vars =1:2,variable.name = \u0026#34;Env\u0026#34;,value.name = \u0026#34;Abundance\u0026#34;) head(anno1) ## node Phylum Env Abundance ## 1 t339 Cyanobacteria Ice/Snow 0.0007693819 ## 2 t1180 Cyanobacteria Ice/Snow 0.0002356377 ## 3 t1807 Cyanobacteria Ice/Snow 0.0002908480 ## 4 t572 Cyanobacteria Ice/Snow 0.0019889166 ## 5 t1739 Cyanobacteria Ice/Snow 0.0004149838 ## 6 t1245 Cyanobacteria Ice/Snow 0.0004753852 1 2 3 4 5 6 7 8 9 p1=p+geom_fruit( data=anno1, geom = geom_tile, mapping = aes(y=node,x=Env,fill=Phylum,alpha=Abundance), pwidth = 0.2, axis.params=list(axis=\u0026#34;x\u0026#34;,text.size = 2,text.angle=270) )+scale_alpha(range = c(0,1),guide=guide_none())+ ggsci::scale_fill_npg() p1 1 2 3 4 5 6 7 8 9 10 # 3. å¤–åœˆæ³¨é‡Š2ï¼ŒæŸ±å½¢å›¾å½¢å¼ï¼ˆcolæˆ–barï¼‰ï¼Œé¢œè‰²ä»£è¡¨æ¯ä¸€ä¸ªtipçš„Phylumï¼Œé«˜åº¦ä»£è¡¨SVMç³»æ•° p2=p1+geom_fruit( data=anno, geom = geom_col, mapping = aes(y=node,x=SVM,fill=Phylum), pwidth = 0.3, axis.params=list(axis=\u0026#34;x\u0026#34;,text.size = 2), grid.params = list() )+theme(legend.position = c(0,0.3)) p2 Example2 ç¬¬äºŒä¸ªä¾‹å­æ¥è‡ªNature Microbiologyçš„ä¸€ç¯‡æ–‡ç«  (2)ã€‚\næˆ‘ä»¬çœ‹çœ‹æœ‰å“ªäº›éœ€è¦ç”»çš„ï¼š\næ ‘çš„ä¸»ä½“ï¼Œæ¯”è¾ƒç‰¹åˆ«çš„å¸ƒå±€ï¼ˆequal_angleï¼‰ï¼Œå¹¶ä¸”æ ‘æè¦åŠ ä¸Šä¸€äº›Formçš„åˆ†ç±»é¢œè‰²ä¿¡æ¯,å†åŠ ä¸Šä¸€ä¸ªscaleæ ‡å°º å¤–åœˆæ³¨é‡Š1ï¼Œæ ‡ç­¾ï¼Œåœ¨æ¯ç±»åˆ†æ”¯é™„è¿‘ï¼ŒèƒŒæ™¯é¢œè‰²æ˜¯Formçš„åˆ†ç±» å¤–åœˆæ³¨é‡Š2ï¼Œç‚¹å’Œæ–‡å­—ï¼Œåº”è¯¥æ˜¯æ‰‹åŠ¨æŒ‘é€‰çš„ä¸€äº›èŠ‚ç‚¹ï¼Œåœ¨æ ‘æé¡¶ç«¯åŠ ä¸Šäº†ç°ç‚¹ä»¥åŠé»‘è‰²æ–‡å­— ç›¸åº”çš„æˆ‘ä»¬ç”Ÿæˆæ•°æ®ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 #ç”Ÿæˆä¸€ä¸ª400tipçš„æ ‘ ntips=400 set.seed(123) tree=rtree(ntips,rooted = T) #å˜æˆtbl_treeå¯¹è±¡ï¼Œæ–¹ä¾¿æ“ä½œ ggtree::fortify(tree,layout =\u0026#34;equal_angle\u0026#34; )-\u0026gt;tree_df #ç”Ÿæˆä¸€äº›å‡çš„Formä¿¡æ¯ forms=paste0(\u0026#34;Form \u0026#34;,c(\u0026#34;I\u0026#34;,\u0026#34;II\u0026#34;,\u0026#34;II/III\u0026#34;,\u0026#34;III-a\u0026#34;,\u0026#34;III-b\u0026#34;,\u0026#34;III-c\u0026#34;,\u0026#34;III-like\u0026#34;,\u0026#34;IV\u0026#34;)) phy_nodes=child2(tree,ntips+1,depth = 3) set.seed(123) phy_nodes=setNames(phy_nodes,sample(forms,length(phy_nodes),replace = F)) tree_df=groupClade(tree_df,phy_nodes,group_name = \u0026#34;Form\u0026#34;) #æŒ‡å®šé¢œè‰² colors=c(\u0026#34;#1F77B4FF\u0026#34;,\u0026#34;#FF7F0EFF\u0026#34;,\u0026#34;#2CA02CFF\u0026#34;,\u0026#34;#D62728FF\u0026#34;,\u0026#34;#9467BDFF\u0026#34;,\u0026#34;#8C564BFF\u0026#34;,\u0026#34;#E377C2FF\u0026#34;,\u0026#34;#BCBD22FF\u0026#34;,\u0026#34;#17BECFFF\u0026#34;) #æŒ‘é€‰ä¸€äº›nodes set.seed(123) label_node=sample(seq_len(ntips),20) æœ‰äº†æ ‘å’Œæ³¨é‡Šæ•°æ®ï¼Œæˆ‘ä»¬å¼€å§‹ç»˜å›¾ï¼š\n1 2 3 4 5 6 # 1. æ ‘çš„ä¸»ä½“ï¼Œæ¯”è¾ƒç‰¹åˆ«çš„å¸ƒå±€ï¼ˆequal_angleï¼‰ï¼Œå¹¶ä¸”æ ‘æè¦åŠ ä¸Šä¸€äº›Formçš„åˆ†ç±»é¢œè‰²ä¿¡æ¯ p=ggtree(tree_df,aes(color=Form),layout = \u0026#34;equal_angle\u0026#34;)+ geom_treescale(-5,7,fontsize=3, linesize=0.5,width=1)+ scale_color_manual(values = c(\u0026#34;black\u0026#34;,colors))+ coord_flip()+theme(legend.position = \u0026#34;none\u0026#34;) p 1 2 3 4 5 # 2. å¤–åœˆæ³¨é‡Š1ï¼Œæ ‡ç­¾ï¼Œåœ¨æ¯ç±»åˆ†æ”¯é™„è¿‘ï¼ŒèƒŒæ™¯é¢œè‰²æ˜¯Formçš„åˆ†ç±» p1=p+geom_label_repel(data = subset(tree_df,node%in%phy_nodes), mapping = aes(x=x,y=y,label=Form,fill=Form),color=\u0026#34;black\u0026#34;,alpha=0.7)+ scale_fill_manual(values = colors) p1 1 2 3 4 5 6 # 3. å¤–åœˆæ³¨é‡Š2ï¼Œç‚¹å’Œæ–‡å­—ï¼Œåº”è¯¥æ˜¯æ‰‹åŠ¨æŒ‘é€‰çš„ä¸€äº›èŠ‚ç‚¹ï¼Œåœ¨æ ‘æé¡¶ç«¯åŠ ä¸Šäº†ç°ç‚¹ä»¥åŠé»‘è‰²æ–‡å­— p2=p1+geom_point(data = subset(tree_df,node%in%label_node), mapping = aes(x=x*1.03,y=y*1.03),color=\u0026#34;grey50\u0026#34;)+ geom_text_repel(data = subset(tree_df,node%in%label_node), mapping = aes(x=x*1.05,y=y*1.05,label=label),color=\u0026#34;black\u0026#34;) p2 å½“ç„¶æ–‡å­—å’Œæ ‡ç­¾çš„ä½ç½®æœ‰ç‚¹ä¸å¤ªå¥½ï¼Œéœ€è¦å¯¼å‡ºpdfå†ç¨å¾®è°ƒæ•´ä¸€ä¸‹ã€‚\nExample3 ç¬¬ä¸‰ä¸ªä¾‹å­æ¥è‡ªNature Biotechnologyçš„ä¸€ç¯‡æ–‡ç«  (3) ã€‚\næˆ‘ä»¬çœ‹çœ‹æœ‰å“ªäº›éœ€è¦ç”»çš„ï¼š\næ ‘çš„ä¸»ä½“ï¼Œå±‚çº§æ ‘çš„æ„Ÿè§‰ï¼ˆæŠŠbranch.lengthå¿½ç•¥äº†ï¼Œæ‰€æœ‰çš„tipåœ¨ä¸€ä¸ªä½ç½®ï¼‰ï¼Œæ‰“å¼€è§’åº¦ä¸º180ï¼Œç°è‰²æ ‘æ å†…åœˆæ³¨é‡Šï¼Œç»™éƒ¨åˆ†cladeåŠ ä¸Šä¸åŒPhylumçš„èƒŒæ™¯é¢œè‰² å¤–åœˆæ³¨é‡Š1ï¼Œ3åœˆçƒ­å›¾ï¼Œç”¨çš„æ˜¯æœ‰æ— æ•°æ® å¤–åœˆæ³¨é‡Š2ï¼Œ2åœˆæŸ±å½¢å›¾ï¼ŒSizeå’ŒGCå«é‡ ç›¸åº”çš„æˆ‘ä»¬ç”Ÿæˆæ•°æ®ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 #ç”Ÿæˆä¸€ä¸ª1000tipçš„æ ‘ ntips=1000 set.seed(123) tree=rtree(ntips,rooted = T) #å˜æˆtbl_treeå¯¹è±¡ï¼Œæ–¹ä¾¿æ“ä½œ ggtree::fortify(tree)-\u0026gt;tree_df #ç”Ÿæˆä¸€äº›å‡çš„taxonomyä¿¡æ¯ phylums=rev(c(\u0026#34;Arthropoda\u0026#34;,\u0026#34;Streptophyta\u0026#34;,\u0026#34;Cyanobacteria\u0026#34;,\u0026#34;Acidobacteriota\u0026#34;,\u0026#34;Bacteroidetes\u0026#34;,\u0026#34;Firmicutes\u0026#34;,\u0026#34;Actinobacteria\u0026#34;,\u0026#34;Proteobacteria\u0026#34;)) #æŠŠ8ä¸ªphylumèµ‹ç»™æœ€å¤štipçš„å‡ ä¸ªcladeï¼Œå…¶ä»–çš„æ˜¯others phy_nodes=child2(tree,ntips+1,depth = 4) phy_nodes_tips=sapply(phy_nodes, \\(i)nrow(offspring(tree_df,i))) names(phy_nodes)=rep(\u0026#34;Others\u0026#34;,length(phy_nodes)) names(phy_nodes)[which(phy_nodes_tips%in%tail(sort(phy_nodes_tips),8))]=phylums tree_df=groupClade(tree_df,phy_nodes,group_name = \u0026#34;Phylum1\u0026#34;) anno=filter(tree_df,isTip==\u0026#34;TRUE\u0026#34;)%\u0026gt;%select(label,Phylum1) #æ·»åŠ æ¯ä¸ªphylumçš„ä¸ªæ•°å’Œç™¾åˆ†æ¯” anno%\u0026gt;%count(Phylum1)%\u0026gt;%mutate(per=100*n/sum(n))%\u0026gt;% mutate(Phylum=paste0(Phylum1,\u0026#34; (\u0026#34;,n,\u0026#34;, \u0026#34;,per,\u0026#34;%)\u0026#34;))%\u0026gt;%select(Phylum1,Phylum)-\u0026gt;in_anno in_anno=right_join(in_anno,data.frame(node=phy_nodes,Phylum1=names(phy_nodes))) set.seed(123) #ç”Ÿæˆéšæœºå˜é‡ä½œä¸ºSource,16S rRNA presence,Newly identified anno$Source=sample(c(\u0026#34;Cultivated\u0026#34;,\u0026#34;MAG\u0026#34;),ntips,T,c(0.1,0.9)) anno$`16S rRNA presence`=sample(c(\u0026#34;Yes\u0026#34;,\u0026#34;No\u0026#34;),ntips,T,c(0.3,0.7)) anno$`Newly identified`=sample(c(\u0026#34;Yes\u0026#34;,\u0026#34;No\u0026#34;),ntips,T,c(0.9,0.1)) #ç”Ÿæˆéšæœºæ•°ä½œä¸ºSizeå’ŒGCå«é‡ anno$`Size (Mb)`=10-rpois(ntips,2) anno$`GC (%)`=runif(ntips,30,80) colnames(anno)[1]=\u0026#34;node\u0026#34; head(anno) ## # A tibble: 6 Ã— 7 ## node Phylum1 Source `16S rRNA presence` Newly identifieâ€¦Â¹ Size â€¦Â² GC (%â€¦Â³ ## \u0026lt;chr\u0026gt; \u0026lt;fct\u0026gt; \u0026lt;chr\u0026gt; \u0026lt;chr\u0026gt; \u0026lt;chr\u0026gt; \u0026lt;dbl\u0026gt; \u0026lt;dbl\u0026gt; ## 1 t876 Others MAG No Yes 9 45.2 ## 2 t896 Others MAG No Yes 6 71.6 ## 3 t437 Others MAG No Yes 9 59.7 ## 4 t750 Others MAG Yes Yes 8 70.4 ## 5 t270 Others Cultivated Yes Yes 9 44.7 ## 6 t412 Others MAG No Yes 8 37.1 ## # â€¦ with abbreviated variable names Â¹â€‹`Newly identified`, Â²â€‹`Size (Mb)`, ## # Â³â€‹`GC (%)` 1 2 3 # 1. æ ‘çš„ä¸»ä½“ï¼Œå±‚çº§æ ‘çš„æ„Ÿè§‰ï¼ˆæŠŠbranch.lengthå¿½ç•¥äº†ï¼Œæ‰€æœ‰çš„tipåœ¨ä¸€ä¸ªä½ç½®ï¼‰ï¼Œæ‰“å¼€è§’åº¦ä¸º180ï¼Œç°è‰²æ ‘æ p=ggtree(tree,layout = \u0026#34;fan\u0026#34;,open.angle = 180,branch.length = \u0026#34;none\u0026#34;,size=0.2,color=\u0026#34;grey\u0026#34;) p 1 2 3 4 5 # 2. å†…åœˆæ³¨é‡Šï¼Œç»™éƒ¨åˆ†cladeåŠ ä¸Šä¸åŒPhylumçš„èƒŒæ™¯é¢œè‰² p1=p+geom_highlight(data = in_anno, mapping = aes(node=node,fill=Phylum),to.bottom = T,alpha=1)+ ggsci::scale_fill_rickandmorty(guide=guide_legend(ncol = 2,title.position = \u0026#34;top\u0026#34;,title = \u0026#34;Clade: Phylum\u0026#34;,order = 4)) p1 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 # 3. å¤–åœˆæ³¨é‡Š1ï¼Œ3åœˆçƒ­å›¾ï¼Œç”¨çš„æ˜¯æœ‰æ— æ•°æ® p2=p1+ggnewscale::new_scale_fill()+ geom_fruit( data=anno, geom = geom_tile, mapping = aes(y=node,fill=`Newly identified`), pwidth = 0.05,offset = 0.05,color=NA )+scale_fill_manual(values = c(\u0026#34;white\u0026#34;,\u0026#34;red\u0026#34;), guide=guide_legend(ncol = 2,title.position = \u0026#34;top\u0026#34;,override.aes = list(color=\u0026#34;red\u0026#34;,size=3),order = 3))+ ggnewscale::new_scale_fill()+ geom_fruit( data=anno, geom = geom_tile, mapping = aes(y=node,fill=`16S rRNA presence`), pwidth = 0.05,offset = 0.1,color=NA )+scale_fill_manual(values = c(\u0026#34;white\u0026#34;,\u0026#34;blue4\u0026#34;), guide=guide_legend(ncol = 2,title.position = \u0026#34;top\u0026#34;,override.aes = list(color=\u0026#34;blue4\u0026#34;,size=3),order = 2))+ ggnewscale::new_scale_fill()+ geom_fruit( data=anno, geom = geom_tile, mapping = aes(y=node,fill=Source), pwidth = 0.05,offset = 0.1,color=NA )+scale_fill_manual(values = c(\u0026#34;green4\u0026#34;,\u0026#34;white\u0026#34;), guide=guide_legend(ncol = 2,title.position = \u0026#34;top\u0026#34;,override.aes = list(color=\u0026#34;green4\u0026#34;,size=3),order = 1)) p2 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 # 4. å¤–åœˆæ³¨é‡Š2ï¼Œ2åœˆæŸ±å½¢å›¾ï¼ŒSizeå’ŒGCå«é‡ p3=p2+geom_fruit( data=anno, geom = geom_col, mapping = aes(y=node,x=`Size (Mb)`),fill=\u0026#34;purple3\u0026#34;, pwidth = 0.15,offset = 0.1, axis.params=list(axis=\u0026#34;x\u0026#34;,text.size = 2,text.angle=90,hjust=1,nbreak=3,line.color=\u0026#34;black\u0026#34;), grid.params = NULL )+geom_fruit( data=anno, geom = geom_col, mapping = aes(y=node,x=`GC (%)`),fill=\u0026#34;#F7C194\u0026#34;, pwidth = 0.2,offset = 0.05, axis.params=list(axis=\u0026#34;x\u0026#34;,text.size = 2,text.angle=90,hjust=1,nbreak=2,line.color=\u0026#34;black\u0026#34;), grid.params = NULL )+theme(legend.position = c(0.5,0.3),legend.box = \u0026#34;horizontal\u0026#34;, legend.text = element_text(size=8)) #æœ€åå†åŠ ä¸Šå‡ ä¸ªæ ‡ç­¾ p3+geom_text(data = data.frame(x=c(20,22,24,27,31),y=c(10), label=c(\u0026#34;Source \u0026#34;,\u0026#34;16S rRNA presence \u0026#34;,\u0026#34;Newly identified \u0026#34;,\u0026#34;Size (Mb) \u0026#34;,\u0026#34;GC (%) \u0026#34;)), aes(x,y,label=label),angle=90,hjust=1,size=3) Example4 ç¬¬å››ä¸ªä¾‹å­æ¥è‡ªNatureçš„ä¸€ç¯‡æ–‡ç«  (4)ã€‚è¿™ä¸ªå›¾æ˜¯ç”¨iTOLåšçš„ï¼Œå› ä¸ºiTOLæ”¯æŒç›´æ¥ç”»tipåˆ°åœ†ç­‰åŠå¾„çš„ç©ºé—´é¢œè‰²å¡«å……ã€‚ä½†æ˜¯æˆ‘è§‰å¾—ç”¨Rè¿˜æ˜¯ä¸€æ ·èƒ½ç”»ã€‚\næˆ‘ä»¬çœ‹çœ‹æœ‰å“ªäº›éœ€è¦ç”»çš„ï¼š\næ ‘çš„ä¸»ä½“ï¼Œå¾ˆæ­£å¸¸ï¼Œæ‰“å¼€å°è§’åº¦ï¼Œå¼€å£åœ¨å·¦ä¸Šè§’ å†…åœˆæ³¨é‡Šï¼Œç»™éƒ¨åˆ†cladeåŠ ä¸Šä¸åŒPhylumçš„é¢œè‰²ï¼Œä½†æ˜¯è¿™ä¸ªè‰²å—æ˜¯åŠ åœ¨tipåˆ°åœ†ç­‰åŠå¾„çš„ç©ºé—´ï¼ˆè¿™ä¸ªå¾ˆæœ‰æ„æ€ï¼Œè¿˜æ²¡æœ‰çœ‹åˆ°è¿‡åˆ«äººç”¨Rå®ç°è¿‡ï¼‰ å¤–åœˆæ³¨é‡Š1ï¼Œæ–¹å—ä»£è¡¨phageï¼Œé¢œè‰²ä»£è¡¨family å¤–åœˆæ³¨é‡Š2ï¼Œç°è‰²äº”è§’æ˜Ÿä»£è¡¨Genome contains Thoeris å¤–åœˆæ³¨é‡Š3ï¼Œç»¿è‰²è±å½¢åŠ ä¸Šæ–‡å­— ç›¸åº”çš„æˆ‘ä»¬ç”Ÿæˆæ•°æ®ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 #ç”Ÿæˆä¸€ä¸ª200tipçš„æ ‘ ntips=200 set.seed(123) tree=rtree(ntips,rooted = T) #å˜æˆtbl_treeå¯¹è±¡ï¼Œæ–¹ä¾¿æ“ä½œ ggtree::fortify(tree)-\u0026gt;tree_df #ç”Ÿæˆä¸€äº›å‡çš„taxonomyä¿¡æ¯ phylums=rev(c(\u0026#34;Arthropoda\u0026#34;,\u0026#34;Streptophyta\u0026#34;,\u0026#34;Cyanobacteria\u0026#34;,\u0026#34;Acidobacteriota\u0026#34;,\u0026#34;Bacteroidetes\u0026#34;,\u0026#34;Firmicutes\u0026#34;,\u0026#34;Actinobacteria\u0026#34;,\u0026#34;Proteobacteria\u0026#34;)) #æŠŠ8ä¸ªphylumèµ‹ç»™æœ€å¤štipçš„å‡ ä¸ªcladeï¼Œå…¶ä»–çš„æ˜¯others phy_nodes=child2(tree,ntips+1,depth = 4) phy_nodes_tips=sapply(phy_nodes, \\(i)nrow(offspring(tree_df,i))) names(phy_nodes)=rep(\u0026#34;Unknown\u0026#34;,length(phy_nodes)) names(phy_nodes)[which(phy_nodes_tips%in%tail(sort(phy_nodes_tips),8))]=phylums tree_df=groupClade(tree_df,phy_nodes,group_name = \u0026#34;Phylum\u0026#34;) anno=filter(tree_df,isTip==\u0026#34;TRUE\u0026#34;)%\u0026gt;%select(label,Phylum)%\u0026gt;%rename(node=\u0026#34;label\u0026#34;) colors=c(\u0026#34;Firmicutes\u0026#34;=\u0026#34;#d3edeb\u0026#34;,\u0026#34;Actinobacteria\u0026#34;=\u0026#34;#019a99\u0026#34;,\u0026#34;Bacteroidetes\u0026#34;=\u0026#34;#0077b0\u0026#34;, \u0026#34;Proteobacteria\u0026#34;=\u0026#34;#ffba4d\u0026#34;,\u0026#34;Acidobacteriota\u0026#34;=\u0026#34;#282152\u0026#34;,\u0026#34;Cyanobacteria\u0026#34;=\u0026#34;#caa59a\u0026#34;, \u0026#34;Streptophyta\u0026#34;=\u0026#34;#ff7880\u0026#34;,\u0026#34;Arthropoda\u0026#34;=\u0026#34;#aac8eb\u0026#34;,Unknown=\u0026#34;white\u0026#34;) set.seed(123) #ç”Ÿæˆéšæœºå˜é‡ä½œä¸ºSource,16S rRNA presence,Newly identified anno$`Phage family`=anno$`Thoeris`=anno$`bac`=NA anno$`Phage family`[sample(seq_len(ntips),30)]=sample(c(\u0026#34;Myoviridae\u0026#34;,\u0026#34;Podoviridae\u0026#34;,\u0026#34;Siphoviridae\u0026#34;),30,replace = T,prob = c(0.2,0.1,0.7)) anno$`Thoeris`[sample(seq_len(ntips),5)]=\u0026#34;Genome contains Thoeris\u0026#34; anno$bac[sample(seq_len(ntips),10)]=\u0026#34;Bac\u0026#34; 1 2 3 4 5 6 7 # 1. æ ‘çš„ä¸»ä½“ï¼Œå¾ˆæ­£å¸¸ï¼Œæ‰“å¼€å°è§’åº¦ï¼Œå¼€å£åœ¨å·¦ä¸Šè§’ p=ggtree(tree,layout = \u0026#34;fan\u0026#34;,open.angle = 5) # 2. å†…åœˆæ³¨é‡Šï¼Œç»™éƒ¨åˆ†cladeåŠ ä¸Šä¸åŒPhylumçš„é¢œè‰²ï¼Œä½†æ˜¯è¿™ä¸ªè‰²å—æ˜¯åŠ åœ¨tipåˆ°åœ†ç­‰åŠå¾„çš„ç©ºé—´ï¼ˆè¿™ä¸ªå¾ˆæœ‰æ„æ€ï¼Œè¿˜æ²¡æœ‰çœ‹åˆ°è¿‡åˆ«äººç”¨Rå®ç°è¿‡ï¼‰ p1=p+geom_tiplab(data=tree_df,mapping = aes(color=Phylum),align = T,linetype = 1,linesize = 3.5,size=0)+ scale_color_manual(values = colors,guide=guide_legend(title = \u0026#34;Host phylum\u0026#34;,nrow = 3))+geom_tree(layout = \u0026#34;fan\u0026#34;) p1 1 2 3 4 5 6 7 8 9 10 11 12 # 3. å¤–åœˆæ³¨é‡Š1ï¼Œæ–¹å—ä»£è¡¨phageï¼Œé¢œè‰²ä»£è¡¨family library(ggstar) p2=p1+geom_fruit( geom = geom_star, data = anno, mapping = aes( y=node,fill=`Phage family` ), starshape=13, starstroke=0,size=4 )+scale_fill_manual(values = c(\u0026#34;#de255c\u0026#34;,\u0026#34;#496db6\u0026#34;,\u0026#34;#c4c64f\u0026#34;),na.translate=FALSE,guide=guide_legend(ncol = 1)) p2 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 # 4. å¤–åœˆæ³¨é‡Š2ï¼Œç°è‰²äº”è§’æ˜Ÿä»£è¡¨Genome contains Thoeris p3=p2+new_scale_fill()+ geom_fruit( geom = geom_star, data = anno, mapping = aes( y=node,fill=`Thoeris` ), starshape=1,offset = 0, starstroke=0,size=5 )+scale_fill_manual(name=\u0026#34;\u0026#34;,values = c(\u0026#34;grey\u0026#34;),na.translate=FALSE) # 5. å¤–åœˆæ³¨é‡Š3ï¼Œç»¿è‰²è±å½¢åŠ ä¸Šæ–‡å­— p4=p3+new_scale_fill()+ geom_fruit( geom = geom_star, data = anno, mapping = aes( y=node,fill=`bac` ), starshape=12,offset = 0.1, starstroke=0,size=3 )+scale_fill_manual(values = c(\u0026#34;#74cfd2\u0026#34;),na.translate=FALSE,guide=guide_none())+ geom_tiplab(data = tree_df%\u0026gt;%filter(label%in%(anno$node[which(!is.na(anno$bac))])), mapping = aes(label=label),angle=0,align = T,linetype = 0,offset = 2.5) p4+theme(legend.position = \u0026#34;bottom\u0026#34;) å‘¼ï½ï¼Œæš‚æ—¶å…ˆåšè¿™å‡ ä¸ªå›¾å§ï¼Œå†æ¬¡å¼ºè°ƒï¼Œè¿™æ˜¯ç”Ÿæˆéšæœºçš„æ ‘å’Œä¸€äº›éšæœºçš„æ— ç§‘å­¦æ„ä¹‰çš„æ³¨é‡Šï¼ˆä»…ä¾›ç”»å›¾å‚è€ƒï¼ï¼ï¼ï¼‰ã€‚\nå¦‚æœä½ æœ‰å¥½çœ‹çš„å›¾éœ€è¦å¤ç°æˆ–è€…æœ‰ä»€ä¹ˆç»˜å›¾ä¸Šçš„é—®é¢˜ï¼Œæ¬¢è¿è”ç³»ã€‚\nReference 1. M. Bourquin, S. B. Busi, S. Fodelianakis, H. Peter, A. Washburne, T. J. Kohler, L. Ezzat, G. Michoud, P. Wilmes, T. J. Battin, The microbiome of cryospheric ecosystems. Nature Communications. 13, 3087 (2022).\n2. M. Royo-Llonch, P. SÃ¡nchez, C. Ruiz-GonzÃ¡lez, G. Salazar, C. PedrÃ³s-AliÃ³, M. SebastiÃ¡n, K. Labadie, L. Paoli, F. M. Ibarbalz, L. Zinger, B. Churcheward, S. Chaffron, D. Eveillard, E. Karsenti, S. Sunagawa, P. Wincker, L. Karp-Boss, C. Bowler, S. G. Acinas, Compendium of 530 metagenome-assembled bacterial and archaeal genomes from the polar Arctic Ocean. Nature Microbiology. 6, 1561â€“1574 (2021).\n3. Y. Liu, M. Ji, T. Yu, J. Zaugg, A. M. Anesio, Z. Zhang, S. Hu, P. Hugenholtz, K. Liu, P. Liu, Y. Chen, Y. Luo, T. Yao, A genome and gene catalog of glacier microbiomes. Nature Biotechnology. 40, 1341â€“1348 (2022).\n4. A. Leavitt, E. Yirmiya, G. Amitai, A. Lu, J. Garb, E. Herbst, B. R. Morehouse, S. J. Hobbs, S. P. Antine, Z.-Y. J. Sun, P. J. Kranzusch, R. Sorek, Viruses inhibit TIR gcADPR signalling to overcome bacterial defence. Nature. 611, 326â€“331 (2022).\n","date":"2023-05-05T00:00:00Z","image":"/p/r/images/example3_hudb155f8e92790c1df7e82ecec90ce7ca_1845460_120x120_fill_box_smart1_3.png","permalink":"/p/r/","title":"Rç»˜åˆ¶ä¼˜ç¾çš„è¿›åŒ–æ ‘ï¼ˆè¿›é˜¶ï¼‰"},{"content":"Introduction æ‰¹æ¬¡æ•ˆåº”ï¼ˆBatch effectï¼‰æ˜¯æŒ‡å®éªŒä¸­çš„ä¸åŒæ‰¹æ¬¡ä¹‹é—´å­˜åœ¨çš„ç³»ç»Ÿæ€§åå·®ã€‚åœ¨ç»„å­¦ç ”ç©¶ä¸­ï¼Œæ‰¹æ¬¡æ•ˆåº”é€šå¸¸ç”±äºæ ·æœ¬çš„é‡‡é›†ã€å¤„ç†æˆ–æµ‹é‡æ–¹æ³•ä¸åŒè€Œäº§ç”Ÿã€‚\nä¾‹å¦‚ï¼Œå¦‚æœå°†ä¸åŒçš„æ ·æœ¬åœ¨ä¸åŒçš„å®éªŒæ‰¹æ¬¡ä¸­å¤„ç†ï¼Œå¯èƒ½ä¼šå¯¼è‡´æ‰¹æ¬¡æ•ˆåº”ã€‚è¿™å¯èƒ½ä¼šå¯¹æ•°æ®äº§ç”Ÿæ˜¾è‘—çš„å½±å“ï¼Œå› ä¸ºæ‰¹æ¬¡æ•ˆåº”å¯èƒ½ä¼šæ©ç›–æˆ–å¼•å…¥ä¸æ‰€ç ”ç©¶çš„å˜é‡æ— å…³çš„å™ªå£°ã€‚\nä»æœ€æ—©çš„å¾®é˜µåˆ—è¯•éªŒä¸­å°±å¯ä»¥è§‚å¯Ÿåˆ°æ‰¹æ¬¡æ•ˆåº”,å®ƒç”±è®¸å¤šå› ç´ å¼•èµ·,åŒ…æ‹¬è¯•éªŒåˆ†ææ—¶é—´ã€å¹³å°ã€ç¯å¢ƒç­‰ã€‚åæ¥çš„RNA-seqï¼Œå¾®ç”Ÿç‰©ç»„ç­‰ç»„å­¦ä¹Ÿä¼šå—åˆ°å…¶å½±å“ï¼Œå°¤å…¶æ˜¯è›‹ç™½ç»„å’Œä»£è°¢ç»„ï¼ˆè´¨è°±æ•°æ®å¥½åƒæŠ€æœ¯è¯¯å·®å¾ˆå¤§ï¼Œæ‰¹æ¬¡æ•ˆåº”æ¯”è¾ƒæ˜æ˜¾ï¼Œéœ€è¦å‰æœŸä¸Šè¶³å¤Ÿçš„QCé…åˆåæœŸçš„æ•°æ®å¤„ç†æ¥å»é™¤æ‰¹æ¬¡æ•ˆåº”ï¼‰ã€‚\nåœ¨ç»„å­¦ç ”ç©¶ä¸­ï¼Œæ‰¹æ¬¡æ•ˆåº”å¯èƒ½ä¼šå¯¼è‡´å‡é˜³æ€§æˆ–å‡é˜´æ€§ç»“æœï¼Œä»è€Œå½±å“ç ”ç©¶çš„å‡†ç¡®æ€§å’Œå¯é æ€§ã€‚å› æ­¤ï¼Œç ”ç©¶äººå‘˜é€šå¸¸ä¼šé‡‡å–å„ç§æ–¹æ³•æ¥æ£€æµ‹å’Œæ ¡æ­£æ‰¹æ¬¡æ•ˆåº”ï¼Œä¾‹å¦‚ä½¿ç”¨æ­£äº¤åŒ–æ‰¹æ¬¡æ ¡æ­£æ³•ï¼ˆComBatï¼‰æˆ–å…¶ä»–æ ‡å‡†åŒ–æ–¹æ³•æ¥è°ƒæ•´æ•°æ®ã€‚è¿™äº›æ–¹æ³•å¯ä»¥å¸®åŠ©æ¶ˆé™¤æ‰¹æ¬¡æ•ˆåº”ï¼Œæé«˜æ•°æ®è´¨é‡ï¼Œå¹¶ç¡®ä¿ç»“æœçš„å¯é æ€§å’Œå¯é‡å¤æ€§ã€‚\nMethods ç”¨äºå»é™¤åŸºå› è¡¨è¾¾é‡æ‰¹æ¬¡æ•ˆåº”çš„ä¸»è¦æ–¹æ³•æœ‰ComBatæ–¹æ³•ã€æ›¿ä»£å˜é‡åˆ†ææ³•ã€è·ç¦»åŠ æƒåˆ¤åˆ«æ³•å’ŒåŸºäºæ¯”å€¼çš„æ–¹æ³•ç­‰ã€‚\nhttp://html.rhhz.net/njnydxxb/201903001.htm\nhttps://www.chinagut.cn/papers/read/1098488862\n","date":"2023-05-03T00:00:00Z","permalink":"/p/batch-effect/","title":"ç»„å­¦æ•°æ®å»é™¤æ‰¹æ¬¡æ•ˆåº”ï¼ˆbatch effectï¼‰"},{"content":"https://mp.weixin.qq.com/s/NEhoOlAau_jyxHPTf7H3ug è¿™ç¯‡æ¨æ–‡è®²çš„å¾ˆè¯¦ç»†ã€‚\nIntroduction ç»“æ„æ–¹ç¨‹æ¨¡å‹ï¼ˆStructural Equation Modelingï¼Œç®€ç§°SEMï¼‰æ˜¯ä¸€ç§ç»“åˆå¤šå…ƒç»Ÿè®¡æ–¹æ³•å’Œæ•°å­¦æ¨¡å‹çš„åˆ†ææŠ€æœ¯ã€‚å®ƒèƒ½å¤Ÿå¸®åŠ©ç ”ç©¶è€…æ¢ç©¶å¤šä¸ªå˜é‡ä¹‹é—´çš„å…³ç³»å’Œå½±å“ï¼ŒåŒ…æ‹¬ç›´æ¥å’Œé—´æ¥çš„å½±å“ã€‚SEM å¯ä»¥åŒæ—¶ä¼°è®¡å¤šä¸ªæ–¹ç¨‹ï¼ˆå³å¤šå…ƒå›å½’æ¨¡å‹ï¼‰ï¼Œå¹¶ä¸”å…è®¸å˜é‡é—´ç›¸äº’ä½œç”¨ï¼ŒåŒæ—¶è¿˜èƒ½è€ƒè™‘éšå˜é‡ï¼ˆlatent variableï¼‰å’Œæµ‹é‡è¯¯å·®ç­‰å› ç´ ã€‚å®ƒçš„åº”ç”¨èŒƒå›´éå¸¸å¹¿æ³›ï¼Œä¾‹å¦‚ç¤¾ä¼šç§‘å­¦ã€å¿ƒç†å­¦ã€æ•™è‚²å­¦ã€åŒ»å­¦ã€ç”Ÿç‰©å­¦ç­‰é¢†åŸŸã€‚\nåœ¨ç”Ÿç‰©å­¦é¢†åŸŸï¼Œç»“æ„æ–¹ç¨‹æ¨¡å‹ï¼ˆSEMï¼‰è¢«å¹¿æ³›ç”¨äºæ¢ç´¢å’Œæµ‹è¯•ç”Ÿç‰©å­¦ç³»ç»Ÿçš„å¤æ‚å…³ç³»ã€‚ä»¥ä¸‹æ˜¯ä¸€äº›å…·ä½“çš„åº”ç”¨ç¤ºä¾‹ï¼š\næ¨¡æ‹Ÿç”Ÿæ€ç³»ç»Ÿï¼šSEMå¯ç”¨äºå»ºç«‹ç”Ÿæ€ç³»ç»Ÿçš„å¤æ‚æ¨¡å‹ï¼Œå¹¶ç¡®å®šå½±å“ç”Ÿæ€ç³»ç»Ÿçš„ä¸åŒå› ç´ ä¹‹é—´çš„å…³ç³»ã€‚ä¾‹å¦‚ï¼Œå¯ä»¥å°†SEMåº”ç”¨äºç ”ç©¶æ°”å€™å˜åŒ–å¯¹ç”Ÿæ€ç³»ç»Ÿçš„å½±å“ï¼Œæˆ–è€…ç ”ç©¶ç”Ÿç‰©å¤šæ ·æ€§å’Œç”Ÿæ€ç³»ç»ŸåŠŸèƒ½ä¹‹é—´çš„å…³ç³»ï¼ˆå½“ç„¶åŒ…æ‹¬äº†å¾®ç”Ÿç‰©ç”Ÿæ€ç ”ç©¶ï¼‰ã€‚\né—ä¼ å­¦ï¼šSEMå¯ä»¥ç”¨äºç ”ç©¶é—ä¼ å› ç´ å¦‚ä½•å½±å“ç‰¹å®šæ€§çŠ¶ï¼Œä¾‹å¦‚ç–¾ç—…æ˜“æ„Ÿæ€§ã€èº«é«˜æˆ–ä½“é‡ç­‰ã€‚é€šè¿‡SEMï¼Œå¯ä»¥ç¡®å®šå“ªäº›é—ä¼ å› ç´ æ˜¯æœ€é‡è¦çš„ï¼Œä»¥åŠè¿™äº›é—ä¼ å› ç´ ä¹‹é—´çš„ç›¸äº’ä½œç”¨ã€‚\nç—…ç†å­¦ï¼šSEMå¯ç”¨äºç ”ç©¶ç–¾ç—…çš„å‘ç”Ÿæœºåˆ¶ã€‚é€šè¿‡SEMï¼Œå¯ä»¥ç¡®å®šå“ªäº›å› ç´ å¯¹ç–¾ç—…çš„å‘ç”Ÿå’Œå‘å±•å…·æœ‰å…³é”®ä½œç”¨ï¼Œå¹¶è¯†åˆ«å¯ä»¥ç”¨äºæ²»ç–—ç–¾ç—…çš„ç›®æ ‡å› ç´ ã€‚\nè¡Œä¸ºç§‘å­¦ï¼šSEMå¯ç”¨äºç ”ç©¶ç”Ÿç‰©è¡Œä¸ºçš„å¤æ‚æ€§ã€‚ä¾‹å¦‚ï¼Œå¯ä»¥ä½¿ç”¨SEMæ¥ç ”ç©¶åŸºå› ã€ç¯å¢ƒå’Œè¡Œä¸ºä¹‹é—´çš„ç›¸äº’ä½œç”¨ï¼Œä»¥ç¡®å®šå½±å“äººç±»å’ŒåŠ¨ç‰©è¡Œä¸ºçš„ä¸»è¦å› ç´ ã€‚\nç”Ÿæ€æ¯’ç†å­¦ï¼šSEMå¯ä»¥ç”¨äºç ”ç©¶æ±¡æŸ“ç‰©å¯¹ç”Ÿæ€ç³»ç»Ÿçš„å½±å“ã€‚é€šè¿‡SEMï¼Œå¯ä»¥ç¡®å®šå“ªäº›æ±¡æŸ“ç‰©æ˜¯æœ€æœ‰å®³çš„ï¼Œä»¥åŠå®ƒä»¬å¯¹ç”Ÿæ€ç³»ç»Ÿçš„å½±å“æ–¹å¼ã€‚\nExample åœ¨å®åŸºå› ç»„å¾®ç”Ÿç‰©ç”Ÿæ€å­¦ä¸­ï¼Œç ”ç©¶è€…é€šå¸¸ä¼šæµ‹é‡æ ·å“ä¸­å¤šä¸ªå¾®ç”Ÿç‰©ç¾¤è½çš„ç»„æˆå’Œå®ƒä»¬æ‰€å¤„çš„ç¯å¢ƒå˜é‡ï¼ˆå¦‚æ¸©åº¦ã€pHå€¼ç­‰ï¼‰ä¹‹é—´çš„å…³ç³»ã€‚ç„¶è€Œï¼Œè¿™äº›å¾®ç”Ÿç‰©ç¾¤è½ä¹‹é—´å¯èƒ½å­˜åœ¨ç›¸äº’ä½œç”¨ï¼Œå¦‚ç«äº‰ã€åˆä½œç­‰ï¼Œè¿™äº›ä½œç”¨å¯èƒ½ä¼šå½±å“åˆ°å®ƒä»¬ä¸ç¯å¢ƒä¹‹é—´çš„å…³ç³»ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼ŒSEMå¯ä»¥ç”¨æ¥å»ºç«‹å¾®ç”Ÿç‰©ç¾¤è½ä¸ç¯å¢ƒå˜é‡ä¹‹é—´çš„å…³ç³»ç½‘ç»œï¼ŒåŒæ—¶è€ƒè™‘å¾®ç”Ÿç‰©ç¾¤è½ä¹‹é—´çš„ç›¸äº’ä½œç”¨ã€‚\nä¾‹å¦‚ï¼Œä¸€é¡¹ç ”ç©¶è°ƒæŸ¥äº†æ¤ç‰©æ ¹é™…å¾®ç”Ÿç‰©ç¾¤è½ä¸åœŸå£¤æ€§è´¨ä¹‹é—´çš„å…³ç³»ã€‚ç ”ç©¶è€…æµ‹é‡äº†æ¤ç‰©æ ¹é™…ä¸­å¤šä¸ªå¾®ç”Ÿç‰©ç¾¤è½çš„ç»„æˆï¼Œä»¥åŠåœŸå£¤ä¸­çš„ä¸€äº›ç‰©ç†åŒ–å­¦æ€§è´¨ï¼Œå¦‚æœ‰æœºè´¨å«é‡ã€pHå€¼ç­‰ã€‚ä»–ä»¬ä½¿ç”¨SEMæ¥å»ºç«‹å¾®ç”Ÿç‰©ç¾¤è½ä¸åœŸå£¤æ€§è´¨ä¹‹é—´çš„å…³ç³»ç½‘ç»œï¼Œå¹¶åŒæ—¶è€ƒè™‘å¾®ç”Ÿç‰©ç¾¤è½ä¹‹é—´çš„ç›¸äº’ä½œç”¨ã€‚ä»–ä»¬å‘ç°ï¼Œå¾®ç”Ÿç‰©ç¾¤è½ä¹‹é—´å­˜åœ¨ç€å¤æ‚çš„ç›¸äº’ä½œç”¨ï¼Œè€Œè¿™äº›ç›¸äº’ä½œç”¨ä¼šå½±å“åˆ°å¾®ç”Ÿç‰©ç¾¤è½ä¸åœŸå£¤æ€§è´¨ä¹‹é—´çš„å…³ç³»ï¼Œæé«˜äº†å¯¹å¾®ç”Ÿç‰©ç¾¤è½ä¸ç¯å¢ƒä¹‹é—´å…³ç³»çš„ç†è§£ã€‚\nä¸‹é¢ç»™å‡ºä¸€ä¸ªç”¨Rç”Ÿæˆæ¨¡æ‹Ÿæ•°æ®å¹¶å®ç°SEMçš„ä¾‹å­ï¼Œå‡è®¾æˆ‘ä»¬ç ”ç©¶ä¸€äº›å¾®ç”Ÿç‰©å’Œå®ƒä»¬ç”Ÿé•¿ç¯å¢ƒä¹‹é—´çš„å…³ç³»ã€‚å…¶ä¸­ï¼Œç¯å¢ƒå› å­åŒ…æ‹¬pHã€æ¸©åº¦ã€ç›åº¦ï¼Œå¾®ç”Ÿç‰©åŒ…æ‹¬ç»†èŒã€çœŸèŒå’Œå¤èŒã€‚\né¦–å…ˆï¼Œæˆ‘ä»¬éœ€è¦ç”Ÿæˆä¸€äº›ç¬¦åˆæ­£æ€åˆ†å¸ƒçš„éšæœºæ•°æ®ä½œä¸ºæˆ‘ä»¬çš„å˜é‡ã€‚å…·ä½“ä»£ç å¦‚ä¸‹ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 library(mvtnorm) set.seed(123) # ç”Ÿæˆç¯å¢ƒå› å­æ•°æ® n \u0026lt;- 1000 mu_env \u0026lt;- c(pH = 7, temp = 25, salinity = 3) sigma_env \u0026lt;- matrix(c(1, 0.8, 0.5, 0.8, 1, 0.3, 0.5, 0.3, 1), ncol = 3) env \u0026lt;- rmvnorm(n, mean = mu_env, sigma = sigma_env)%\u0026gt;%as.data.frame() # ç”Ÿæˆå¾®ç”Ÿç‰©æ•°æ® mu_microbe \u0026lt;- c(bacteria = 20, fungi = 10, archaea = 5) sigma_microbe \u0026lt;- matrix(c(1, 0.5, 0.3, 0.5, 1, 0.2, 0.3, 0.2, 1), ncol = 3) microbe \u0026lt;- rmvnorm(n, mean = mu_microbe, sigma = sigma_microbe)%\u0026gt;%as.data.frame() # å°†ç”Ÿæˆçš„æ•°æ®åˆå¹¶ä¸ºä¸€ä¸ªæ•°æ®æ¡† df \u0026lt;- data.frame(env, microbe) æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬ä½¿ç”¨semå‡½æ•°å®ç°SEMã€‚å…·ä½“ä»£ç å¦‚ä¸‹ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 library(lavaan) model \u0026lt;- \u0026#39; # å®šä¹‰æµ‹é‡æ¨¡å‹ # bacteria =~ bacteria # fungi =~ fungi # archaea =~ archaea # å®šä¹‰ç»“æ„æ¨¡å‹ bacteria ~ pH + temp fungi ~ temp + salinity archaea ~ pH + salinity # ç›´æ¥æ•ˆåº” bacteria ~~ fungi bacteria ~~ archaea fungi ~~ archaea \u0026#39; # è¿è¡ŒSEM fit \u0026lt;- sem(model, data = df) # æŸ¥çœ‹SEMç»“æœ summary(fit) ## lavaan 0.6.15 ended normally after 22 iterations ## ## Estimator ML ## Optimization method NLMINB ## Number of model parameters 12 ## ## Number of observations 1000 ## ## Model Test User Model: ## ## Test statistic 3.024 ## Degrees of freedom 3 ## P-value (Chi-square) 0.388 ## ## Parameter Estimates: ## ## Standard errors Standard ## Information Expected ## Information saturated (h1) model Structured ## ## Regressions: ## Estimate Std.Err z-value P(\u0026gt;|z|) ## bacteria ~ ## pH -0.022 0.047 -0.463 0.643 ## temp 0.074 0.048 1.541 0.123 ## fungi ~ ## temp 0.019 0.033 0.574 0.566 ## salinity 0.024 0.029 0.828 0.408 ## archaea ~ ## pH 0.017 0.036 0.481 0.631 ## salinity 0.028 0.034 0.822 0.411 ## ## Covariances: ## Estimate Std.Err z-value P(\u0026gt;|z|) ## .bacteria ~~ ## .fungi 0.467 0.035 13.496 0.000 ## .archaea 0.295 0.032 9.221 0.000 ## .fungi ~~ ## .archaea 0.183 0.031 5.869 0.000 ## ## Variances: ## Estimate Std.Err z-value P(\u0026gt;|z|) ## .bacteria 0.990 0.044 22.361 0.000 ## .fungi 0.988 0.044 22.361 0.000 ## .archaea 0.948 0.042 22.361 0.000 æœ€åï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨semPlotå‡½æ•°ç»˜åˆ¶SEMå›¾å½¢ï¼Œä»¥ä¾¿æ›´å¥½åœ°ç†è§£SEMæ¨¡å‹çš„ç»“æ„ã€‚å…·ä½“ä»£ç å¦‚ä¸‹ï¼š\n1 2 3 library(semPlot) semPaths(fit, what = \u0026#34;std\u0026#34;, nCharNodes = 10, sizeMan = 8, edge.label.cex = 1.1, curvePivot = TRUE, fade = FALSE) è¿è¡Œä¸Šè¿°ä»£ç åï¼Œæˆ‘ä»¬å°±å¾—åˆ°äº†ä¸€ä¸ªå¯è§†åŒ–çš„SEMæ¨¡å‹å›¾ï¼Œè¯¥æ¨¡å‹æè¿°äº†å¾®ç”Ÿç‰©å’Œç¯å¢ƒå› å­ä¹‹é—´çš„å…³ç³»ã€‚ Pro ","date":"2023-04-19T00:00:00Z","permalink":"/p/sem/","title":"ç»“æ„æ–¹ç¨‹æ¨¡å‹ï¼ˆSEMï¼‰å­¦ä¹ "},{"content":"è¿™ç¯‡æ–‡ç« ä¸»è¦æ˜¯ä»‹ç»ç»˜åˆ¶è¿›åŒ–æ ‘ç”¨çš„ggtreeä»¥åŠä¸€äº›æ‹“å±•åŒ…çš„åŸºç¡€ç”¨æ³•ï¼Œå› ä¸ºggç³»åˆ—ç»˜å›¾çš„é€»è¾‘åŸºæœ¬æ˜¯æ­ç§¯æœ¨ï¼Œè¿™ç§ä»‹ç»æ€§çš„æ–‡ç« èƒ½å¤Ÿå¸®åŠ©å¿«é€Ÿçš„æ‰¾åˆ°æƒ³è¦çš„â€œç§¯æœ¨â€ä»¥åŠæ‹¼æ¥çš„æ–¹æ³•ï¼Œå‰©ä¸‹çš„å°±æ˜¯éšå¿ƒæ‰€æ¬²è®¾è®¡æƒ³è¦çš„å›¾äº†ã€‚æ‰€ä»¥è¿™ç¯‡å‡ºçš„å›¾å¯èƒ½ä¸æ˜¯å¾ˆâ€œæ¼‚äº®â€ï¼Œä¸‹æ¬¡ä¸€å®šæä¸€ç¯‡æä¾›å¤ç°å„ç§æ–‡ç« ç¾å›¾çš„ä»£ç çš„æ¨æ–‡ğŸ’ªã€‚\nIntroduction åœ¨æ•°å­¦ä¸­ï¼Œâ€œæ ‘â€æ˜¯ä¸€ç§ç‰¹æ®Šçš„æ— å‘å›¾ï¼Œå®ƒæ²¡æœ‰ä»»ä½•å¾ªç¯ï¼Œå¹¶ä¸”ä»»æ„ä¸¤ä¸ªé¡¶ç‚¹ä¹‹é—´éƒ½åªæœ‰ä¸€æ¡ç®€å•è·¯å¾„ã€‚æ ‘é€šå¸¸ç”¨äºå»ºç«‹å±‚æ¬¡å…³ç³»ï¼Œæ¯”å¦‚åœ¨è®¡ç®—æœºç§‘å­¦ä¸­ï¼Œç”¨æ ‘æ¥è¡¨ç¤ºæ–‡ä»¶ç³»ç»Ÿã€ç¨‹åºçš„è°ƒç”¨å…³ç³»ã€HTMLæ–‡æ¡£çš„DOMç»“æ„ç­‰ç­‰ã€‚æ ‘ä¹Ÿæ˜¯ç®—æ³•å’Œæ•°æ®ç»“æ„ä¸­éå¸¸é‡è¦çš„æ¦‚å¿µï¼Œè®¸å¤šé—®é¢˜å¯ä»¥ç”¨æ ‘æ¥è§£å†³ï¼Œæ¯”å¦‚æœç´¢ã€æ’åºã€ç¼–ç ç­‰ç­‰ã€‚\nç³»ç»Ÿå‘è‚²æ ‘ï¼ˆPhylogenetic treeï¼‰ æ˜¯ä¸€ç§ç”¨äºæè¿°ä¸åŒç‰©ç§æˆ–ç”Ÿç‰©ä½“ç³»ä¹‹é—´è¿›åŒ–å…³ç³»çš„æ ‘å½¢ç»“æ„ã€‚å®ƒæ˜¯ä¸€ç§åˆ†æ”¯å›¾ï¼Œç”¨äºè¡¨ç¤ºç”Ÿå‘½çš„è¿›åŒ–å†å²ï¼Œä»å…±åŒç¥–å…ˆå¼€å§‹ï¼Œæ²¿ç€æ—¶é—´è½´å‘åå±•å¼€ã€‚ç³»ç»Ÿå‘è‚²æ ‘é€šå¸¸æ˜¯åŸºäºå„ç§ç”Ÿç‰©å­¦æ•°æ®çš„åˆ†ææ‰€å»ºç«‹çš„ï¼Œå¦‚å½¢æ€ç‰¹å¾ã€åŸºå› åºåˆ—ã€è›‹ç™½è´¨åºåˆ—ã€ç”ŸåŒ–ååº”ç­‰ï¼Œä»¥ä¾¿è¯†åˆ«ç‰©ç§ä¹‹é—´çš„é—ä¼ å˜å¼‚å’Œæ¼”åŒ–è¶‹åŠ¿ã€‚\nç³»ç»Ÿå‘è‚²æ ‘çš„æ ‘æä»£è¡¨æ¼”åŒ–åˆ†æ”¯ï¼ŒèŠ‚ç‚¹è¡¨ç¤ºå„ä¸ªç‰©ç§çš„æœ€è¿‘å…±åŒç¥–å…ˆï¼Œæ ‘æçš„é•¿åº¦è¡¨ç¤ºæ¼”åŒ–è·ç¦»æˆ–è¿›åŒ–æ—¶é—´ã€‚ç³»ç»Ÿå‘è‚²æ ‘çš„å½¢çŠ¶å’Œç»“æ„å¯ä»¥å¸®åŠ©æˆ‘ä»¬ç†è§£ä¸åŒç‰©ç§ä¹‹é—´çš„äº²ç¼˜å…³ç³»ï¼Œäº†è§£ç”Ÿç‰©è¿›åŒ–å’Œæ¼”åŒ–è¿‡ç¨‹ã€‚åœ¨ç”Ÿç‰©åˆ†ç±»å­¦ã€ç”Ÿæ€å­¦ã€ç”Ÿç‰©åœ°ç†å­¦å’Œç”Ÿç‰©æŠ€æœ¯ç­‰é¢†åŸŸä¸­ï¼Œç³»ç»Ÿå‘è‚²æ ‘éƒ½å…·æœ‰é‡è¦çš„åº”ç”¨ä»·å€¼ã€‚\nVisualization æœ‰å¾ˆå¤šè½¯ä»¶å¹³å°å¯ä»¥ç”¨æ¥å¯è§†åŒ–Phylogenetic treeï¼Œä¸‹é¢åˆ—ä¸¾ä¸€äº›æ¯”è¾ƒå¸¸ç”¨çš„ï¼š\niTOL (Interactive Tree Of Life)ï¼šè¿™æ˜¯ä¸€ä¸ªåœ¨çº¿å·¥å…·ï¼Œå¯ä»¥æ–¹ä¾¿åœ°åˆ›å»ºã€æ³¨é‡Šå’Œå¯è§†åŒ–Phylogenetic treeã€‚å®ƒæä¾›äº†å¤šç§æ ·å¼å’Œæ³¨é‡Šé€‰é¡¹ï¼Œå¯ä»¥æ ¹æ®éœ€æ±‚è‡ªå®šä¹‰æ˜¾ç¤ºæ•ˆæœã€‚ç½‘å€ä¸ºï¼šhttps://itol.embl.de/ï¼ˆä¸ä»˜è´¹çš„è¯æ— æ³•ä¿å­˜ä¸­é—´æ­¥éª¤ï¼Œæ³¨é‡Šæ–¹æ³•ä¸å¤ªå‹å¥½[Doge]ï¼‰\nFigTreeï¼šè¿™æ˜¯ä¸€ä¸ªå…è´¹çš„è½¯ä»¶ï¼Œå¯ä»¥åœ¨Macå’ŒWindowsç³»ç»Ÿä¸Šè¿è¡Œã€‚å®ƒå¯ä»¥å¯è§†åŒ–Nexusã€Newickå’ŒNexmlç­‰æ ¼å¼çš„Phylogenetic treeï¼Œå¹¶æä¾›äº†å¤šç§æ ·å¼å’Œæ³¨é‡Šé€‰é¡¹ã€‚ç½‘å€ä¸ºï¼šhttp://tree.bio.ed.ac.uk/software/figtree/\nPhylo.ioï¼šè¿™ä¹Ÿæ˜¯ä¸€ä¸ªåœ¨çº¿å·¥å…·ï¼Œå¯ä»¥å¯è§†åŒ–Phylogenetic treeå¹¶è¿›è¡Œè‡ªå®šä¹‰æ³¨é‡Šã€‚å®ƒè¿˜æä¾›äº†äº¤äº’å¼åŠŸèƒ½ï¼Œå¯ä»¥æ¢ç´¢å’Œæ¯”è¾ƒä¸åŒéƒ¨åˆ†ä¹‹é—´çš„å…³ç³»ã€‚ç½‘å€ä¸ºï¼šhttps://phylo.io/\nDendroscopeï¼šè¿™æ˜¯ä¸€ä¸ªåŸºäºJavaçš„è½¯ä»¶ï¼Œå¯ä»¥ç”¨æ¥å¯è§†åŒ–Phylogenetic treeå¹¶è¿›è¡Œæ¯”è¾ƒå’Œæ³¨é‡Šã€‚å®ƒæ”¯æŒå¤šç§æ–‡ä»¶æ ¼å¼ï¼ŒåŒ…æ‹¬Nexusã€Newickã€Phylipç­‰ã€‚ç½‘å€ä¸ºï¼šhttp://dendroscope.org/\nMEGA (Molecular Evolutionary Genetics Analysis)ï¼šè¿™æ˜¯ä¸€ä¸ªå…è´¹çš„è½¯ä»¶ï¼Œå¯ä»¥ç”¨äºåˆ†å­è¿›åŒ–åˆ†æå’Œå¯è§†åŒ–ã€‚å®ƒå¯ä»¥åˆ›å»ºã€æ³¨é‡Šå’Œå¯è§†åŒ–Phylogenetic treeï¼Œå¹¶æä¾›äº†å¤šç§æ ·å¼å’Œæ³¨é‡Šé€‰é¡¹ã€‚ç½‘å€ä¸ºï¼šhttps://www.megasoftware.net/\nå½“ç„¶ï¼Œåœ¨çº¿å¹³å°å’Œå¸¦GUIç•Œé¢çš„è½¯ä»¶æœ‰ä¸€å®šå¼Šç«¯ï¼Œæ“çºµä¸æ˜¯é‚£ä¹ˆè‡ªç”±ã€‚åœ¨Rè¯­è¨€ä¸­ï¼Œç”¨äºå¯è§†åŒ–Phylogenetic treeçš„åŒ…ä¹Ÿæœ‰å¾ˆå¤šï¼š\nggtree (1) +ggtreeExtra (2) ï¼šYå”çš„ç¥åŒ…ï¼ŒåŸºäºggplot2è¯­æ³•ï¼Œå­¦èµ·æ¥æ¯”è¾ƒæµç•…ï¼Œæä¾›é«˜åº¦å¯å®šåˆ¶åŒ–çš„ç»˜å›¾ï¼Œæ”¯æŒå„ç§ä¸åŒç±»å‹çš„è¿›åŒ–æ ‘ã€‚æ˜¯æˆ‘ä»¬è¦è®²çš„é‡ç‚¹ï¼Œç”»æ ‘æŒæ¡è¿™ä¸¤ä¸ªåŒ…åŸºæœ¬å°±å¤Ÿäº†ã€‚å®˜æ–¹è‹±æ–‡æ•™ç¨‹ï¼›ç°åœ¨Yå”çš„ä¸­æ–‡æ•™ç¨‹ä¹Ÿåœ¨çƒ­å–ä¸­ã€‚\napeï¼šæä¾›äº†ç”¨äºç»˜åˆ¶åŸºæœ¬çš„è¿›åŒ–æ ‘å’Œä¸€äº›ç®€å•çš„æ ‘çš„å¯è§†åŒ–å‡½æ•°ï¼ŒåŸºç¡€å‡½æ•°è¿˜æ˜¯éå¸¸æœ‰ç”¨çš„ï¼Œphyloå¯¹è±¡ä¹Ÿæ˜¯ä¸€ç›´è¦ç”¨çš„ã€‚\nphytoolsï¼šæä¾›äº†å¤šç§ç”¨äºç»˜åˆ¶è¿›åŒ–æ ‘çš„å‡½æ•°ï¼ŒåŒ…æ‹¬å˜å½¢è¿›åŒ–æ ‘çš„å‡½æ•°ã€‚\nggphyloï¼šåŸºäºggplot2è¯­æ³•ï¼Œæä¾›äº†ä¸€äº›ç”¨äºç»˜åˆ¶è¿›åŒ–æ ‘çš„å‡½æ•°ï¼Œæ”¯æŒå¤šç§ä¸åŒçš„æ ‘å½¢æ€ã€‚\næˆ‘ä»¬å¯ä»¥å…ˆå®‰è£…è½½å…¥ä¸€äº›åŒ…ã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 if (!requireNamespace(\u0026#34;BiocManager\u0026#34;, quietly=TRUE)) install.packages(\u0026#34;BiocManager\u0026#34;) BiocManager::install(\u0026#34;YuLab-SMU/treedataverse\u0026#34;) BiocManager::install(\u0026#34;ggtree\u0026#34;) BiocManager::install(\u0026#34;ggtreeExtra\u0026#34;) library(dplyr) library(ggplot2) library(treedataverse) library(ggtree) library(ggtreeExtra) format é¦–å…ˆæˆ‘ä»¬è¿˜æ˜¯ä»‹ç»ä¸€ä¸‹å­˜å‚¨æ ‘çš„ä¸€äº›æ–‡ä»¶æ ¼å¼å’Œè¯»å–æ–¹æ³•ï¼ˆæ¯•ç«Ÿè¯»å…¥æ•°æ®ä¸€ç›´æ˜¯å¯è§†åŒ–çš„ç¬¬ä¸€æ­¥ï¼‰ã€‚\nNewickæ ¼å¼ (.newick æˆ– .nwk)ï¼šNewickæ ¼å¼æ˜¯æœ€å¸¸è§çš„ç”¨äºå­˜å‚¨å’Œä¼ è¾“ç³»ç»Ÿå‘è‚²æ ‘çš„æ ¼å¼ä¹‹ä¸€ã€‚å®ƒæ˜¯ä¸€ç§æ–‡æœ¬æ ¼å¼ï¼Œå¯ä»¥ä½¿ç”¨æ–‡æœ¬ç¼–è¾‘å™¨æ‰“å¼€å’Œç¼–è¾‘ã€‚åœ¨Newickæ ¼å¼ä¸­ï¼Œæ¯ä¸ªèŠ‚ç‚¹ç”±ä¸€ä¸ªæ‹¬å·è¡¨ç¤ºï¼Œå…¶åé¢è·Ÿç€ä¸€ä¸ªè¡¨ç¤ºè¯¥èŠ‚ç‚¹çš„æ ‡ç­¾å’Œä¸€ä¸ªå†’å·ï¼Œç„¶åæ˜¯ä¸€ä¸ªè¡¨ç¤ºè¯¥èŠ‚ç‚¹çš„åˆ†æ”¯é•¿åº¦çš„æ•°å­—ï¼Œæœ€åè·Ÿç€é€—å·å’Œä¸‹ä¸€ä¸ªèŠ‚ç‚¹çš„æ‹¬å·ã€‚å¶èŠ‚ç‚¹æ˜¯æ²¡æœ‰å­èŠ‚ç‚¹çš„èŠ‚ç‚¹ã€‚\nNexusæ ¼å¼ (.nex æˆ– .nexus)ï¼šNexusæ ¼å¼æ˜¯ä¸€ç§å¹¿æ³›ä½¿ç”¨çš„ç”¨äºå­˜å‚¨åˆ†å­ç³»ç»Ÿå‘è‚²æ ‘å’Œå…¶ä»–åˆ†å­ç”Ÿç‰©å­¦æ•°æ®çš„æ ¼å¼ã€‚å®ƒæ˜¯ä¸€ç§æ–‡æœ¬æ ¼å¼ï¼Œå¯ä»¥ä½¿ç”¨æ–‡æœ¬ç¼–è¾‘å™¨æ‰“å¼€å’Œç¼–è¾‘ã€‚Nexusæ ¼å¼å…è®¸å­˜å‚¨å¤šä¸ªæ•°æ®é›†å’Œå¤šä¸ªæ ‘ï¼Œå¹¶æä¾›äº†ä¸€äº›å…¶ä»–çš„æ‰©å±•åŠŸèƒ½ï¼Œå¦‚æ³¨é‡Šã€åŒºåˆ†å­—ç¬¦ç­‰ã€‚\nPhyloXMLæ ¼å¼ (.xml)ï¼šPhyloXMLæ ¼å¼æ˜¯ä¸€ç§åŸºäºXMLçš„æ ¼å¼ï¼Œä¸“é—¨ç”¨äºå­˜å‚¨å’Œä¼ è¾“ç³»ç»Ÿå‘è‚²æ ‘ã€‚å®ƒæä¾›äº†è®¸å¤šå…¶ä»–æ ¼å¼æ‰€ä¸å…·å¤‡çš„çµæ´»æ€§å’Œæ‰©å±•æ€§ï¼Œå¯ä»¥å­˜å‚¨å¤§é‡çš„ä¿¡æ¯ï¼Œå¦‚èŠ‚ç‚¹æ³¨é‡Šã€æ”¯æŒå€¼ã€åˆ†æ”¯é•¿åº¦ã€æ”¯æŒç‡ç­‰ã€‚\nNeXMLæ ¼å¼ (.xml)ï¼šNeXMLæ ¼å¼æ˜¯ä¸€ç§åŸºäºXMLçš„æ ¼å¼ï¼Œç”¨äºå­˜å‚¨å’Œä¼ è¾“ç”Ÿç‰©å¤šæ ·æ€§å’Œç³»ç»Ÿå‘è‚²æ ‘æ•°æ®ã€‚å®ƒæä¾›äº†PhyloXMLæ ¼å¼çš„æ‰€æœ‰åŠŸèƒ½ï¼Œå¹¶æ·»åŠ äº†ä¸€äº›é¢å¤–çš„åŠŸèƒ½ï¼Œå¦‚å­˜å‚¨ç”Ÿç‰©å¤šæ ·æ€§å…ƒæ•°æ®ã€äº‹ä»¶ã€ä¼ è¾“ç½‘æ ¼æ•°æ®ç­‰ã€‚\nå…¶ä»–è¿˜æœ‰Phylip æ ¼å¼ (.phy æˆ– .phylip)ï¼ŒPAUP æ ¼å¼ (.paup)ï¼ŒIQ-TREE æ ¼å¼ (.tree)ï¼ŒRAxML æ ¼å¼ (.raxml)ï¼ŒMEGA æ ¼å¼ (.meg)ç­‰ç­‰ã€‚\nåœ¨Rä¸­ï¼Œå¯ä»¥ä½¿ç”¨ä¸åŒçš„åŒ…å’Œå‡½æ•°æ¥è¯»å–ä¸åŒæ ¼å¼çš„ç³»ç»Ÿå‘è‚²æ ‘æ–‡ä»¶ã€‚å¦‚ ape åŒ…ä¸­çš„ read.tree() å‡½æ•°å¯ä»¥è¯»å–Newickæ ¼å¼çš„ç³»ç»Ÿå‘è‚²æ ‘æ–‡ä»¶ã€ phangorn åŒ…ä¸­çš„ read.phyDat() å’Œ read.phylo() å‡½æ•°è¯»å–åŒ…æ‹¬Nexusã€Newickã€Phylipç­‰æ ¼å¼ã€‚\nå½“ç„¶ï¼ŒYå”å›¢é˜Ÿä¹Ÿè´´å¿ƒåœ°å‡†å¤‡å¥½äº†ä¸€ä¸ªåŒ… treeio ç”¨äºè¯»å–ã€å¤„ç†å„ç§ç³»ç»Ÿå‘è‚²æ ‘æ–‡ä»¶æ ¼å¼ï¼š\n1 2 3 4 5 6 7 library(treeio) # ä» Newick æ ¼å¼è¯»å–ç³»ç»Ÿå‘è‚²æ ‘æ•°æ® tree \u0026lt;- read.tree(\u0026#34;tree.nwk\u0026#34;) # ä» Nexus æ ¼å¼è¯»å–ç³»ç»Ÿå‘è‚²æ ‘æ•°æ® tree \u0026lt;- read.nexus(\u0026#34;tree.nexus\u0026#34;) # ä» Phylip æ ¼å¼è¯»å–ç³»ç»Ÿå‘è‚²æ ‘æ•°æ® tree \u0026lt;- read.phylo(\u0026#34;tree.phy\u0026#34;) Nexusã€Newickã€Phylipè¿™å‡ ç§æ ¼å¼è¯»å…¥åä¼šå˜æˆå¸¸è§çš„phylo S3å¯¹è±¡ï¼Œå…¶ä»–æ ¼å¼è¯»å…¥åä¸€èˆ¬ä¼šå˜æˆtreedata S4å¯¹è±¡ï¼ˆæ›´é«˜çº§å…¨é¢çš„ä¸€ä¸ªå¯¹è±¡ï¼Œå½“ç„¶äº¦å¯ä»¥å’Œphyloç›¸äº’è½¬æ¢ï¼‰ï¼Œè¿™ä¸¤ç§å¯¹è±¡éƒ½å¯ä»¥ç›´æ¥ä½¿ç”¨ggtreeç”»å›¾çš„ï¼Œæˆ‘ä»¬åªè¦è¯»å…¥å°±å¥½ã€‚\nbasic plot 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 set.seed(1234) #ç”Ÿæˆç¤ºä¾‹æ ‘ tree=rtree(50) (main_p=ggtree(tree, mapping = NULL, layout = \u0026#34;rectangular\u0026#34;,#å¸¸ç”¨circularï¼Œdaylight open.angle = 0,#éƒ¨åˆ†æ”¯æŒï¼Œå¦‚fan mrsd = NULL,#æ—¶é—´è½´ as.Date = FALSE, yscale = \u0026#34;none\u0026#34;, yscale_mapping = NULL, ladderize = TRUE,#é˜¶æ¢¯çŠ¶æ’åˆ—æ ‘ right = FALSE, branch.length = \u0026#34;branch.length\u0026#34;,#\u0026#34;none\u0026#34;å°±ä¼šè®©branchæœ«ç«¯éƒ½å¯¹é½ root.position = 0, xlim = NULL, #çº¿æ®µé£æ ¼ color=\u0026#34;black\u0026#34;, size=0.5, linetype=1)) layout æ•´æ£µæ ‘çš„å¸ƒå±€æ–¹å¼æœ‰å¾ˆå¤šâ€™rectangularâ€™, â€˜dendrogramâ€™, â€˜slantedâ€™, â€˜ellipseâ€™, â€˜roundrectâ€™, â€˜fanâ€™, â€˜circularâ€™, â€˜inward_circularâ€™, â€˜radialâ€™, â€˜equal_angleâ€™, â€˜daylightâ€™ or â€˜apeâ€™ï¼Œä¹Ÿå¯ä»¥ç”¨å…¶å®ƒä¸€äº›å‚æ•°è°ƒèŠ‚ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 ggtree(tree) ggtree(tree, layout=\u0026#34;roundrect\u0026#34;) ggtree(tree, layout=\u0026#34;slanted\u0026#34;) ggtree(tree, layout=\u0026#34;ellipse\u0026#34;) ggtree(tree, layout=\u0026#34;circular\u0026#34;) ggtree(tree, layout=\u0026#34;fan\u0026#34;, open.angle=120) ggtree(tree, layout=\u0026#34;equal_angle\u0026#34;) ggtree(tree, layout=\u0026#34;daylight\u0026#34;) ggtree(tree, branch.length=\u0026#39;none\u0026#39;) ggtree(tree, layout=\u0026#34;ellipse\u0026#34;, branch.length=\u0026#34;none\u0026#34;) ggtree(tree, layout=\u0026#39;circular\u0026#39;, branch.length=\u0026#39;none\u0026#39;) ggtree(tree, layout=\u0026#34;daylight\u0026#34;, branch.length = \u0026#39;none\u0026#39;) 1 2 3 4 5 6 7 8 9 10 11 ggtree(tree) + scale_x_reverse()#å·¦å³é¢ å€’ ggtree(tree) + coord_flip()#ä¸Šä¸‹é¢ å€’ ggtree(tree) + layout_dendrogram()#åªçœ‹éª¨æ¶ ggplotify::as.ggplot(ggtree(tree), angle=-30, scale=.9)#æ—‹è½¬ç‰¹å®šè§’åº¦å’Œç¼©æ”¾ ggtree(tree, layout=\u0026#39;slanted\u0026#39;) + coord_flip() ggtree(tree, layout=\u0026#39;slanted\u0026#39;, branch.length=\u0026#39;none\u0026#39;) + layout_dendrogram() ggtree(tree, layout=\u0026#39;circular\u0026#39;) + xlim(-10, NA)#æ‰©å¤§æ ‘ä¸­é—´çš„ç©ºç™½åŒºåŸŸ ggtree(tree) + layout_inward_circular()#å†…å¤–é¢ å€’ ggtree(tree) + layout_inward_circular(xlim=15) label 1 2 #å¯¹é½åŠ è™šçº¿ main_p+geom_tiplab(align = T,linetype = 3,linesize = 0.5,size=2,color=\u0026#34;red\u0026#34;) 1 2 #å¯¹é½ä¸åŠ è™šçº¿ main_p+geom_tiplab(align = F,size=4,color=\u0026#34;blue\u0026#34;,as_ylab = T) 1 2 #åŠ ä¸Šå†…éƒ¨èŠ‚ç‚¹åç§° ggtree(tree)+geom_nodelab(mapping = aes(label=node)) 1 2 #æ¯”ä¾‹å°º main_p+geom_treescale(fontsize=6, linesize=1, offset=1, width=1, color=\u0026#39;red\u0026#39;) manipulate æˆ‘ä»¬å¯ä»¥ä½¿ç”¨tidytree::as_tibbleæˆ–è€…ggtree::fortifyæŠŠæ•´ä¸ªæ ‘ï¼ˆphyloå¯¹è±¡ï¼‰è½¬ä¸ºä¸€ä¸ªæ˜“äºé˜…è¯»çš„dataframeã€‚\nparentå’Œnodeä¸¤åˆ—å±•ç¤ºäº†æ•´ä¸ªæ ‘çš„è¿æ¥å…³ç³»,branch.lengthæ˜¯æ¯ä¸ªæï¼ˆè¿æ¥parentå’Œnodeï¼‰çš„æé•¿ï¼Œlabelæ˜¯nodeçš„labelï¼Œä¸€èˆ¬æ¯ä¸ªtipï¼ˆç«¯ç‚¹ï¼‰éƒ½ä¼šæœ‰ä¸€ä¸ªlabelï¼Œå†…éƒ¨çš„ç‚¹å¯èƒ½æ²¡æœ‰labelï¼ˆæ¯”å¦‚è¿™ä¸ªç¤ºä¾‹ï¼‰ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥æ‰‹åŠ¨åŠ ä¸Šã€‚\n1 tidytree::as_tibble(tree)%\u0026gt;%head() ## # A tibble: 6 Ã— 4 ## parent node branch.length label ## \u0026lt;int\u0026gt; \u0026lt;int\u0026gt; \u0026lt;dbl\u0026gt; \u0026lt;chr\u0026gt; ## 1 58 1 0.318 t2 ## 2 59 2 0.634 t47 ## 3 59 3 0.127 t40 ## 4 57 4 0.423 t20 ## 5 56 5 0.914 t44 ## 6 55 6 0.468 t3 1 2 tree_df=ggtree::fortify(tree) head(tree_df) ## # A tibble: 6 Ã— 9 ## parent node branch.length label isTip x y branch angle ## \u0026lt;int\u0026gt; \u0026lt;int\u0026gt; \u0026lt;dbl\u0026gt; \u0026lt;chr\u0026gt; \u0026lt;lgl\u0026gt; \u0026lt;dbl\u0026gt; \u0026lt;dbl\u0026gt; \u0026lt;dbl\u0026gt; \u0026lt;dbl\u0026gt; ## 1 58 1 0.318 t2 TRUE 4.28 48 4.12 346. ## 2 59 2 0.634 t47 TRUE 5.55 49 5.24 353. ## 3 59 3 0.127 t40 TRUE 5.05 50 4.98 360 ## 4 57 4 0.423 t20 TRUE 3.88 47 3.67 338. ## 5 56 5 0.914 t44 TRUE 3.87 46 3.42 331. ## 6 55 6 0.468 t3 TRUE 3.17 45 2.94 324 æˆ‘ä»¬å¯ä»¥ç”¨ä»¥ä¸‹æ–¹æ³•è®¿é—®æ ‘çš„èŠ‚ç‚¹ï¼ˆnodeï¼‰çš„å…³ç³»èŠ‚ç‚¹ï¼Œå¯ä»¥é€šè¿‡treeæˆ–è€…treeç”Ÿæˆçš„dataframeæŸ¥è¯¢ï¼š\n1 2 library(tidytree) child(tree, 53)#å­èŠ‚ç‚¹,ä¸€å±‚ ## [1] 54 63 1 parent(tree, 1)#çˆ¶èŠ‚ç‚¹ï¼Œä¸€å±‚ ## [1] 58 1 offspring(tree, 53)#æ‰€æœ‰çš„å­èŠ‚ç‚¹ï¼ŒåŒ…æ‹¬å­èŠ‚ç‚¹çš„å­èŠ‚ç‚¹ ## [1] 54 63 55 60 56 6 57 5 58 4 1 59 2 3 7 61 62 10 8 9 64 67 65 66 11 ## [26] 12 13 14 15 16 1 ancestor(tree, 1)#æ‰€æœ‰çš„çˆ¶èŠ‚ç‚¹ï¼ŒåŒ…æ‹¬çˆ¶èŠ‚ç‚¹çš„çˆ¶èŠ‚ç‚¹ ## [1] 58 57 56 55 54 53 52 51 1 sibling(tree, 1)#å…„å¼ŸèŠ‚ç‚¹ ## [1] 59 1 MRCA(tree, 1, 2)#æœ€è¿‘ç¥–å…ˆ ## [1] 58 èŠ‚ç‚¹åˆ†ç»„\ngroupOTU() å’Œ groupClade() æ–¹æ³•æ—¨åœ¨å°†åˆ†ç±»ç¾¤åˆ†ç»„ä¿¡æ¯æ·»åŠ åˆ°è¾“å…¥æ ‘å¯¹è±¡ï¼Œè¿™ç§åˆ†ç»„ä¿¡æ¯å¯ä»¥ç›´æ¥ç”¨åœ¨ ggtree çš„æ ‘å¯è§†åŒ–ä¸­ã€‚\ngroupOTU() è¾“å…¥çš„æ˜¯è¦ç»™åˆ†ç»„ä¸‹çš„æ¯ä¸ªnodeã€‚\ngroupClade() è¾“å…¥ç»™æ¯ä¸ªåˆ†ç»„çš„æœ€é«˜çº§nodeå³å¯ï¼Œä¼šè‡ªåŠ¨åˆ†é…è¯¥nodeä¸‹æ‰€æœ‰offspring nodeåŒä¸€ä¸ªåˆ†ç»„ã€‚\n1 groupOTU(tree, .node = c(52,53),group_name = \u0026#34;OTU\u0026#34;)%\u0026gt;%as_tibble()%\u0026gt;%head ## # A tibble: 6 Ã— 5 ## parent node branch.length label OTU ## \u0026lt;int\u0026gt; \u0026lt;int\u0026gt; \u0026lt;dbl\u0026gt; \u0026lt;chr\u0026gt; \u0026lt;fct\u0026gt; ## 1 58 1 0.318 t2 0 ## 2 59 2 0.634 t47 0 ## 3 59 3 0.127 t40 0 ## 4 57 4 0.423 t20 0 ## 5 56 5 0.914 t44 0 ## 6 55 6 0.468 t3 0 1 groupClade(tree, .node = c(52,53),group_name = \u0026#34;Clade\u0026#34;)%\u0026gt;%as_tibble()%\u0026gt;%head ## # A tibble: 6 Ã— 5 ## parent node branch.length label Clade ## \u0026lt;int\u0026gt; \u0026lt;int\u0026gt; \u0026lt;dbl\u0026gt; \u0026lt;chr\u0026gt; \u0026lt;fct\u0026gt; ## 1 58 1 0.318 t2 2 ## 2 59 2 0.634 t47 2 ## 3 59 3 0.127 t40 2 ## 4 57 4 0.423 t20 2 ## 5 56 5 0.914 t44 2 ## 6 55 6 0.468 t3 2 å–æ ‘çš„å­é›†\n1 2 3 4 5 6 7 clade \u0026lt;- tree_subset(tree, node=53, levels_back=0) clade2 \u0026lt;- tree_subset(tree, node=53, levels_back=1) p1 \u0026lt;- ggtree(clade) + geom_tiplab() + xlim(0, 5) p2 \u0026lt;- ggtree(clade2, aes(color=group)) + geom_tiplab() + xlim(0, 9) + scale_color_manual(values=c(\u0026#34;black\u0026#34;, \u0026#34;red\u0026#34;)) p1+p2 å…¶ä»–ä¸€äº›æ“ä½œ:\n1 2 3 4 5 6 7 8 #é‡è®¾æ ‘æ ¹,æŒ‡å®šå¤–ç±»ç¾¤ trda2 \u0026lt;- root(tree, outgroup = 104, edgelabel = TRUE) #ç¼©æ”¾æ ‘æ rescale_tree(tree, \u0026#39;dN\u0026#39;) #åˆ é™¤tip drop.tip(tree,1:5) annotation tip annotation è¿™ç±»æ³¨é‡Šæ–¹æ³•ä½¿ç”¨çš„æ³¨é‡Šæ•°æ®é›†åŸºæœ¬æ˜¯ä¸€åˆ—æ˜¯tipçš„nodeå·æˆ–labelï¼Œå…¶ä»–åˆ—ä¸ºæ³¨é‡Šæ•°æ®ï¼ˆåˆ†ç±»æ•°æ®/è¿ç»­æ•°å€¼æ•°æ®ï¼‰ï¼Œæ¯ä¸€è¡Œæ˜¯ä¸€ä¸ªtipã€‚\nggtreeæœ¬èº«è‡ªå¸¦ä¸€äº›å®ç°tipæ³¨é‡Šï¼ˆæ·»åŠ çƒ­å›¾ç­‰å¯¹è±¡ï¼‰çš„åŠŸèƒ½ï¼ŒåŸºäºfacetä»¥åŠæ•°æ®å¯¹é½tipï¼š\n1 2 3 4 5 6 #ç”Ÿæˆæµ‹è¯•æ³¨é‡Šæ–‡ä»¶ anno=data.frame(row.names = tree$tip.label,node=tree$tip.label, Group=sample(LETTERS[1:3],50,replace = T), Type=sample(letters[1:3],50,replace = T), value1=abs(rnorm(50)),high=abs(rnorm(50,5))) head(anno) ## node Group Type value1 high ## t2 t2 B a 1.41126240 5.287710 ## t47 t47 B c 0.83758243 4.340230 ## t40 t40 B a 1.12376279 7.919140 ## t20 t20 A a 3.04376589 5.677416 ## t44 t44 A b 0.23502131 4.315680 ## t3 t3 C a 0.03325861 5.186492 1 2 3 p=ggtree(tree)+geom_tiplab(align = T) gheatmap(p, anno[\u0026#34;Group\u0026#34;], offset=0, width=0.2) æˆ–è€…ä½¿ç”¨aplotåŒ…è¿›è¡Œä¼šè‡ªåŠ¨å¯¹é½tipçš„ç»„å›¾ï¼ˆç”¨cowplotæ— æ³•å®ç°ï¼‰ï¼Œä½†ç¼ºç‚¹å°±æ˜¯ç»„å›¾æ—¶å€™çš„ä¸€äº›ç»†èŠ‚ä¸å¥½è°ƒèŠ‚ï¼Œä¸”è¦è€ƒè™‘æ¸…æ¥šå„ä¸ªåˆ†é¢insertçš„å…³ç³»å’Œå®½åº¦ã€‚\n1 2 3 4 5 6 library(aplot) ap1=ggplot(anno,aes(x=node,y=\u0026#34;Group\u0026#34;,fill=Group))+geom_tile()+ coord_flip() + theme_tree2() + theme(legend.position=\u0026#39;none\u0026#39;) ap2=ggplot(anno,aes(x=node,y=high,fill=Group))+geom_col()+ coord_flip() + theme_tree2() + theme(legend.position=\u0026#39;none\u0026#39;) ap1%\u0026gt;% insert_left(p,width = 4) %\u0026gt;% insert_right(ap2, width=2) ç›®å‰æ„Ÿè§‰æœ€å¥½ç”¨çš„tipæ³¨é‡Šæ–¹æ³•å°±æ˜¯ ggtreeExtraï¼Œæœ‰ç»Ÿä¸€çš„æ³¨é‡Šé€»è¾‘geom_fruit,æŒ‰ç…§å›¾å±‚ä¸€ä¸ªä¸€ä¸ªæ·»åŠ ï¼Œæ¯”è¾ƒæ˜“å­¦å’Œè°ƒèŠ‚ã€‚å…·ä½“èƒ½ç”¨æ¥æ³¨é‡Šçš„å›¾å±‚æœ‰â€™geom_barâ€™, â€˜geom_colâ€™, â€˜geom_boxplotâ€™, â€˜geom_violinâ€™ï¼Œâ€˜ggstarâ€™,â€™ggimageâ€™ç­‰ã€‚\næ¯ä¸€ä¸ªgeomå›¾å±‚å°±åƒä¸€ä¸ªç§¯æœ¨å—ä¸€æ ·ï¼Œæˆ‘ä»¬è¦åšçš„å°±æ˜¯æŒ‘é€‰åˆé€‚çš„ç§¯æœ¨ï¼Œç”¨åŒæ ·çš„æ–¹æ³•æ­ä¸Šå»å³å¯ï¼ˆä¹Ÿæ˜¯æ•´ä¸ªggplotçš„ç»˜å›¾é€»è¾‘ï¼Œä¼˜é›…ï¼‰ï¼Œå¯¹æ¯ä¸ªgeomå›¾å±‚ï¼Œæˆ‘ä»¬åŒæ ·å¯ä»¥ä½¿ç”¨ggplotçš„å„ç§scaleæ–¹æ³•è°ƒèŠ‚é¢œè‰²ã€å¤§å°ã€å½¢çŠ¶ç­‰ã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 p=ggtree(tree,layout = \u0026#34;fan\u0026#34;) #geom_star library(ggstar) p1=p + geom_fruit( data=anno, geom=geom_star, mapping=aes(y=`node`,fill=Type, size=value1, starshape=Group), position=\u0026#34;identity\u0026#34;, starstroke=0.1 )+ #è°ƒèŠ‚starçš„å¤§å°ä»¥åŠå…¶legend scale_size_continuous( range=c(1, 3), # the range of size. guide=guide_legend( keywidth=0.5, keyheight=0.5, override.aes=list(starshape=15), order=2 #legendçš„é¡ºåº ) ) + #è°ƒèŠ‚starçš„é¢œè‰²ä»¥åŠå…¶legend scale_fill_manual( values=c(\u0026#34;#8dd3c7\u0026#34;, \u0026#34;#ffed6f\u0026#34;, \u0026#34;#bebada\u0026#34;), guide=\u0026#34;none\u0026#34; ) + #è°ƒèŠ‚starçš„å½¢çŠ¶ä»¥åŠå…¶legend scale_starshape_manual( values=c(1, 16,15), guide=guide_legend( keywidth=0.5, keyheight=0.5, order=1 ) ) p1 è¦æ³¨æ„çš„æ˜¯ï¼åœ¨æ·»åŠ å¤šä¸ªå›¾å±‚æ—¶ï¼Œæœ‰æ—¶å€™æˆ‘ä»¬è¦ç”¨å¤šæ¬¡çš„fillæˆ–colorå±æ€§ï¼Œä½†æ˜¯ggplotçš„scale_fill_manualä¼šå¯¹å…¨å±€ç”Ÿæ•ˆï¼Œç»“æœå°±ä¼šæ¯”è¾ƒå¥‡æ€ªï¼Œæ‰€ä»¥æˆ‘ä»¬åœ¨å›¾å±‚ä¹‹é—´ä¸€èˆ¬è¦ä½¿ç”¨ggnewscaleåŒ…æ¥äº§ç”Ÿä¸€ä¸ªæ–°çš„scaleï¼Œä¹‹åå°±å¯ä»¥åˆ†åˆ«è°ƒèŠ‚äº†ã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 13 library(ggnewscale) p2=p1 + ggnewscale::new_scale_fill() + geom_fruit( data=anno, geom=geom_tile, mapping=aes(y=node, fill=value1), offset=0.08, # è°ƒèŠ‚ pwidth=0.25 # width of the external layer, default is 0.2 times of x range of tree. ) + scale_fill_gradient(low = \u0026#34;white\u0026#34;,high = \u0026#34;red\u0026#34;) p2 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 p2+ ggnewscale::new_scale_fill() + geom_fruit( data=anno, geom=geom_col, mapping=aes(y=node, x=high, fill=Type), pwidth=0.4,offset = 0.1, axis.params=list( axis=\u0026#34;x\u0026#34;, # æ·»åŠ xè½´æ–‡å­— text.size=2, #æ–‡å­—å¤§å° text.angle=-45, # è§’åº¦ hjust=0 # è°ƒèŠ‚ ), grid.params=list() # æ·»åŠ ç½‘æ ¼çº¿ ) + scale_fill_manual( values=c(\u0026#34;#a6bce3\u0026#34;, \u0026#34;#fb9a99\u0026#34;, \u0026#34;#fdbf6f\u0026#34;), guide=guide_legend(keywidth=0.5, keyheight=0.5, order=6) ) å½“ç„¶è¿˜å¯ä»¥åŠ ä¸€äº›æœ‰è¶£çš„æ¯”å¦‚ imageæ³¨é‡Š ã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 library(ggimage) library(ggtree) nwk \u0026lt;- paste0(\u0026#34;((((bufonidae, dendrobatidae), ceratophryidae),\u0026#34;, \u0026#34;(centrolenidae, leptodactylidae)), hylidae);\u0026#34;) imgdir \u0026lt;- system.file(\u0026#34;extdata/frogs\u0026#34;, package = \u0026#34;TDbook\u0026#34;) x = read.tree(text = nwk) ggtree(x)+geom_tiplab()+ geom_fruit( data = data.frame(node=x$tip.label,image=paste0(imgdir, \u0026#39;/\u0026#39;, x$tip.label, \u0026#39;.jpg\u0026#39;)), geom = geom_image, mapping = aes(y=node,image=image), offset=0.5, align=2, size=.2 ) ç”Ÿç‰©å‰ªå½±ï¼ŒPhylopic åŒ…å« 3200 å¤šä¸ªç”Ÿç‰©å‰ªå½±ï¼Œæ¶µç›–å¾ˆå¤šé—¨ç±»ã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 13 newick \u0026lt;- paste0(\u0026#34;((Pongo_abelii,(Gorilla_gorilla_gorilla,(Pan_paniscus,\u0026#34;, \u0026#34;Pan_troglodytes)Pan,Homo_sapiens)Homininae)Hominidae,\u0026#34;, \u0026#34;Nomascus_leucogenys)Hominoidea;\u0026#34;) tree \u0026lt;- read.tree(text=newick) #é€šè¿‡phylopic_uidæŸ¥è¯¢å‰ªå½± d \u0026lt;- ggimage::phylopic_uid(tree$tip.label) d$body_mass \u0026lt;- c(52, 114, 47, 45, 58, 6) p \u0026lt;- ggtree(tree) %\u0026lt;+% d + geom_tiplab(aes(image=uid, colour=body_mass), geom=\u0026#34;phylopic\u0026#34;, offset=2.5) + geom_tiplab(aes(label=label), offset = .2) + xlim(NA, 7) + scale_color_viridis_c() internal annotation è¿™ç±»æ³¨é‡Šæ–¹æ³•ä½¿ç”¨åŸºæœ¬æ˜¯å†…éƒ¨çš„nodeå·æˆ–labelï¼ŒåŠ ä¸Šé¢å¤–çš„æ³¨é‡Šæ•°æ®ï¼ˆåˆ†ç±»æ•°æ®/è¿ç»­æ•°å€¼æ•°æ®ï¼‰\nå¯é€‰çš„å¯¹è±¡æœ‰cladelabï¼Œstripï¼Œhighlightï¼Œtaxa_linkâ€¦ ä¹Ÿèƒ½ç›´æ¥ç»™ä¸€éƒ¨åˆ†æ ‘æä¸Šè‰²ã€‚\n1 2 3 4 5 6 7 8 9 internal_anno=data.frame(node=c(53,68,79),name=paste0(\u0026#34;clade\u0026#34;,1:3),angle1=c(0,90,0)) tree2 \u0026lt;- groupClade(tree, setNames(internal_anno$node,internal_anno$name),group_name = \u0026#34;test\u0026#34;) (col_p=ggtree(tree2, aes(color=test))+ scale_color_manual(values=c(\u0026#34;black\u0026#34;, \u0026#34;red3\u0026#34;, \u0026#34;skyblue\u0026#34;,\u0026#34;yellow3\u0026#34;)) + #theme(legend.position=\u0026#39;none\u0026#39;)+ guides(color=guide_legend(override.aes = list(linewidth=3))) ) 1 2 3 #æ·»åŠ pointæ³¨é‡Š ggtree(tree2, layout=\u0026#34;fan\u0026#34;) + geom_point2(mapping = aes(subset=c(test!=0),color=test)) 1 2 ggtree(tree, layout=\u0026#34;fan\u0026#34;) + geom_cladelab(data = internal_anno,mapping = aes(node=node,label=name,color=name,angle=angle1)) 1 2 3 4 5 6 #stripç±»ä¼¼cladelabï¼Œä¸è¿‡æä¾›çš„æ˜¯ä¸¤ä¸ªtipï¼Œå¯ä»¥æ¨ªè·¨ä¸åŒä½ç½®çš„ææ¡,ä¸æ¥å—mapping ggtree(tree, layout=\u0026#34;fan\u0026#34;) + geom_tiplab() + geom_strip(\u0026#39;t10\u0026#39;, \u0026#39;t33\u0026#39;, barsize=2, color=\u0026#39;red\u0026#39;, label=\u0026#34;group1\u0026#34;, offset.text=.1) + geom_strip(\u0026#39;t12\u0026#39;, \u0026#39;t21\u0026#39;, barsize=2, color=\u0026#39;blue\u0026#39;, label = \u0026#34;group2\u0026#34;, offset.text=.1) 1 2 3 #highlight ggtree(tree, layout=\u0026#34;fan\u0026#34;) + geom_highlight(data = internal_anno,mapping = aes(node=node,label=name,fill=name)) 1 2 3 4 #balanceç±»ä¼¼highlightï¼Œä¸è¿‡å¯ä»¥æä¾›ä¸¤ä¸ªæœ‰åŒ…å«å…³ç³»çš„clade,ä¸æ¥å—mapping ggtree(tree) + geom_balance(node=55, fill=\u0026#39;steelblue\u0026#39;, alpha=0.6, extend=1) + geom_balance(node=56, fill=\u0026#39;darkgreen\u0026#39;, alpha=0.6, extend=1) 1 2 3 4 5 6 7 8 9 10 11 12 links \u0026lt;-data.frame(from=c(\u0026#34;t36\u0026#34;,\u0026#34;t7\u0026#34;,\u0026#34;t23\u0026#34;), to=c(\u0026#34;t6\u0026#34;, \u0026#34;t46\u0026#34;, \u0026#34;t29\u0026#34;), type=c(\u0026#34;l1\u0026#34;, \u0026#34;l2\u0026#34;, \u0026#34;l3\u0026#34;), s=c(2, 1, 2)) ggtree(tree, layout=\u0026#34;inward_circular\u0026#34;, xlim=c(30, 0)) + geom_taxalink(data=links, mapping=aes(taxa1=from, taxa2=to, color=type, size=s)) + geom_tiplab(hjust=1) + scale_size_continuous(range=c(1,3)) å¦å¤–ä¸€äº›æ˜¯é€šè¿‡å†…éƒ¨èŠ‚ç‚¹æ”¹å˜æ•´ä¸ªæ ‘åˆ†å¸ƒçš„æ–¹æ³•ï¼š\n1 2 #é€šè¿‡scaleCladeè°ƒèŠ‚æŸä¸ªcladeå æ¯” scaleClade(col_p, node=53, scale=.1) 1 2 #é€šè¿‡collapesæŠ˜å æŸä¸ªclade collapse(col_p, node=53,mode = c(\u0026#34;mix\u0026#34;,\u0026#34;max\u0026#34;,\u0026#34;min\u0026#34;,\u0026#34;none\u0026#34;)[1],fill=\u0026#34;red3\u0026#34;,alpha=0.4) 1 2 #é€šè¿‡rotateæ—‹è½¬ä¸¤ä¸ªclade ggtree::rotate(col_p,node = 52)+geom_nodelab(aes(subset=c(node==52),label=node)) 1 2 #é€šè¿‡flipäº¤æ¢ä¸¤ä¸ªclade ggtree::flip(col_p,53,68)+geom_nodelab(aes(label=node)) 1 2 #é€šè¿‡open_treeå’Œrotate_treeè°ƒèŠ‚è§’åº¦ open_tree(col_p, 180)%\u0026gt;%rotate_tree(90) æŒæ¡ä»¥ä¸Šè¿™äº›æ–¹æ³•ï¼ŒåŸºæœ¬ä¸Šå¯ä»¥ç»˜åˆ¶å‡ºç”¨åœ¨æ–‡ç« çš„æ ‘äº†ï¼ˆå½“ç„¶ä¸€å®šè¦è‡ªå·±å¥½å¥½æ‰¾é…è‰²ï¼Œè°ƒæ•´ç»†èŠ‚ï¼ï¼ï¼ï¼‰\nä¸‹æ¬¡è¿›é˜¶ï¼\nReference 1. G. Yu, D. K. Smith, H. Zhu, Y. Guan, T. T.-Y. Lam, Ggtree: An r package for visualization and annotation of phylogenetic trees with their covariates and other associated data. Methods in Ecology and Evolution. 8, 28â€“36 (2017).\n2. S. Xu, Z. Dai, P. Guo, X. Fu, S. Liu, L. Zhou, W. Tang, T. Feng, M. Chen, L. Zhan, T. Wu, E. Hu, Y. Jiang, X. Bo, G. Yu, ggtreeExtra: Compact Visualization of Richly Annotated Phylogenetic Data. Molecular Biology and Evolution. 38, 4039â€“4042 (2021).\n","date":"2023-04-14T00:00:00Z","image":"/p/r-tree/index.cn_files/figure-html/unnamed-chunk-15-1_hu64a041d9665808fa476c64c6e2c5c164_245537_120x120_fill_box_smart1_3.png","permalink":"/p/r-tree/","title":"Rç»˜åˆ¶ä¼˜ç¾çš„è¿›åŒ–æ ‘ï¼ˆåŸºç¡€ï¼‰"},{"content":"ã€æµ™æ±Ÿå¤§å­¦ç”Ÿå‘½ç§‘å­¦ç ”ç©¶é™¢è’‹è¶…å®éªŒå®¤ã€‘å®éªŒæŠ€æœ¯å‘˜æ‹›è˜ç«çƒ­è¿›è¡Œä¸­ï¼ğŸ”¥\nğŸŒŸæµ™æ±Ÿå¤§å­¦ç”Ÿå‘½ç§‘å­¦ç ”ç©¶é™¢è’‹è¶…å®éªŒå®¤è¯šé‚€å®éªŒæŠ€æœ¯å‘˜ 1-2 ååŠ ç›Ÿï¼æˆ‘ä»¬é‚€è¯·æ‚¨åŠ å…¥æˆ‘ä»¬çš„è¯¾é¢˜ç»„ï¼Œå‚ä¸å…¨çƒå¤§å‹æš´éœ²ç»„ç ”ç©¶é¡¹ç›®ï¼Œè´Ÿè´£ DNA æå–å’ŒäºŒä»£æµ‹åºçš„æ–‡åº“æ„å»ºå·¥ä½œã€‚ä¼°è®¡é¡¹ç›®å‘¨æœŸçº¦ä¸º4ä¸ªæœˆ(å¸¦è–ªæ°´)ï¼Œå±Šæ—¶æ‚¨å°†æœ‰æœºä¼šæ·±å…¥ç³»ç»Ÿåœ°å­¦ä¹ ç”Ÿç‰©ä¿¡æ¯å­¦ï¼Œç”šè‡³æœ‰æœºä¼šä½œä¸ºå…±åŒä½œè€…åœ¨é¡¶çº§æœŸåˆŠå‘è¡¨æ–‡ç« ï¼\nğŸ”¬æˆ‘ä»¬æ¬¢è¿å…·æœ‰åˆ†å­å®éªŒåŸºç¡€çš„åŒå­¦ï¼ˆå¤§ä¸‰æˆ–å³å°†ç¡•å£«æ¯•ä¸šï¼‰åŠ å…¥æˆ‘ä»¬çš„é˜Ÿä¼ï¼\nğŸ”—å®éªŒå®¤ç½‘ç«™ï¼šhttp://lsi.zju.edu.cn/jianglab_exposome/list.htm\nğŸ‘¨ğŸ»â€ğŸ“å¯¼å¸ˆç®€ä»‹ï¼š\nè’‹è¶…åšå£«ç°ä»»æµ™æ±Ÿå¤§å­¦ç”Ÿå‘½ç§‘å­¦ç ”ç©¶é™¢ç ”ç©¶å‘˜ï¼Œå…¼è˜æµ™æ±Ÿå¤§å­¦é™„å±ç¬¬ä¸€åŒ»é™¢ï¼Œè·å¾—å›½å®¶çº§é’å¹´äººæ‰é¡¹ç›®ã€‚æœ¬ç§‘æ¯•ä¸šäºå¦é—¨å¤§å­¦ç”Ÿå‘½ç§‘å­¦å­¦é™¢ã€‚åšå£«å¸ˆä»ç¾å›½å°ç¬¬å®‰çº³å¤§å­¦çš„ Yves Brun æ•™æˆï¼Œä»äº‹åˆ†å­è¿›åŒ–å±‚é¢è§£æç»†èŒå½¢æ€è¿›åŒ–çš„æœºåˆ¶çš„ç ”ç©¶ï¼Œäº 2014 å¹´å–å¾—åšå£«å­¦ä½ã€‚ååŠ å…¥ç¾å›½æ–¯å¦ç¦å¤§å­¦åŒ»å­¦é™¢é—ä¼ ç³»ç²¾å‡†åŒ»ç–—ä¸­å¿ƒ Mike Snyder æ•™æˆç»„è¿›è¡Œåšå£«åç ”ç©¶ã€‚Mike Snyder æ•™æˆæ˜¯å›½é™…è‘—åçš„ç²¾å‡†åŒ–åŒ»ç–—å’Œå¤šç»„å­¦ç ”ç©¶çš„å…ˆé©±ã€‚åšå£«åæœŸé—´ï¼Œé¦–æ¬¡å…¨é¢è§£è¯»äººç±»å¥åº·ç ”ç©¶ä¸­æœªçŸ¥çš„é‡è¦ç»„æˆéƒ¨åˆ†-ä¸ªäººç¯å¢ƒæš´éœ²ç»„ã€‚\näº 2019 å›å›½åä¸»è¦ç ”ç©¶å›´ç»•ç¯å¢ƒæš´éœ²ç»„ã€å¾®ç”Ÿç‰©ç»„ã€ç²¾å‡†åŒ»å­¦å¼€å±•ï¼Œå…·ä½“æ–¹å‘ä¸ºï¼šç¯å¢ƒæš´éœ²ç»„åœ¨å®è§‚åŠä¸ªä½“æ°´å¹³ä¸Šçš„ç²¾å‡†æ—¶ç©ºåŠ¨æ€æµ‹é‡ï¼›ç¯å¢ƒæš´éœ²ç»„ä¸äººç±»ç–¾ç—…å¥åº·çš„å…³ç³»ï¼›å¾®é‡äººã€ç¯å¢ƒå¾®ç”Ÿç‰©ç»„ç²¾å‡†æ—¶ç©ºåŠ¨æ€æµ‹é‡åŠå…¶ä¸äººç±»ç–¾ç—…å¥åº·å’Œç¯å¢ƒå¥åº·çš„å…³ç³»ï¼›ç¯å¢ƒæš´éœ²ç»„ã€å¾®ç”Ÿç‰©ç»„ä»¥åŠç›¸å…³ç»„å­¦çš„åˆ†å­å®éªŒæŠ€æœ¯å’Œè®¡ç®—ç»Ÿè®¡æ–¹æ³•çš„å¼€å‘ï¼›ä¸ªä½“ç¯å¢ƒæš´éœ²ç»„å¯ç©¿æˆ´ç›‘æµ‹è®¾å¤‡çš„å¼€å‘å’Œè¿ç”¨ï¼›å¾®ç”Ÿç‰©è¿›åŒ–ï¼›å¾®ç”Ÿç‰©ç»„åŠŸèƒ½åŸä»¶å¤§è§„æ¨¡æŒ–æ˜ï¼›å¤šç»„å­¦å’Œæœºå™¨å­¦ä¹ åœ¨å¾®ç”Ÿç‰©ç»„åŠç²¾å‡†åŒ»å­¦çš„åº”ç”¨ç­‰ã€‚\nä»¥ç¬¬ä¸€ä½œè€…å’Œ/æˆ–é€šè®¯ä½œè€…ï¼ˆå«å…±åŒï¼‰åœ¨å›½é™…çŸ¥åæœŸåˆŠ Cellã€Natureã€Nature Protocolsã€Cell Discoveryç­‰æ‚å¿—å‘è¡¨å¤šç¯‡ç ”ç©¶è®ºæ–‡ã€‚ä»¥å…±åŒä½œè€…åœ¨Nature Biotechnologyã€Circulation Researchã€Genome Researchç­‰æ‚å¿—åˆŠæ–‡ã€‚è¿‘æœŸä»¥é€šè®¯ä½œè€…åœ¨ Science ä¸Šå‘è¡¨å¯¹æ–°å† ç—…æ¯’èµ·æºæ—¶é—´æ¨¡å‹åˆ†æçš„ eLetter è¯„è®ºã€‚å·²å–å¾—ç¾å›½ç©ºæ°”æš´éœ²ç»„ç›‘æµ‹è®¾å¤‡ç›¸å…³ä¸“åˆ©ï¼Œç”³è¯·å›½å†…ç›¸å…³ä¸“åˆ©è‹¥å¹²ã€‚\nå®éªŒå®¤ç ”ç©¶æ–¹å‘ ğŸ’¼èŒä½è¦æ±‚ï¼š\n1.å…·å¤‡æ‰å®çš„åˆ†å­å®éªŒåŸºç¡€ï¼Œæœ€å¥½ç†Ÿç»ƒæŒæ¡ DNA æˆ– RNA æå–ï¼Œè§å…‰å®šé‡ PCR æˆ–æ™®é€š RCRï¼›\n2.å…·å¤‡è¾ƒå¼ºçš„å­¦ä¹ èƒ½åŠ›ã€æ‰§è¡ŒåŠ›ï¼Œä»¥åŠå‡ºè‰²çš„å›¢é˜Ÿåˆä½œæ„è¯†å’Œæ²Ÿé€šèƒ½åŠ›ï¼›\n3.æ¯å‘¨å·¥ä½œè‡³å°‘ 4 å¤©ï¼Œå‘¨ä¸€åˆ°å‘¨æ—¥ï¼Œå¯æ ¹æ®æ‚¨çš„æ—¶é—´å®‰æ’ã€‚å¤§ä¸‰å’Œå³å°†ç¡•å£«æ¯•ä¸šåŒå­¦çš†å¯ï¼›\n4.å®éªŒå…¨ç¨‹å°†åœ¨åšå£«åçš„å¸¦é¢†å’ŒæŒ‡å¯¼ä¸‹è¿›è¡Œï¼›\n5.æä¾›ä»å…¥é—¨åˆ°ç²¾é€šçš„ç”Ÿä¿¡å­¦ä¹ æœºä¼šï¼ŒåŒ…æ‹¬æ‰‹æŠŠæ‰‹æ•™æˆå¤§æ•°æ®åˆ†æå’Œé«˜çº§å¯è§†åŒ–æŠ€å·§ã€‚PI å°†æä¾›ä»ç§‘ç ”åˆ›æ–°æ€ç»´åˆ°é¡¹ç›®è½å®çš„å…¨æ–¹ä½\u0026quot;åšå£«\u0026quot;çº§åˆ«åŸ¹å…»å’ŒæŒ‡å¯¼ã€‚\nğŸ’°å¾…é‡ï¼š è–ªé…¬å¾…é‡ä¸ºæ¯ä¸ªæœˆ5000å…ƒã€‚å®éªŒå®¤æä¾›ä¸“ä¸šçš„ç§‘ç ”æŒ‡å¯¼å’Œä¸€æµçš„ç§‘ç ”ç¯å¢ƒã€‚ç¡•å£«æ¯•ä¸šç”Ÿå¾…é¡¹ç›®ç»“æŸåå¯ä»¥è€ƒè™‘ç»­è˜ä¸ºå…¨èŒæŠ€æœ¯å‘˜ã€‚\nğŸ“§ç”³è¯·æ–¹å¼ï¼š æœ‰æ„å‘çš„å€™é€‰äººï¼Œè¯·å‘é€ä¸ªäººç®€å†åŠç›¸å…³èµ„æ–™ï¼ˆåŒ…æ‹¬å­¦ä¹ ã€å·¥ä½œå’Œç ”ç©¶ç»å†ï¼Œä»¥åŠå…¶ä»–è¯æ˜ä¸ªäººèƒ½åŠ›ã€æ°´å¹³çš„ç›¸å…³èµ„æ–™ï¼‰è‡³ qiong_chen@zju.edu.cnï¼Œå¹¶æ³¨æ˜\u0026quot;å§“å+åº”è˜æŠ€æœ¯å‘˜\u0026quot;ã€‚ç»è€ƒæ ¸åï¼Œæˆ‘ä»¬å°†æ‹©ä¼˜å½•å–ã€‚\nğŸ“…æ‹›è˜æ—¶é—´ï¼š 2023å¹´4æœˆ10æ—¥è‡³4æœˆ30æ—¥\nğŸ¢å®éªŒåœ°å€ï¼š æµ™å¤§ç´«é‡‘æ¸¯ç”Ÿç§‘é™¢338\nâŒšï¸é¡¹ç›®è®¡åˆ’å¼€å±•æ—¶é—´ï¼š çº¦2023å¹´4æœˆ30æ—¥è‡³2023å¹´8æœˆ30æ—¥ï¼Œå¤§æ¦‚ç‡ä¼šæå‰å®Œæˆå®éªŒå·¥ä½œã€‚è‹¥è¯¥é˜¶æ®µå®éªŒæœªå®Œæˆï¼Œå¯é…Œæƒ…ç»­çº¦ä¸å¦ã€‚\nèµ°è¿‡è·¯è¿‡ä¸è¦é”™è¿‡ï¼Œè¯·æŠ“ä½è¿™æ¬¡éš¾å¾—çš„æœºä¼šï¼ŒåŠ å…¥æˆ‘ä»¬è¿™ä¸ªå……æ»¡æ´»åŠ›å’Œåˆ›æ–°çš„å›¢é˜Ÿï¼Œå¼€å¯ä¸€æ®µå¯Œæœ‰æŒ‘æˆ˜å’Œæ”¶è·çš„ç§‘ç ”ä¹‹æ—…ï¼æœŸå¾…æ‚¨çš„åŠ å…¥ï¼\n","date":"2023-04-10T00:00:00Z","image":"/p/werving-of-jiang-lab/images/research%20field_hu4f5e226684f5961809532c452b77bd89_122405_120x120_fill_box_smart1_3.png","permalink":"/p/werving-of-jiang-lab/","title":"è’‹è¶…å®éªŒå®¤é¡¹ç›®æŠ€æœ¯å‘˜æ‹›è˜"},{"content":"Introduction åœ¨ R è¯­è¨€ä¸­ï¼Œæœ‰å¤šä¸ªè½¯ä»¶åŒ…å¯ä»¥ç”¨æ¥ç»˜åˆ¶åœ°å›¾ï¼Œå…¶ä¸­æœ€æµè¡Œçš„æ˜¯ ggplot2ã€spã€maptools å’Œ leafletã€‚\nsimple examples ä»¥ä¸‹æ˜¯ä¸€äº›ç®€å•çš„ç¤ºä¾‹ï¼š\nä½¿ç”¨ ggplot2 åŒ…ç»˜åˆ¶ä¸–ç•Œåœ°å›¾ï¼š 1 2 3 4 5 6 7 library(ggplot2) library(maps) world_map \u0026lt;- map_data(\u0026#34;world\u0026#34;) ggplot(world_map, aes(x = long, y = lat, group = group)) + geom_polygon(fill = \u0026#34;lightblue\u0026#34;, color = \u0026#34;white\u0026#34;) ä½¿ç”¨ sp åŒ…å’Œ maptools åŒ…ç»˜åˆ¶ç¾å›½å·ç•Œåœ°å›¾ï¼š 1 2 3 4 5 6 7 8 library(sp) library(maptools) #sids.shpæ˜¯ä¸€ä¸ªå†…ç½®çš„æ•°æ®ï¼Œåé¢ä¼šè®²åˆ° us_states \u0026lt;- readShapePoly(system.file(\u0026#34;shapes/sids.shp\u0026#34;, package=\u0026#34;maptools\u0026#34;)[1], proj4string=CRS(\u0026#34;+proj=longlat +datum=WGS84\u0026#34;)) plot(us_states) ä½¿ç”¨ leaflet åŒ…ç»˜åˆ¶äº¤äº’å¼åœ°å›¾ï¼š 1 2 3 4 5 library(leaflet) leaflet() %\u0026gt;% addTiles() %\u0026gt;% addMarkers(lng=-74.5, lat=40, popup=\u0026#34;New York City\u0026#34;) å¦‚æœéœ€è¦æ›´é«˜çº§çš„åœ°å›¾å¯è§†åŒ–ï¼Œå°±éœ€è¦ä¸€äº›åœ°å›¾ç›¸å…³çŸ¥ã€‚ä¾‹å¦‚åœ¨åœ°å›¾ä¸Šæ·»åŠ æ ‡æ³¨æˆ–è¿›è¡Œäº¤äº’å¼å¯è§†åŒ–ï¼Œä¹Ÿæ˜¯æˆ‘ä»¬æ¥ä¸‹æ¥è¦è®¨è®ºçš„åœ°æ–¹ã€‚\nFormat é¦–å…ˆï¼Œåœ¨åœ°å›¾ç»˜åˆ¶ä¸­ï¼Œå¸¸ç”¨çš„æ•°æ®æ ¼å¼åŒ…æ‹¬ï¼š\n.shp æ–‡ä»¶ï¼šåœ°ç†ä¿¡æ¯ç³»ç»Ÿ (GIS) ä¸­çš„ä¸€ç§æ•°æ®æ ¼å¼ï¼Œé€šå¸¸ç”¨äºå­˜å‚¨åœ°ç†çŸ¢é‡æ•°æ®ï¼Œä¾‹å¦‚ç‚¹ã€çº¿ã€é¢ã€å¤šè¾¹å½¢ç­‰åœ°ç†ç‰¹å¾çš„åæ ‡å’Œå±æ€§ä¿¡æ¯ã€‚\n.kml æ–‡ä»¶ï¼šGoogle åœ°å›¾ä½¿ç”¨çš„ä¸€ç§æ•°æ®æ ¼å¼ï¼Œé€šå¸¸ç”¨äºå­˜å‚¨åœ°ç†çŸ¢é‡æ•°æ®å’Œæ ‡è®°ï¼Œä¾‹å¦‚ç‚¹ã€çº¿ã€é¢ã€å›¾æ ‡ç­‰åœ°ç†ç‰¹å¾çš„åæ ‡ã€å±æ€§ä¿¡æ¯å’Œæ ·å¼ä¿¡æ¯ã€‚\n.kmz æ–‡ä»¶ï¼šGoogle åœ°å›¾ä½¿ç”¨çš„ä¸€ç§æ•°æ®æ ¼å¼ï¼Œé€šå¸¸æ˜¯ .kml æ–‡ä»¶çš„å‹ç¼©ç‰ˆæœ¬ï¼Œå¯ä»¥æ–¹ä¾¿åœ°å…±äº«å’Œä¼ è¾“ã€‚\n.gpx æ–‡ä»¶ï¼šä¸€ç§å¸¸è§çš„ GPS æ•°æ®æ ¼å¼ï¼Œé€šå¸¸ç”¨äºå­˜å‚¨è·¯å¾„ã€è½¨è¿¹ç­‰ GPS æ•°æ®ã€‚\n.json æ–‡ä»¶ï¼šä¸€ç§å¸¸è§çš„æ•°æ®äº¤æ¢æ ¼å¼ï¼Œå¯ä»¥å­˜å‚¨å„ç§ç»“æ„åŒ–æ•°æ®ï¼ŒåŒ…æ‹¬åœ°ç†çŸ¢é‡æ•°æ®ã€å±æ€§ä¿¡æ¯ç­‰ã€‚\n.csv æ–‡ä»¶ï¼šä¸€ç§å¸¸è§çš„æ•°æ®æ ¼å¼ï¼Œå¯ä»¥å­˜å‚¨è¡¨æ ¼æ•°æ®ï¼Œä¾‹å¦‚ç»çº¬åº¦ã€åç§°ã€æè¿°ç­‰åœ°ç†ä¿¡æ¯ã€‚\né™¤äº†ä»¥ä¸Šåˆ—ä¸¾çš„æ ¼å¼ä¹‹å¤–ï¼Œè¿˜æœ‰å…¶ä»–ä¸€äº›æ ¼å¼ï¼Œä¾‹å¦‚ .gmlã€.svgã€.dxf ç­‰ï¼Œè¿™äº›æ ¼å¼é€šå¸¸åœ¨ä¸åŒçš„ GIS è½¯ä»¶å’Œåœ°å›¾ç»˜åˆ¶å·¥å…·ä¹‹é—´è¿›è¡Œæ•°æ®äº¤æ¢å’Œå…±äº«ã€‚éœ€è¦æ ¹æ®å…·ä½“éœ€æ±‚å’Œä½¿ç”¨å·¥å…·é€‰æ‹©åˆé€‚çš„æ•°æ®æ ¼å¼ã€‚\nR å¯ä»¥å¤„ç†ä¸Šè¿°åˆ—ä¸¾çš„åœ°å›¾ç›¸å…³çš„æ–‡ä»¶æ ¼å¼ã€‚\nå¯¹äº .shp æ–‡ä»¶ï¼ŒRä¸­çš„ rgdalã€spã€sf ç­‰è½¯ä»¶åŒ…å¯ä»¥è¯»å–å’Œæ“ä½œè¯¥æ–‡ä»¶æ ¼å¼ï¼Œå¯ä»¥è¿›è¡Œåœ°å›¾ç»˜åˆ¶ã€åˆ†æå’Œå¤„ç†ç­‰ä»»åŠ¡ã€‚\nå¯¹äº .kml å’Œ .kmz æ–‡ä»¶ï¼ŒRä¸­çš„ plotKML è½¯ä»¶åŒ…å¯ä»¥è¯»å–å’Œæ“ä½œè¯¥æ–‡ä»¶æ ¼å¼ï¼Œå¯ä»¥è¿›è¡Œåœ°å›¾ç»˜åˆ¶å’Œåˆ†æç­‰ä»»åŠ¡ã€‚\nå¯¹äº .gpx æ–‡ä»¶ï¼ŒRä¸­çš„ maptoolsã€ggmap ç­‰è½¯ä»¶åŒ…å¯ä»¥è¯»å–å’Œæ“ä½œè¯¥æ–‡ä»¶æ ¼å¼ï¼Œå¯ä»¥è¿›è¡Œè·¯å¾„å’Œè½¨è¿¹å¯è§†åŒ–ç­‰ä»»åŠ¡ã€‚\nå¯¹äº .json å’Œ .csv æ–‡ä»¶ï¼ŒRå†…ç½®çš„å‡½æ•°å’Œå¤–éƒ¨è½¯ä»¶åŒ…éƒ½å¯ä»¥è¯»å–å’Œæ“ä½œè¯¥æ–‡ä»¶æ ¼å¼ï¼Œå¯ä»¥è¿›è¡Œåœ°å›¾æ•°æ®çš„è½¬æ¢ã€å¤„ç†å’Œå¯è§†åŒ–ç­‰ä»»åŠ¡ã€‚\næ€»çš„æ¥è¯´ï¼ŒR ä¸­æœ‰è®¸å¤šå†…ç½®å‡½æ•°å’Œè½¯ä»¶åŒ…å¯ä»¥è¯»å–ã€æ“ä½œå’Œå¯è§†åŒ–åœ°å›¾ç›¸å…³çš„æ•°æ®æ ¼å¼ï¼Œå¯ä»¥å¸®åŠ©æˆ‘ä»¬è¿›è¡Œåœ°å›¾åˆ¶ä½œã€æ•°æ®åˆ†æå’Œå¯è§†åŒ–ç­‰ä»»åŠ¡ã€‚\nCRS åæ ‡å‚è€ƒç³»ç»Ÿï¼ˆCoordinate Reference Systemï¼ŒCRSï¼‰æ˜¯ä¸€ä¸ªåŸºäºåœ°çƒè¡¨é¢å½¢çŠ¶å’Œå¤§å°çš„åæ ‡ç³»ç»Ÿã€‚å®ƒæ˜¯é€šè¿‡ç»åº¦å’Œçº¬åº¦æ¥æè¿°åœ°çƒè¡¨é¢ä¸Šçš„ç‚¹å’ŒåŒºåŸŸçš„ã€‚\nåœ¨åœ°ç†åæ ‡ç³»ä¸­ï¼Œç»åº¦æ˜¯æŒ‡åœ°çƒè¡¨é¢ä¸ŠæŸç‚¹æ‰€åœ¨çš„ç»çº¿å’Œåœ°çƒæœ¬åˆå­åˆçº¿ï¼ˆå³0åº¦ç»çº¿ï¼‰ä¹‹é—´çš„å¤¹è§’ï¼Œä»¥ä¸œç»ä¸ºæ­£ï¼Œä»¥è¥¿ç»ä¸ºè´Ÿã€‚çº¬åº¦æ˜¯æŒ‡åœ°çƒè¡¨é¢ä¸ŠæŸç‚¹æ‰€åœ¨çš„çº¬çº¿å’Œèµ¤é“ä¹‹é—´çš„å¤¹è§’ï¼Œä»¥åŒ—çº¬ä¸ºæ­£ï¼Œä»¥å—çº¬ä¸ºè´Ÿã€‚\nWGS84åæ ‡ç³»ç»Ÿæ˜¯å…¨çƒå®šä½ç³»ç»Ÿï¼ˆGPSï¼‰ä½¿ç”¨çš„ä¸€ç§åœ°ç†åæ ‡ç³»ç»Ÿã€‚WGS84æ˜¯\u0026quot;World Geodetic System 1984\u0026quot;çš„ç¼©å†™ï¼Œæ˜¯ç”±ç¾å›½å›½é˜²éƒ¨å’Œç¾å›½å›½å®¶åœ°çƒç©ºé—´æƒ…æŠ¥å±€å…±åŒç ”åˆ¶çš„ã€‚WGS84åæ ‡ç³»ç»Ÿä½¿ç”¨ç»åº¦å’Œçº¬åº¦æ¥æè¿°åœ°çƒè¡¨é¢ä¸Šçš„ç‚¹å’ŒåŒºåŸŸã€‚å®ƒä½¿ç”¨çš„æ˜¯å¤§åœ°åŸºå‡†é¢ï¼Œä¸ä¼ ç»Ÿçš„æ¤­çƒä½“æ¨¡å‹æœ‰æ‰€ä¸åŒã€‚WGS84åæ ‡ç³»ç»Ÿçš„é›¶ç‚¹å®šä¹‰ä¸ºé€šè¿‡è‹±å›½æ ¼æ—å°¼æ²»å¤©æ–‡å°çš„ç»çº¿ï¼ˆ0åº¦ç»çº¿ï¼‰ï¼Œä¹Ÿç§°ä¸ºæœ¬åˆå­åˆçº¿ã€‚Rçš„sfè¯†åˆ«\u0026quot;EPSG:4326\u0026quot; or \u0026ldquo;WGS84\u0026rdquo; éƒ½æ˜¯è¯¥åæ ‡ç³»ã€‚\nåœ¨Ré‡Œé¢æˆ‘ä»¬å¯ä»¥å®šä¹‰è‡ªå·±ç»˜å›¾éœ€è¦çš„åæ ‡ç³»ï¼Œå¦‚\u0026quot;+proj=laea +lat_0=40 +lon_0=104\u0026quot; ï¼Œå®ƒè¡¨ç¤ºä¸€ä¸ªå±€éƒ¨ç­‰é¢ç§¯æŠ•å½±ï¼ˆLAEAï¼‰åæ ‡ç³»ï¼Œä¸­å¿ƒçº¬åº¦ä¸º40åº¦ï¼Œä¸­å¿ƒç»åº¦ä¸º104åº¦ï¼ˆåé¢ä¼šç”¨åˆ°ï¼‰ã€‚\nå¦‚æœæƒ³å°†ä¸€ä¸ªåœ°ç†åæ ‡ç³»ï¼ˆæ¯”å¦‚ç»åº¦-çº¬åº¦åæ ‡ç³»ï¼‰ä¸­çš„ç‚¹è½¬æ¢ä¸ºè¿™ä¸ªæŠ•å½±åæ ‡ç³»ä¸­çš„ç‚¹ï¼Œå¯ä»¥ä½¿ç”¨Rä¸­çš„proj4åº“æ¥è¿›è¡Œè½¬æ¢ã€‚ä¸‹é¢æ˜¯ä¸€ä¸ªç®€å•çš„Rä»£ç ç¤ºä¾‹ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 library(proj4) # å®šä¹‰æºåæ ‡ç³»ï¼ˆç»åº¦-çº¬åº¦åæ ‡ç³»ï¼‰ src_crs \u0026lt;- \u0026#34;+proj=longlat +datum=WGS84\u0026#34; # å®šä¹‰ç›®æ ‡åæ ‡ç³»ï¼ˆå±€éƒ¨ç­‰é¢ç§¯æŠ•å½±åæ ‡ç³»ï¼‰ dst_crs \u0026lt;- \u0026#34;+proj=laea +lat_0=40 +lon_0=104\u0026#34; # å®šä¹‰å¾…è½¬æ¢çš„ç‚¹ï¼ˆç»åº¦ã€çº¬åº¦ï¼‰ lon \u0026lt;- 116.4074 lat \u0026lt;- 39.9042 # è½¬æ¢åæ ‡ç³» p \u0026lt;- project(cbind(lon, lat), dst_crs) # è¾“å‡ºè½¬æ¢åçš„åæ ‡ï¼ˆxã€yï¼‰ print(p) # æˆ–è€…ä½¿ç”¨sfè½¬æ¢ source_df=st_as_sf(data.frame(lon, lat),coords = c(\u0026#34;lon\u0026#34;, \u0026#34;lat\u0026#34;), crs = 4326) sf::st_transform(source_df,crs=\u0026#34;+proj=laea +lat_0=40 +lon_0=104\u0026#34;) China map basic map åŸºç¡€çš„ggplot2ç»˜å›¾ä»£ç å¦‚ä¸‹ï¼Œä½†æ˜¯æœ€è¿‘mapsåŒ…å¥½åƒæ²¡æœ‰å­˜å‚¨ä¸­å›½çš„æ•°æ®äº†ï¼Œæ‰€ä»¥æˆ‘ä»¬åº”è¯¥è‡ªå·±å»æ‰¾è‡ªå·±è¦ç”»çš„åŒºåŸŸçš„åœ°å›¾æ–‡ä»¶ã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 # æ³¨æ„ï¼Œæ— æ³•æ­£å¸¸è¿è¡Œ library(maps) library(ggplot2) # è¯»å–ä¸­å›½åœ°å›¾æ•°æ® china_map \u0026lt;- map_data(\u0026#34;china\u0026#34;) # ç»˜åˆ¶ä¸­å›½åœ°å›¾ ggplot() + geom_polygon(data = china_map, aes(x = long, y = lat, group = group), fill = \u0026#34;white\u0026#34;, color = \u0026#34;black\u0026#34;) + theme_void() + coord_fixed() æˆ‘å¸¸ç”¨çš„æ˜¯geojsonæ–‡ä»¶ï¼Œç½‘ä¸Šèƒ½å¤Ÿä¸‹è½½åˆ°ä¸­å›½åœ°å›¾çš„åœ°æ–¹å¾ˆå¤šï¼Œæ¯”å¦‚ GeoJSON.cnï¼Œyezongyang/china-geojsonç­‰ç­‰ï¼Œè€Œä¸–ç•Œä¸Šå…¶ä»–åŒºåŸŸï¼Œä¸åŒç²¾åº¦ï¼ˆæ´²ï¼Œå›½å®¶ï¼ŒåŸå¸‚ï¼Œå¿\u0026hellip;ï¼‰çš„åœ°å›¾æ•°æ®å°±éœ€è¦è‡ªå·±æŒ‰ç…§éœ€æ±‚å¯»æ‰¾ä¸€ä¸‹ï¼Œå¦‚GeoJSON Maps of the globe (ash.ms)ï¼Œgeorgique/world-geojsonï¼Œdatasets/geo-countriesç­‰ç­‰ã€‚\nä¸­å›½åœ°å›¾ç»˜åˆ¶ä¸»è¦å‚è€ƒè¿™ç¯‡åšå®¢ï¼šR-ggplot2 æ ‡å‡†ä¸­å›½åœ°å›¾åˆ¶ä½œã€‚\nä½¿ç”¨sfåŒ…è¯»å–åœ°å›¾æ•°æ®ï¼šè¿™é‡Œç”¨çš„æ˜¯æ°‘æ”¿å±€æä¾›çš„ä¸€ä¸ªAPIï¼Œå¦‚æœæ˜¯è‡ªå·±ä¸‹è½½çš„æ•°æ®å°±æ¢æˆæ–‡ä»¶åœ°å€å³å¯ï¼Œst_readæˆ–è€…read_sfå¯ä»¥ä»¥å¤„ç†geojsonæ–‡ä»¶ã€‚\n1 2 3 4 5 6 7 8 9 10 11 library(sf) library(ggplot2) #1.ä¸‹è½½æ•°æ® dir=getwd() china_shp=paste0(dir,\u0026#34;/china.json\u0026#34;) if(!file.exists(china_shp))download.file(\u0026#34;https://gitcode.net/mirrors/lyhmyd1211/geomapdata_cn/-/raw/master/china.json?inline=false\u0026#34;,china_shp) china \u0026lt;- sf::read_sf(china_shp) #2.æ°‘æ”¿éƒ¨API link: https://mp.weixin.qq.com/s/qj1SRc6D8sgYJYaZzDux6Q API_pre = \u0026#34;http://xzqh.mca.gov.cn/data/\u0026#34; china = sf::st_read(dsn = paste0(API_pre, \u0026#34;quanguo.json\u0026#34;), stringsAsFactors=FALSE) è¯»å–æ•°æ®åå˜æˆä¸€ä¸ªsfå¯¹è±¡ï¼Œsfç±»å‹çš„æ•°æ®æœ¬è´¨è¿˜æ˜¯ä¸€ä¸ªdata.frameï¼Œä½†æ˜¯å…¶ä¸­æœ‰äº›å…ƒç´ æ˜¯MULTIPOLYGON S3å¯¹è±¡ï¼Œè¿™æ˜¯ä¸€ç§è¡¨ç¤ºå¤šè¾¹å½¢å‡ ä½•å¯¹è±¡çš„æ•°æ®ç±»å‹ï¼Œå¯ä»¥ç”¨äºæè¿°å¤šä¸ªä¸ç›¸äº¤çš„å¤šè¾¹å½¢åŒºåŸŸï¼Œæ¯ä¸ªå¤šè¾¹å½¢å¯ä»¥ç”±ä¸€ä¸ªæˆ–å¤šä¸ªçº¿æ€§ç¯ç»„æˆã€‚åœ¨Rä¸­ï¼ŒMULTIPOLYGON é€šå¸¸ä½œä¸ºç©ºé—´æ•°æ®ç±»å‹çš„ä¸€ç§è¡¨ç¤ºï¼Œç”¨äºè¡¨ç¤ºåœ°ç†åŒºåŸŸçš„ç©ºé—´å½¢çŠ¶å’Œä½ç½®å…³ç³»ã€‚\nst_crså‡½æ•°å¯ä»¥ç”¨æ¥æ”¹å˜åœ°ç†åæ ‡ç³»ï¼š\n1 head(china) 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 ## Simple feature collection with 6 features and 10 fields ## Geometry type: MULTIPOLYGON ## Dimension: XY ## Bounding box: xmin: 97.1729 ymin: 34.58341 xmax: 126.0685 ymax: 53.33701 ## Geodetic CRS: WGS 84 ## # A tibble: 6 Ã— 11 ## adcode name childâ€¦Â¹ level parent subFeâ€¦Â² adchar center centrâ€¦Â³ acrouâ€¦â´ ## \u0026lt;chr\u0026gt; \u0026lt;chr\u0026gt; \u0026lt;int\u0026gt; \u0026lt;chr\u0026gt; \u0026lt;chr\u0026gt; \u0026lt;int\u0026gt; \u0026lt;chr\u0026gt; \u0026lt;list\u0026gt; \u0026lt;list\u0026gt; \u0026lt;list\u0026gt; ## 1 110000 åŒ—äº¬å¸‚ 16 provâ€¦ \u0026#34;{ \\\u0026#34;â€¦ 0 \u0026lt;NA\u0026gt; \u0026lt;dbl\u0026gt; \u0026lt;dbl\u0026gt; \u0026lt;int\u0026gt; ## 2 120000 å¤©æ´¥å¸‚ 16 provâ€¦ \u0026#34;{ \\\u0026#34;â€¦ 1 \u0026lt;NA\u0026gt; \u0026lt;dbl\u0026gt; \u0026lt;dbl\u0026gt; \u0026lt;int\u0026gt; ## 3 130000 æ²³åŒ—çœ 11 provâ€¦ \u0026#34;{ \\\u0026#34;â€¦ 2 \u0026lt;NA\u0026gt; \u0026lt;dbl\u0026gt; \u0026lt;dbl\u0026gt; \u0026lt;int\u0026gt; ## 4 140000 å±±è¥¿çœ 11 provâ€¦ \u0026#34;{ \\\u0026#34;â€¦ 3 \u0026lt;NA\u0026gt; \u0026lt;dbl\u0026gt; \u0026lt;dbl\u0026gt; \u0026lt;int\u0026gt; ## 5 150000 å†…è’™å¤è‡ªæ²»åŒº 12 provâ€¦ \u0026#34;{ \\\u0026#34;â€¦ 4 \u0026lt;NA\u0026gt; \u0026lt;dbl\u0026gt; \u0026lt;dbl\u0026gt; \u0026lt;int\u0026gt; ## 6 210000 è¾½å®çœ 14 provâ€¦ \u0026#34;{ \\\u0026#34;â€¦ 5 \u0026lt;NA\u0026gt; \u0026lt;dbl\u0026gt; \u0026lt;dbl\u0026gt; \u0026lt;int\u0026gt; ## # â€¦ with 1 more variable: geometry \u0026lt;MULTIPOLYGON [Â°]\u0026gt;, and abbreviated variable ## # names Â¹â€‹childrenNum, Â²â€‹subFeatureIndex, Â³â€‹centroid, â´â€‹acroutes 1 2 3 4 5 6 7 library(sf) library(ggplot2) library(ggspatial) # plot ggplot(china)+ geom_sf()+ labs(title=\u0026#34;Ministry of Civil of PRC\u0026#34;,x=\u0026#34;Lon\u0026#34;,y=\u0026#34;Lat\u0026#34;) 1 2 3 4 5 6 #æ”¹å˜crs # plot ggplot(china)+ geom_sf()+ coord_sf(crs = \u0026#34;+proj=laea +lat_0=40 +lon_0=104\u0026#34;)+ labs(title=\u0026#34;Ministry of Civil of PRC\u0026#34;,x=\u0026#34;Lon\u0026#34;,y=\u0026#34;Lat\u0026#34;) ä½¿ç”¨ggspatialåŒ…æ·»åŠ æ¯”ä¾‹å°ºå’ŒæŒ‡åŒ—é’ˆï¼š\n1 2 3 4 5 6 7 8 9 main_map=ggplot()+ geom_sf(data = china,fill=NA,size=1,color=\u0026#34;black\u0026#34;)+ coord_sf(crs = \u0026#34;+proj=laea +lat_0=40 +lon_0=104\u0026#34;)+ labs(title=\u0026#34;Ministry of Civil of PRC\u0026#34;,x=\u0026#34;Lon\u0026#34;,y=\u0026#34;Lat\u0026#34;) + annotation_scale(location = \u0026#34;bl\u0026#34;) + # spatial-aware automagic north arrow annotation_north_arrow(location = \u0026#34;tl\u0026#34;, which_north = \u0026#34;false\u0026#34;, style = north_arrow_fancy_orienteering)+theme_minimal() main_map annotation ä½¿ç”¨ggplotå¸¸è§„çš„æ³¨é‡Šæ‰‹æ®µgeom_point()æˆ–geom_text() åœ¨ä½¿ç”¨geom_sf ç»˜åˆ¶çš„åœ°å›¾ä¸Šä¸€èˆ¬ä¸ä¼šæˆåŠŸï¼Œè€Œæ˜¯åº”è¯¥å…ˆç”¨st_as_sfè½¬æ¢æˆ‘ä»¬çš„æ³¨é‡Šæ•°æ®ï¼Œç„¶åç”¨geom_sf() ï¼Œgeom_sf_text() æˆ–geom_sf_label()ã€‚\nä¸è¦æŠŠæ³¨é‡Šä¿¡æ¯æ”¾åœ¨coord_sf çš„åé¢ï¼Œå› ä¸ºggplotæ˜¯æŒ‰ç…§å›¾å±‚æ·»åŠ å…ƒç´ çš„ï¼Œcoord_sf è½¬æ¢åæ ‡ååŠ å…¥çš„æ³¨é‡Šå°±ä¼šæœ‰ä½ç½®åå·®ã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 #ç”Ÿæˆæµ‹è¯•æ•°æ® anno=data.frame(lon=runif(20,90,120), lat=runif(20,30,40), type=sample(letters[1:3], 20, replace = TRUE), value=runif(20,1,10)) #è½¬æ¢å¯¹è±¡ anno_sf \u0026lt;- st_as_sf(anno,coords = c(\u0026#34;lon\u0026#34;, \u0026#34;lat\u0026#34;),crs = 4326) p2=ggplot()+ geom_sf(data = china,fill=NA,size=1,color=\u0026#34;black\u0026#34;)+ #æ·»åŠ æ•£ç‚¹æ³¨é‡Š geom_sf(data = anno_sf,aes(fill=type,size=value),shape=21,colour=\u0026#39;black\u0026#39;,stroke=.25)+ scale_size(range = c(1,5))+ #æ·»åŠ text geom_sf_text(data = anno_sf,aes(label=round(value,1)),size=2,legend=\u0026#34;none\u0026#34;)+ coord_sf(crs = \u0026#34;+proj=laea +lat_0=40 +lon_0=104\u0026#34;)+ labs(title=\u0026#34;Ministry of Civil of PRC\u0026#34;,x=\u0026#34;Lon\u0026#34;,y=\u0026#34;Lat\u0026#34;) + annotation_scale(location = \u0026#34;bl\u0026#34;) + # spatial-aware automagic north arrow annotation_north_arrow(location = \u0026#34;tl\u0026#34;, which_north = \u0026#34;false\u0026#34;, style = north_arrow_fancy_orienteering)+theme_minimal() p2 å¦‚æœæƒ³è¦æ·»åŠ å…·ä½“åæ ‡çš„æ³¨é‡Šæˆ–è€…ä½¿ç”¨xlimæˆ–ï¼Œgeom_sf_texté‡Œè°ƒæ•´æ–‡æœ¬ä½ç½®çš„nudge_xç­‰åŠŸèƒ½ï¼Œé‚£ä¹Ÿéœ€è¦æ³¨æ„æŠ•å½±åæ ‡ç³»çš„å˜åŒ–ï¼Œä½¿ç”¨st_transformå¤„ç†ã€‚\n1 2 3 4 5 6 7 8 9 #ä¾‹å¦‚ï¼Œè¿™ä¸ªæ–¹æ³•æ˜¯æ— æ³•å–å‡º90Eåˆ°120Eçš„éƒ¨åˆ†çš„ï¼Œè€Œæ˜¯å¾ˆçª„çš„ä¸€æ®µ p2+xlim(90,120) data.frame(lon=c(90,120),lat=c(30,30))%\u0026gt;% st_as_sf(coords = c(\u0026#34;lon\u0026#34;, \u0026#34;lat\u0026#34;), crs = 4326) %\u0026gt;% sf::st_transform(df2_sf,crs=\u0026#34;+proj=laea +lat_0=40 +lon_0=104\u0026#34;) #å‘ç°ç»“æœå¯¹åº”çš„æ˜¯(-1348988,1539346),è¿™æ ·æˆªå–çš„æ‰æ˜¯90Eåˆ°120Eçš„éƒ¨åˆ†ã€‚ p2+xlim(-1348988,1539346) Leaflet usage Leafletæ˜¯ä¸€ä¸ªå¼€æºçš„JavaScriptåº“ï¼Œç”¨äºåˆ›å»ºäº¤äº’å¼åœ°å›¾ã€‚Rä¸­çš„LeafletåŒ…æä¾›äº†ä¸€ä¸ªè½»é‡çº§çš„æ¥å£ï¼Œå…è®¸åœ¨Rä¸­åˆ›å»ºäº¤äº’å¼åœ°å›¾ã€‚LeafletåŒ…æä¾›äº†è®¸å¤šåŸºæœ¬çš„åœ°å›¾æ“ä½œåŠŸèƒ½ï¼Œä¾‹å¦‚ç¼©æ”¾ã€å¹³ç§»å’Œæ—‹è½¬ï¼ŒåŒæ—¶è¿˜å…è®¸æ·»åŠ æ ‡è®°ã€æ–‡æœ¬æ³¨é‡Šã€å¤šè¾¹å½¢ã€çº¿æ¡å’Œç‚¹ã€‚\nåœ¨ä½¿ç”¨LeafletåŒ…ä¹‹å‰ï¼Œéœ€è¦å…ˆå®‰è£…å¹¶åŠ è½½å®ƒã€‚å¯ä»¥é€šè¿‡ä»¥ä¸‹ä»£ç å®‰è£…å’ŒåŠ è½½LeafletåŒ…ï¼š\n1 2 install.packages(\u0026#34;leaflet\u0026#34;) library(leaflet) åœ¨ä½¿ç”¨LeafletåŒ…åˆ›å»ºåœ°å›¾æ—¶ï¼Œéœ€è¦æä¾›ä¸€ä¸ªèµ·å§‹çš„ä¸­å¿ƒç‚¹å’Œç¼©æ”¾çº§åˆ«ã€‚ä¾‹å¦‚ï¼Œå¯ä»¥ä½¿ç”¨ä»¥ä¸‹ä»£ç åˆ›å»ºä¸€ä¸ªä»¥çº½çº¦å¸‚ä¸ºä¸­å¿ƒçš„åœ°å›¾ï¼Œæ­¤å¤–ï¼Œå¯ä»¥ä½¿ç”¨addTiles()å‡½æ•°æ·»åŠ åœ°å›¾å›¾å±‚ï¼Œè¿˜å¯ä»¥ä½¿ç”¨addMarkers()å‡½æ•°æ·»åŠ æ ‡è®°ï¼Œä½¿ç”¨addPolygons()å‡½æ•°æ·»åŠ å¤šè¾¹å½¢ï¼Œä½¿ç”¨addLines()å‡½æ•°æ·»åŠ çº¿æ¡ï¼Œä½¿ç”¨addPopups()å‡½æ•°æ·»åŠ å¼¹å‡ºçª—å£ç­‰ç­‰ã€‚é€šè¿‡ä½¿ç”¨è¿™äº›å‡½æ•°ï¼Œå¯ä»¥åœ¨åœ°å›¾ä¸Šæ·»åŠ å„ç§å„æ ·çš„å…ƒç´ ï¼Œä»è€Œåˆ›å»ºä¸€ä¸ªè‡ªå®šä¹‰çš„äº¤äº’å¼åœ°å›¾ï¼Œä»¥ä¸‹æ˜¯å®Œæˆä¸Šè¿°ä¸­å›½åœ°å›¾çš„ä¸€ä¸ªå®Œæ•´çš„ä¾‹å­ã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 # Prepare the text for the tooltip (HTML style): gre_text \u0026lt;- paste( \u0026#34;Type: \u0026#34;, anno$type, \u0026#34;\u0026lt;br/\u0026gt;\u0026#34;, \u0026#34;Value: \u0026#34;, round(anno$value,2), \u0026#34;\u0026lt;br/\u0026gt;\u0026#34; )%\u0026gt;% lapply(htmltools::HTML) type_col=colorFactor(palette = c(\u0026#34;red3\u0026#34;,\u0026#34;green3\u0026#34;,\u0026#34;blue3\u0026#34;),domain =anno$type) inter_p=leaflet(anno) %\u0026gt;% #æ·»åŠ å›¾å±‚ addTiles() %\u0026gt;% #ç¡®å®šä¸­å¿ƒç‚¹ setView(lng = 104, lat = 40, zoom = 4)%\u0026gt;% #æ·»åŠ æ•£ç‚¹æ³¨é‡Š addCircleMarkers(~lon, ~lat, fillColor = ~type_col(type), fillOpacity = 0.7, color=\u0026#34;white\u0026#34;, radius=8, stroke=FALSE, label = gre_text, labelOptions = labelOptions( style = list(\u0026#34;font-weight\u0026#34; = \u0026#34;normal\u0026#34;, padding = \u0026#34;3px 8px\u0026#34;), textsize = \u0026#34;13px\u0026#34;, direction = \u0026#34;auto\u0026#34;)) %\u0026gt;% #æ·»åŠ å›¾ä¾‹ addLegend( pal=type_col, values=~type, opacity=0.7, title = \u0026#34;Type\u0026#34;, position = \u0026#34;bottomright\u0026#34; ) class(inter_p) inter_p add in PPT leafletæœ€åç”Ÿæˆçš„æ˜¯ä¸€ä¸ªhtmlwidgetè¡ç”Ÿå¯¹è±¡ï¼Œæ‰€ä»¥å¯ä»¥ç”¨htmlwidgetsåŒ…ä¿å­˜ä¸ºhtmlæ–‡ä»¶å¹¶ç›´æ¥ç”¨æµè§ˆå™¨æ‰“å¼€ã€‚\n1 2 #ä¿å­˜ç»“æœ htmlwidgets::saveWidget(inter_p,file = \u0026#34;leaflet.html\u0026#34;) æœ‰æ—¶å€™è¿™ç§äº¤äº’åœ°å›¾åœ¨presentationå±•ç¤ºæ—¶éå¸¸å¥½ç”¨ï¼Œè¦æ˜¯èƒ½æ’å…¥åˆ°pptå°±æ˜¯ä»¶ç¾äº‹äº†ã€‚\nå¯æƒœçš„æ˜¯ï¼Œæ²¡æœ‰æ‰¾åˆ°å¾ˆå¥½çš„æ–¹å¼å®Œæˆè¿™ä¸ªåŠŸèƒ½ğŸ˜­ï¼ˆé™¤éä¸€å¼€å§‹çš„pptéƒ½æ˜¯ç”¨Rmarkdownåšçš„ï¼‰\nWindowsä¸Šçš„Powerpointå¯ä»¥è€ƒè™‘ä½¿ç”¨æ’ä»¶ï¼š\nwebViewï¼šPPTï¼šå¦‚ä½•åœ¨pptä¸­æ˜¾ç¤ºç½‘é¡µï¼Œå¹¶ä¸”å®æ—¶æ“ä½œï¼Ÿï¼ˆä½†å¥½åƒä¹ŸæŒ‚æ‰äº†ï¼‰\nLiveWebï¼šå¦‚ä½•å°†å®æ—¶ç½‘é¡µæ·»åŠ åˆ°PowerPointæ¼”ç¤ºæ–‡ç¨¿ ï¼ˆæ–°ç‰ˆofficeä¸è¡Œï¼‰\nMacä¸Šçš„Powerpointæ›´åŠ ä¸å¤ªè¡Œäº†ã€‚\nçœ‹æ¥åªèƒ½åŠ ä¸ªè¶…é“¾æ¥åˆ°è¯¥æ–‡ä»¶ï¼Œç„¶åç‚¹å‡»åè·³è½¬åˆ°æµè§ˆå™¨äº†ï¼ˆå¸Œæœ›æœªæ¥æœ‰è§£å†³æ–¹æ³•ï¼‰ã€‚\nGeoTiff manipulate æˆ‘æœ¬äººä¸æ˜¯åœ°ç§‘ç›¸å…³ä¸“ä¸šçš„ï¼Œä¸å¤ªä¼šç”¨ArcGISç­‰æ›´ä¸ºä¸“ä¸šçš„è½¯ä»¶ï¼Œä½†æœ‰æ—¶å€™ä¹Ÿéœ€è¦å»æ”¶é›†ä¸€äº›è·Ÿåœ°ç†ç¯å¢ƒç›¸å…³çš„æ•°æ®ï¼Œæ¯”å¦‚æ°”æ¸©ï¼ŒåœŸå£¤å…ƒç´ ç­‰ç­‰ï¼Œå‘ç°åœ¨å¾ˆå¤šæ•°æ®åº“ä¸­è¿™äº›æ•°æ®ä»¥geotiffæ ¼å¼å‚¨å­˜ã€‚\nGeoTIFFæ˜¯ä¸€ç§åŸºäºTIFFæ ¼å¼çš„åœ°ç†ä¿¡æ¯å›¾åƒæ–‡ä»¶æ ¼å¼ï¼Œå®ƒåŒ…å«äº†åœ°ç†ç©ºé—´ä¿¡æ¯å’Œå›¾åƒä¿¡æ¯ã€‚GeoTIFFæ–‡ä»¶å¯ä»¥åŒ…å«å•ä¸€å›¾åƒæˆ–å¤šä¸ªå›¾åƒï¼Œå¹¶ä¸”å¯ä»¥å­˜å‚¨åœ°çƒè¡¨é¢çš„å„ç§æ•°æ®ï¼Œå¦‚é«˜ç¨‹æ•°æ®ã€å«æ˜Ÿå›¾åƒã€æ°”è±¡æ•°æ®ç­‰ç­‰ã€‚GeoTIFFæ–‡ä»¶ä¸æ™®é€šçš„TIFFæ–‡ä»¶ç›¸æ¯”ï¼Œå¢åŠ äº†ä¸€äº›åœ°ç†å‚è€ƒä¿¡æ¯å’ŒæŠ•å½±ä¿¡æ¯ï¼Œå¯ä»¥ç”¨äºåœ°å›¾åˆ¶ä½œå’ŒGISåˆ†æç­‰é¢†åŸŸã€‚GeoTIFFæ–‡ä»¶ä¸­çš„åœ°ç†å‚è€ƒä¿¡æ¯åŒ…æ‹¬åœ°ç†åæ ‡ç³»å’ŒæŠ•å½±åæ ‡ç³»ï¼Œä»¥åŠæ¯ä¸ªåƒç´ æ‰€è¡¨ç¤ºçš„åœ°ç†ä½ç½®å’Œåƒç´ å¤§å°ç­‰ä¿¡æ¯ã€‚\nRasterLayer åœ¨Rè¯­è¨€ä¸­ï¼Œå¯ä»¥ä½¿ç”¨rasteråŒ…å’ŒgdalåŒ…è¯»å–å’Œå¤„ç†GeoTIFFæ–‡ä»¶ã€‚ä½¿ç”¨rasteråŒ…ä¸­çš„å‡½æ•°å¯ä»¥è¯»å–GeoTIFFæ–‡ä»¶å¹¶å°†å…¶è½¬æ¢ä¸ºRasterLayerå¯¹è±¡ï¼Œä»¥è¿›è¡Œå„ç§ç©ºé—´åˆ†ææ“ä½œã€‚\nRasterLayeræ˜¯rasteråŒ…ä¸­çš„ä¸€ç§å¯¹è±¡ç±»å‹ï¼Œå®ƒä»£è¡¨äº†ä¸€ä¸ªæ …æ ¼æ•°æ®é›†ã€‚æ …æ ¼æ•°æ®é›†æ˜¯ç”±å¤šä¸ªæ …æ ¼å•å…ƒç»„æˆçš„äºŒç»´çŸ©é˜µï¼Œæ¯ä¸ªæ …æ ¼å•å…ƒéƒ½æœ‰ä¸€ä¸ªç‰¹å®šçš„å€¼ï¼Œä»£è¡¨äº†è¯¥ä½ç½®ä¸Šçš„æ•°æ®ä¿¡æ¯ã€‚åœ¨Rè¯­è¨€ä¸­ï¼Œä½¿ç”¨rasteråŒ…å¯ä»¥æ–¹ä¾¿åœ°è¯»å–å’Œå¤„ç†æ …æ ¼æ•°æ®é›†ï¼Œä¾‹å¦‚é¥æ„Ÿå½±åƒã€åœ°å½¢å›¾ç­‰ã€‚é€šè¿‡å°†æ …æ ¼æ•°æ®é›†è½¬æ¢ä¸ºRasterLayerå¯¹è±¡ï¼Œå¯ä»¥è¿›è¡Œå„ç§ç©ºé—´åˆ†ææ“ä½œï¼Œä¾‹å¦‚è£å‰ªã€åˆå¹¶ã€é‡é‡‡æ ·ã€è®¡ç®—ã€ç»˜å›¾ç­‰ã€‚\nä¸‹é¢æ˜¯ä¸€äº›åŸºäºRasterLayerå¯¹è±¡ï¼ˆæˆ–è€…sfå¯¹è±¡ï¼Œå¾ˆå¤šå‡½æ•°éƒ½æ˜¯é€šç”¨çš„ï¼‰çš„å¸¸è§æ“ä½œå’Œåˆ†æçš„Rè¯­è¨€ä»£ç ç¤ºä¾‹ï¼š\nè®¡ç®—æ …æ ¼æ•°æ®çš„åŸºæœ¬ç»Ÿè®¡ä¿¡æ¯ 1 2 3 4 5 6 7 8 9 10 library(raster) # è¯»å…¥ä¸€ä¸ªæ …æ ¼æ•°æ®æ–‡ä»¶ r \u0026lt;- raster(\u0026#34;path/to/raster.tif\u0026#34;) # è®¡ç®—æœ€å°å€¼ã€æœ€å¤§å€¼ã€å‡å€¼ã€æ–¹å·® min_val \u0026lt;- minValue(r) max_val \u0026lt;- maxValue(r) mean_val \u0026lt;- mean(r) var_val \u0026lt;- var(r) å¯¹æ …æ ¼æ•°æ®è¿›è¡Œè£å‰ªã€åˆå¹¶ã€é‡é‡‡æ ·ç­‰æ“ä½œ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 library(raster) # è¯»å…¥ä¸¤ä¸ªæ …æ ¼æ•°æ®æ–‡ä»¶ r1 \u0026lt;- raster(\u0026#34;path/to/raster1.tif\u0026#34;) r2 \u0026lt;- raster(\u0026#34;path/to/raster2.tif\u0026#34;) # è£å‰ªä¸¤ä¸ªæ …æ ¼æ•°æ®æ–‡ä»¶ r1_crop \u0026lt;- crop(r1, extent(r2)) r2_crop \u0026lt;- crop(r2, extent(r1)) # åˆå¹¶ä¸¤ä¸ªæ …æ ¼æ•°æ®æ–‡ä»¶ r_merge \u0026lt;- merge(r1_crop, r2_crop) # å°†ä¸€ä¸ªæ …æ ¼æ•°æ®æ–‡ä»¶çš„åˆ†è¾¨ç‡é‡é‡‡æ ·ä¸ºå¦ä¸€ä¸ªæ …æ ¼æ•°æ®æ–‡ä»¶çš„åˆ†è¾¨ç‡ r_resample \u0026lt;- resample(r1_crop, r2_crop) è¿›è¡Œæ …æ ¼æ•°æ®çš„ä»£æ•°ã€é€»è¾‘è¿ç®— 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 library(raster) # è¯»å…¥ä¸¤ä¸ªæ …æ ¼æ•°æ®æ–‡ä»¶ r1 \u0026lt;- raster(\u0026#34;path/to/raster1.tif\u0026#34;) r2 \u0026lt;- raster(\u0026#34;path/to/raster2.tif\u0026#34;) # å¯¹ä¸¤ä¸ªæ …æ ¼æ•°æ®æ–‡ä»¶è¿›è¡ŒåŠ ã€å‡ã€ä¹˜ã€é™¤è¿ç®— r_add \u0026lt;- r1 + r2 r_sub \u0026lt;- r1 - r2 r_mul \u0026lt;- r1 * r2 r_div \u0026lt;- r1 / r2 # å¯¹ä¸€ä¸ªæ …æ ¼æ•°æ®æ–‡ä»¶è¿›è¡Œé€»è¾‘ä¸ã€æˆ–ã€éè¿ç®— r_and \u0026lt;- r1 \u0026amp; r2 r_or \u0026lt;- r1 | r2 r_not \u0026lt;- !r1 è¿›è¡Œæ …æ ¼æ•°æ®çš„å¯è§†åŒ– 1 2 3 4 5 6 7 8 9 10 11 12 13 library(raster) # è¯»å…¥ä¸€ä¸ªæ …æ ¼æ•°æ®æ–‡ä»¶ r \u0026lt;- raster(\u0026#34;path/to/raster.tif\u0026#34;) # ç»˜åˆ¶ç­‰é«˜çº¿å›¾ contour(r, add=FALSE) # ç»˜åˆ¶ç­‰å€¼çº¿å›¾ image(r, col=terrain.colors(255)) # ç»˜åˆ¶æ¸å˜è‰²å›¾ plot(r, col=rainbow(255)) Example ç»§ç»­æˆ‘ä»¬ä¸Šé¢çš„ä¸­å›½åœ°å›¾ç»˜åˆ¶ï¼Œæˆ‘ä»¬æƒ³è¦è·å¾—æŸä¸ªæ—¶é—´çš„ä¸­å›½æ°”æ¸©å›¾ï¼š\né¦–å…ˆåœ¨WorldClimç½‘ç«™ä¸Šå¯ä»¥ä¸‹è½½åˆ°å…¨çƒå†å²å¤©æ°”ä¿¡æ¯ï¼š\næˆ‘ä»¬ä¸‹è½½ä¸€ä¸ªaverage temperatureä¿¡æ¯ï¼Œç²¾åº¦ä¸º10minute(å³10ä¸ªç»çº¬åº¦çš„å•ä½ï¼Œæ¯”è¾ƒç²—ç•¥ï¼Œ35Mï½)ï¼Œé€šè¿‡æŠŠå…¨çƒçš„æ•°æ®mapåˆ°æˆ‘ä»¬ä¹‹å‰å·²ç»å¾—åˆ°çš„sfå¯¹è±¡chinaä¸Šå°±å¯ä»¥å–å‡ºè¿™éƒ¨åˆ†çš„æ•°æ®äº†ã€‚\n1 2 3 4 5 library(raster) avgtemp \u0026lt;- raster(\u0026#34;~/Downloads/wc2.1_10m_tavg/wc2.1_10m_tavg_01.tif\u0026#34;) #å…¨çƒå¹³å‡æ°”æ¸©æ•°æ® plot(avgtemp) 1 2 3 #åˆ‡ç‰‡ china_tmp=crop(avgtemp,china) plot(china_tmp) 1 2 3 #æ©è†œ china_tmp=mask(china_tmp,china) plot(china_tmp) æœ€åå†æŠŠç»è¿‡åˆ‡ç‰‡æ©è†œå¤„ç†çš„RasterLayerè½¬æ¢ä¸ºsfå¯¹è±¡ï¼Œå°±å¯ä»¥æ ¹æ®æˆ‘ä»¬ä¹‹å‰ç»˜åˆ¶annotationçš„æ–¹æ³•æŠŠæ°”æ¸©æ•°æ®å…¨éƒ¨ç»˜åˆ¶ä¸Šå»äº†ã€‚\nå¤§åŠŸå‘Šæˆï¼è¿™é‡Œæ˜¯æœ€åçš„ç»“æœï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 # å°†RasterLayerè½¬æ¢ä¸ºsfå¯¹è±¡ sf_data \u0026lt;- st_as_sf(rasterToPolygons(china_tmp), crs = st_crs(china_tmp)) colnames(sf_data)[1]=\u0026#34;Average_temperature\u0026#34; ggplot()+ geom_sf(data = china,fill=NA,size=1,color=\u0026#34;black\u0026#34;)+ #æ·»åŠ æ …æ ¼æ•°æ® geom_sf(data = sf_data,aes(fill=Average_temperature),shape=22,size=0.5,stroke=0,color=NA)+ scale_fill_gradient2(low = \u0026#34;blue\u0026#34;,mid = \u0026#34;white\u0026#34;,high = \u0026#34;red\u0026#34;)+ #ä½¿ç”¨ggnewscaleäº§ç”Ÿä¸€ä¸ªæ–°çš„fillæ˜ å°„ï¼Œå¦åˆ™ä¼šè¦†ç›–æŠ¥é”™ã€‚ ggnewscale::new_scale_fill()+ #æ·»åŠ æ•£ç‚¹æ³¨é‡Š geom_sf(data = anno_sf,aes(fill=type,size=value),shape=21,colour=\u0026#39;black\u0026#39;,stroke=.25)+ scale_size(range = c(1,5))+ #æ·»åŠ text geom_sf_text(data = anno_sf,aes(label=round(value,1)),size=2,legend=\u0026#34;none\u0026#34;)+ coord_sf(crs = \u0026#34;+proj=laea +lat_0=40 +lon_0=104\u0026#34;)+ labs(title=\u0026#34;Ministry of Civil of PRC\u0026#34;,x=\u0026#34;Lon\u0026#34;,y=\u0026#34;Lat\u0026#34;) + annotation_scale(location = \u0026#34;bl\u0026#34;) + # spatial-aware automagic north arrow annotation_north_arrow(location = \u0026#34;tl\u0026#34;, which_north = \u0026#34;false\u0026#34;, style = north_arrow_fancy_orienteering)+theme_minimal() ","date":"2023-04-06T00:00:00Z","image":"/p/r-map/index_files/figure-html/unnamed-chunk-22-1_hu25d347af0f26b4f0f63f78f0a939c84a_495129_120x120_fill_box_smart1_3.png","permalink":"/p/r-map/","title":"Rç»˜åˆ¶ä¼˜ç¾çš„åœ°å›¾"},{"content":"","date":"2023-04-03T00:00:00Z","permalink":"/p/antibiotics-resistance/","title":"antibiotics resistance"},{"content":"Motivation cd-hitåœ¨æ•°æ®é‡å¾ˆå¤§çš„æƒ…å†µä¸‹ä¼šéå¸¸æ…¢ï¼Œæˆ‘é—®chatGPTæœ‰æ²¡æœ‰æ›´å¿«çš„ï¼š\nhttps://www.nature.com/articles/s41467-018-04964-5 æ˜¯çš„ï¼Œæœ‰ä¸€äº›å…¶ä»–çš„åŸºå› åºåˆ—èšç±»è½¯ä»¶ä¹Ÿæ¯”è¾ƒæµè¡Œï¼Œå…¶ä¸­ä¸€äº›ä¹Ÿæ˜¯éå¸¸å¿«é€Ÿçš„ï¼Œä¾‹å¦‚ï¼š\nUCLUSTï¼šè¿™æ˜¯ä¸€ç§åŸºäºè´ªå¿ƒç®—æ³•çš„èšç±»å·¥å…·ï¼Œå¯ç”¨äºèšç±»DNAå’Œè›‹ç™½è´¨åºåˆ—ã€‚å®ƒæ˜¯CD-HITçš„ä¸€ç§å˜ä½“ï¼Œä¹Ÿæ˜¯é€Ÿåº¦éå¸¸å¿«çš„è½¯ä»¶ä¹‹ä¸€ã€‚\nVSEARCHï¼šè¿™æ˜¯ä¸€ç§ç±»ä¼¼äºUCLUSTçš„å·¥å…·ï¼Œä¹Ÿæ˜¯åŸºäºè´ªå¿ƒç®—æ³•ï¼Œå¯ä»¥ç”¨äºèšç±»DNAå’Œè›‹ç™½è´¨åºåˆ—ã€‚å®ƒçš„é€Ÿåº¦æ¯”CD-HITæ›´å¿«ï¼Œè€Œä¸”è¿˜æ”¯æŒå¤šçº¿ç¨‹å’Œä¸€äº›å…¶ä»–é«˜çº§åŠŸèƒ½ã€‚\nMMSEQS2ï¼šè¿™æ˜¯ä¸€ç§ä½¿ç”¨å›¾åƒå‰–ææŠ€æœ¯çš„èšç±»å·¥å…·ï¼Œå¯ä»¥ç”¨äºèšç±»éå¸¸å¤§çš„åºåˆ—æ•°æ®é›†ã€‚å®ƒæ¯”CD-HITå’ŒUCLUSTéƒ½è¦å¿«ï¼Œè€Œä¸”è¿˜æ”¯æŒå¤šçº¿ç¨‹å’ŒGPUåŠ é€Ÿã€‚\nSwarmï¼šè¿™æ˜¯ä¸€ç§åŸºäºèšç±»åŠå¾„çš„å·¥å…·ï¼Œå¯ä»¥ç”¨äºèšç±»16S rRNAåºåˆ—ç­‰å¾®ç”Ÿç‰©ç¾¤è½æ•°æ®ã€‚å®ƒæ¯”CD-HITç­‰å·¥å…·è¦å¿«ï¼Œè€Œä¸”å¯ä»¥å¤„ç†é«˜åº¦å†—ä½™çš„åºåˆ—ã€‚\nå°è¯•ä½¿ç”¨ä¸€ä¸‹mmseqs2 è¦ä½¿ç”¨MMseqs2èšç±»å¤§é‡æ ¸é…¸åºåˆ—ï¼Œå¯ä»¥æŒ‰ç…§ä»¥ä¸‹æ­¥éª¤æ“ä½œï¼š\nå‡†å¤‡æ•°æ®ï¼šæ”¶é›†æ‰€æœ‰è¦èšç±»çš„æ ¸é…¸åºåˆ—ï¼Œå¹¶å°†å®ƒä»¬å­˜å‚¨åœ¨ä¸€ä¸ªæ–‡ä»¶ä¸­ï¼Œä¾‹å¦‚FASTAæ ¼å¼ã€‚\nå®‰è£…MMseqs2ï¼šè®¿é—®MMseqs2çš„å®˜æ–¹ç½‘ç«™ï¼ˆhttps://github.com/soedinglab/MMseqs2ï¼‰å¹¶ä¸‹è½½å’Œå®‰è£…è½¯ä»¶åŒ…ã€‚\nåˆ›å»ºæ•°æ®åº“ï¼šä½¿ç”¨MMseqs2å°†æ‰€æœ‰æ ¸é…¸åºåˆ—å¯¼å…¥ä¸€ä¸ªæ•°æ®åº“ä¸­ã€‚ä¾‹å¦‚ï¼Œå¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤å°†FASTAæ ¼å¼çš„åºåˆ—å¯¼å…¥åˆ°MMseqs2æ•°æ®åº“ä¸­ï¼š mmseqs createdb input.fasta db_name\nå…¶ä¸­ï¼Œ\u0026ldquo;input.fasta\u0026quot;æ˜¯ä½ çš„è¾“å…¥æ–‡ä»¶åï¼Œ\u0026ldquo;db_name\u0026quot;æ˜¯ä½ æƒ³è¦ä¸ºæ•°æ®åº“å–çš„åç§°ã€‚\nè¿è¡Œèšç±»ï¼šä½¿ç”¨MMseqs2è¿è¡Œèšç±»åˆ†æã€‚ä¾‹å¦‚ï¼Œå¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤è¿è¡Œèšç±»åˆ†æï¼š mmseqs easy-cluster db_name cluster_name tmp --threads 4\nå…¶ä¸­ï¼Œ\u0026ldquo;db_name\u0026quot;æ˜¯ä½ çš„æ•°æ®åº“åç§°ï¼Œ\u0026ldquo;cluster_name\u0026quot;æ˜¯ä½ æƒ³è¦ä¸ºèšç±»ç»“æœå–çš„åç§°ï¼Œ\u0026ldquo;tmp\u0026quot;æ˜¯ä½ æƒ³è¦ä¸ºä¸´æ—¶æ–‡ä»¶å¤¹å–çš„åç§°ï¼Œ\u0026rdquo;\u0026ndash;threads 4\u0026quot;è¡¨ç¤ºä½ æƒ³è¦ä½¿ç”¨4ä¸ªçº¿ç¨‹è¿è¡Œåˆ†æã€‚\nè§£æç»“æœï¼šç­‰å¾…èšç±»åˆ†æå®Œæˆåï¼Œå¯ä»¥ä½¿ç”¨MMseqs2çš„å…¶ä»–å·¥å…·ï¼ˆå¦‚\u0026quot;mmseqs createtsv\u0026rdquo;ï¼‰æ¥è§£æèšç±»ç»“æœï¼Œå¹¶å°†ç»“æœå¯¼å‡ºåˆ°æ‰€éœ€çš„æ ¼å¼ä¸­ï¼ˆå¦‚TSVæ ¼å¼ï¼‰ã€‚ éœ€è¦æ³¨æ„çš„æ˜¯ï¼ŒMMseqs2æ”¯æŒå¤šç§èšç±»ç®—æ³•å’Œå‚æ•°è®¾ç½®ï¼Œå› æ­¤åœ¨è¿è¡Œåˆ†æä¹‹å‰ï¼Œåº”è¯¥æ ¹æ®å…·ä½“çš„åº”ç”¨éœ€æ±‚è¿›è¡Œè®¾ç½®å’Œä¼˜åŒ–ã€‚ä¾‹å¦‚ï¼Œä½ å¯ä»¥é€‰æ‹©ä½¿ç”¨å…¶ä»–çš„èšç±»ç®—æ³•ï¼Œæˆ–è°ƒæ•´èšç±»çš„ç›¸ä¼¼æ€§é˜ˆå€¼ç­‰å‚æ•°ï¼Œä»¥è·å¾—æœ€ä½³çš„èšç±»ç»“æœã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 #æµ‹è¯•æ¯”è¾ƒä¸€ä¸‹ cd ~/work/st/temp/cluster_test $ ll ../prodigal/C1.gene.fa -rw-r--r-- 1 pengchen jianglab 338M Apr 7 2022 ../prodigal/C1.gene.fa 800000æ¡åºåˆ— #cd-hit============ ## aSè¦†ç›–åº¦ï¼Œc:identityç›¸ä¼¼åº¦ï¼ŒG0å±€éƒ¨æ¯”å¯¹ï¼Ÿï¼Œgæœ€ä¼˜è§£ï¼ŒTå¤šçº¿ç¨‹ï¼ŒMå†…å­˜0ä¸é™åˆ¶ cd-hit-est -i ../prodigal/C1.gene.fa \\ -o cd_hit.fa \\ -aS 0.9 -c 0.9 -g 0 -T 0 -M 0 #ä¸¤å°æ—¶è¿‡å»äº†ï¼Œè¿˜åœ¨å¤„ç†ç¬¬20000æ¡ #mmseqs2========= ##min-seq-id:identityï¼ˆç›¸ä¼¼åº¦ï¼Ÿï¼‰ï¼Œcè¦†ç›–åº¦ï¼Œrescore-mode3: global alignment #å»ºåº“ input_fa=../prodigal/C1.gene.fa DB=C1.geneDB DB_clu=mmseq_out mmseqs createdb $input_fa $DB #èšç±» mmseqs cluster $DB $DB_clu tmp \\ --min-seq-id 0.9 -c 0.9 --cov-mode 1 --threads 8 #è¾“å‡ºè½¬æ¢ #ç¬¬ä¸€åˆ—æ˜¯ä»£è¡¨åºåˆ—idï¼Œç¬¬äºŒåˆ—æ˜¯æˆå‘˜åºåˆ—id #mmseqs createtsv $DB $DB mmseq_out mmseq_out.tsv #mmseqs createseqfiledb $DB $DB_clu ${DB_clu}_seq #mmseqs result2flat $DB $DB ${DB_clu}_seq ${DB_clu}_seq.fasta #è·å–represent sequence mmseqs createsubdb $DB_clu $DB ${DB_clu}_rep mmseqs convert2fasta ${DB_clu}_rep ${DB_clu}_rep.fasta #ä¸Šè¿°æ­¥éª¤å¯ä»¥ç›´æ¥ç”¨easyclusteræ›¿ä»£ã€‚ input_fa=../prodigal/C1.gene.fa mmseqs easy-cluster $input_fa cluster_res tmp \\ --min-seq-id 0.9 -c 0.9 --cov-mode 1 --threads 8 #å†æµ‹è¯•ä¸€ä¸‹easylinclust input_fa=../prodigal/C1.gene.fa mmseqs easy-linclust $input_fa lin_res tmp \\ --min-seq-id 0.9 -c 0.9 --cov-mode 1 --threads 8 #ç»“æœmmseq_out_rep.fastaï¼š315M #è¿™æ˜¯å•æ ·æœ¬assemblyç»“æœçš„èšç±»ç»“æœï¼Œåˆç†ã€‚ #250s,å¿«å¾—ä¸€æ‰¹,ä½¿ç”¨10GBå·¦å³çš„å†…å­˜ã€‚ #clusteræ¨¡å—å¯èƒ½éœ€è¦å¤§é‡å†…å­˜ã€‚åŒ…å« N ä¸ªåºåˆ—å’Œæ¯ä¸ªåºåˆ—å¹³å‡ r ä¸ªæ¯”å¯¹ç»“æœçš„æ•°æ®åº“çš„å†…å­˜æ¶ˆè€—å¯ä»¥ä¼°è®¡ä¸º #M = (6 * N * r) å­—èŠ‚ Cores per node: 8 CPU Utilized: 00:12:22 CPU Efficiency: 41.97% of 00:29:28 core-walltime Job Wall-clock time: 00:03:41 Memory Utilized: 9.40 GB Memory Efficiency: 60.14% of 15.62 GB å¤šä¸ªå¾…èšç±»æ–‡ä»¶çš„ä½¿ç”¨æ–¹æ³•\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 #cd-hitä¸¤ä¸ªæ–‡ä»¶ cd-hit-est -i ../prodigal/C1.gene.fa \\ -o A.fa \\ -aS 0.9 -c 0.9 -g 0 -T 0 -M 0 # Aå’ŒBåŸºå› é›†å¾…èšç±» # è®¡ç®—Bä¸­ç‰¹æœ‰çš„åŸºå›  cd-hit-est-2d -i A.fa -i2 B.fa -o B.uni.fa \\ -aS 0.9 -c 0.9 -g 0 \\ -T 96 -M 0 -d 0 # åˆå¹¶ä¸ºéå†—ä½™åŸºå› é›† cat A.fa B.uni.fa \u0026gt; NR.fa #æœ‰æ›´å¤šæ–‡ä»¶æ—¶ #å¯ä»¥å‡†å¤‡ä¸€ä¸ªnamelist first=`head -n1 namelist` echo handing $first cd-hit-est -i $first \\ -o NR.fa \\ -aS 0.9 -c 0.9 -g 0 -T 0 -M 0 for i in `tail -n+2 namelist` do echo handing $i cd-hit-est-2d -i NR.fa -i2 $i -o ${i}.uni.fa \\ -aS 0.9 -c 0.9 -g 0 \\ -T 96 -M 0 -d 0 cat ${i}.uni.fa \u0026gt;\u0026gt; NR.fa done #mmseqs2 #çœ‹çœ‹ç›´æ¥ä¸Šä¸¤ä¸ªæ–‡ä»¶çš„èšç±»ç»“æœ #åˆå¹¶æ–‡ä»¶ï¼šä½¿ç”¨catå‘½ä»¤å°†æ‰€æœ‰æ ¸é…¸åºåˆ—æ–‡ä»¶åˆå¹¶æˆä¸€ä¸ªå¤§çš„FASTAæ ¼å¼æ–‡ä»¶ sed -i \u0026#34;/\u0026gt;/s/\u0026gt;/\u0026gt;C2_/\u0026#34; ../prodigal/C2.gene.fa cat ../prodigal/C1.gene.fa ../prodigal/C2.gene.fa \u0026gt; all.fasta #å»ºåº“ mmseqs createdb all.fasta all DB=all DB_clu=all_clu #èšç±» mmseqs cluster $DB $DB_clu tmp \\ --min-seq-id 0.9 -c 0.9 --cov-mode 1 --threads 8 --rescore-mode 3 #è¾“å‡ºè½¬æ¢ #è·å–represent sequence mmseqs createsubdb $DB_clu $DB ${DB_clu}_rep mmseqs convert2fasta ${DB_clu}_rep ${DB_clu}_rep.fasta #mmseqs2 oldDB=C1.geneDB cluDB_old=mmseq_out newDB=all mmseqs clusterupdate $oldDB $newDB $cluDB_old ${newDB}_updated ${cluDB}_updated tmp \\ --min-seq-id 0.9 -c 0.9 --cov-mode 1 --threads 8 --rescore-mode 3 ","date":"2023-04-03T00:00:00Z","permalink":"/p/mmseqs2/","title":"Mmseqs2çš„åŸºç¡€ä½¿ç”¨"},{"content":"Theories and Methods of Species Diversity Research\nè¿™æ˜¯æˆ‘åœ¨ä¸€é—¨ç ”ç©¶ç”Ÿè¯¾ç¨‹ä¸Šçš„è¯¾ç¨‹ä»»åŠ¡ï¼ŒæŸ¥é˜…äº†ä¸€äº›æ–‡çŒ®æ€»ç»“æ•´ç†äº†ç‰©ç§å¤šæ ·æ€§ç ”ç©¶ç†è®ºä¸æ–¹æ³•ï¼Œæ¯”è¾ƒåŸºç¡€ï¼Œæ²¡æœ‰å¯¹ä¸€äº›ç†è®ºå’Œæ¨¡å‹æ·±å…¥è®²è§£ï¼Œä»…åšåˆ†äº«ã€‚\nIntroduction Biological diversity largely describes the change of life from genes to ecosystems, comprising their existences, genetic variations, their environment, populations and the ecosystem in which they are existing and other evolutionary developments that keep the system functioning, changing and adapting.\nç”Ÿç‰©å¤šæ ·æ€§æ˜¯åº¦é‡ç”Ÿå‘½çš„å˜å¼‚å’Œå˜å¼‚èƒ½åŠ›çš„æŒ‡æ ‡ï¼Œåˆåˆ†æˆé—ä¼ å¤šæ ·æ€§ï¼Œç‰©ç§å¤šæ ·æ€§ï¼Œç”Ÿæ€ç³»ç»Ÿå¤šæ ·æ€§ä¸‰ä¸ªå±‚æ¬¡ï¼Œæˆ‘è¿™é‡Œä¸»è¦ä»‹ç»ç‰©ç§å¤šæ ·æ€§ã€‚ ä»–åˆæœ‰ä¸‰ä¸ªå°ºåº¦å’Œä¸‰ä¸ªç»´åº¦ï¼Œåˆ†åˆ«æ˜¯Î±ï¼ŒÎ²ï¼ŒÎ³åˆ†ç±»å¤šæ ·æ€§ï¼Œè°±ç³»å¤šæ ·æ€§ï¼ŒåŠŸèƒ½å¤šæ ·æ€§ï¼Œè¿™é‡Œçš„æ¯ä¸ªäº¤é›†éƒ½æ˜¯å¯ä»¥ç ”ç©¶çš„ã€‚\nData collection methods æˆ‘ä»¬åº”è¯¥å¦‚ä½•è¿›è¡Œç‰©ç§å¤šæ ·æ€§ç ”ç©¶å‘¢ï¼Ÿ\né¦–å…ˆå½“ç„¶æ˜¯åˆ¶å®šç ”ç©¶æ–¹æ¡ˆï¼Œè¿›è¡Œå–æ ·ï¼Œ å¯¹äºè‡ªå·±çš„ç ”ç©¶å¯¹è±¡ï¼Œå¯ä»¥è¿›è¡Œéšæœºå–æ ·ï¼Œç³»ç»Ÿå–æ ·ï¼Œæˆ–è€…å…¶ä»–çš„ä¸€äº›æ–¹æ³•ï¼Œ ä¹Ÿå¯èƒ½æ˜¯ä¸€å—æœ‰ä»£è¡¨æ€§çš„æ°¸ä¹…æ ·åœ°ï¼Œå¯ä»¥ç ”ç©¶å®ƒçš„åŠ¨æ€å˜åŒ–ã€‚\nç„¶åæ˜¯å¼€å§‹è°ƒæŸ¥è·å–æ•°æ®ï¼Œä¼ ç»Ÿçš„æ–¹æ³•é‡Œï¼Œæ¤ç‰©ç¾¤è½ä¸€èˆ¬ä¼šè¿›è¡Œå®åœ°è°ƒæŸ¥æˆ–è€…ä½¿ç”¨é¥æ„Ÿå›¾åƒæ”¶é›†æ•°æ®ï¼ŒåŠ¨ç‰©ä¼šç”¨åˆ°è‡ªåŠ¨éŸ³è§†é¢‘è®°å½•ï¼Œæ˜†è™«çš„è¯è¿˜ä¼šæœ‰ç¯å…‰è¯±æ•æ³•ç­‰ã€‚\nè¿˜æœ‰å¯¹å¾®ç”Ÿç‰©è¿›è¡Œè°ƒæŸ¥çš„ï¼Œç”¨ç›´æ¥åŸ¹å…»æ–¹æ³•æˆ–è€…æµ‹åºæ‰‹æ®µã€‚\nå½“ç„¶è¿™äº›æ–¹æ³•ä¸æ˜¯ä¸€å®šä¸“ç”¨çš„ï¼Œä¸€äº›æ–°çš„æ–¹æ³•ä¹Ÿå¯ä»¥äº¤å‰ä½¿ç”¨ï¼Œæ¯”å¦‚eDNAæ–¹æ³•ï¼š eDNAæ˜¯æŒ‡åœ¨ç¯å¢ƒæ ·å“ä¸­æ‰€æœ‰è¢«å‘ç°çš„ä¸åŒç”Ÿç‰©çš„åŸºå› ç»„DNAçš„æ··åˆï¼Œç¯å¢ƒå¯ä»¥åŒ…æ‹¬åœŸå£¤ã€æ²‰ç§¯ç‰©ã€æ’æ³„ç‰©ã€ç©ºæ°”ã€æ°´ä½“ï¼Œç”šè‡³ç”Ÿç‰©ä¸ªä½“æœ¬èº«ã€‚ åŠ¨ç‰©åœ¨æŸä¸ªç¯å¢ƒä¸­ç”Ÿæ´»ï¼Œèº«ä¸Šçš„å„ç§ç—•è¿¹ä¼šæºå¸¦ç€è‡ªèº«DNAæ‰è½åˆ°å››å‘¨ï¼Œæ‰€ä»¥ç”¨è¿™ä¸ªæ–¹æ³•æœ‰è°ƒæŸ¥å„ç§ç‰©ç§çš„æ½œåŠ›ï¼Œæœ‰ç¯‡æ–‡ç« å°±ç”¨ç©ºæ°”çš„eDNAè°ƒæŸ¥äº†é™„è¿‘çš„åŠ¨ç‰©ã€‚\næ­¤å¤–è¿˜æœ‰æ•´åˆçš„æ–¹æ³•ï¼Œæ¯”å¦‚è¿™ç¯‡æ–‡ç« å°±æå‡ºï¼Œå°†é¥æ„Ÿï¼Œç”°é—´è°ƒæŸ¥å’Œæµ‹åºç»“åˆåœ¨ä¸€èµ·ï¼Œæ¥è·å¾—å®Œæ•´çš„ç‰©ç§é£åº¦è¡¨ã€‚\næœ‰äº†è¿™äº›æ–¹æ³•åï¼Œæˆ‘ä»¬è¿˜è¦æ˜ç¡®è‡ªå·±è¦è·å–çš„æœ‰å“ªäº›æ•°æ®ï¼š\næˆ‘è®¤ä¸ºä¸»è¦æœ‰ä¸‰ä¸ªæ–¹é¢ï¼š\nç¬¬ä¸€ä¸ªå°±æ˜¯ç¾¤è½çš„ç‰¹å¾ï¼ŒåŒ…æ‹¬å„ä¸ªç‰©ç§çš„ä¸°åº¦ï¼Œå¯†åº¦ï¼Œé¢‘åº¦ï¼Œç¾¤è½çš„ç”Ÿç‰©é‡ï¼›å¦‚æœæ˜¯æ¤ç‰©çš„è¯ï¼Œè¿˜è¦æ”¶é›†ç›–åº¦ã€æ ‘å† ç›´å¾„ã€æ ‘é«˜ã€ä½ç½®ç­‰ç­‰ã€‚ ç¬¬äºŒä¸ªé‡è¦çš„æ–¹é¢æ˜¯æˆ‘ä»¬æ¯ä¸ªæ ·æ–¹çš„ç¯å¢ƒå› å­æ•°æ®ï¼š åŒ…æ‹¬æ°”å€™æ•°æ®ï¼Œå¦‚é™æ°´ï¼Œç›¸å¯¹æ¹¿åº¦ï¼Œæ¸©åº¦ç­‰ç­‰ï¼Œåœ°å½¢æ•°æ®ï¼Œå¦‚æµ·æ‹”ï¼Œå¡åº¦ç­‰ç­‰ï¼ŒåœŸå£¤æ•°æ®ï¼Œå¦‚åœŸå£¤çš„ç²’å¾„ä¿æ°´é‡å’Œå„ç§åŒ–å­¦å…ƒç´ ç­‰ç­‰ï¼Œæœ‰æ¡ä»¶çš„è¯å¯ä»¥åšå¾®ç”Ÿç‰©å’Œäººç±»å› ç´ çš„æ•°æ®æ”¶é›†ã€‚ ç¬¬ä¸‰ä¸ªæ–¹é¢æ˜¯ç‰©ç§çš„ç‰¹å¾ï¼šæ¯”å¦‚æ¤ç‰©çš„ç”Ÿæ´»å‹ï¼Œç”Ÿé•¿å‹ï¼ŒåŠŸèƒ½ç±»å‹ç­‰ï¼Œè¿™ä¸ªå¯¹åé¢åŠŸèƒ½å¤šæ ·æ€§çš„ç ”ç©¶å¾ˆå…³é”® è¿˜æœ‰å°±æ˜¯å„ä¸ªç‰©ç§çš„ç³»ç»Ÿå‘è‚²ä½ç½®ï¼Œå¯ä»¥å»æ‰¾å„ç§æ¤ç‰©å¿—ï¼ŒåŠ¨ç‰©å¿—æˆ–è€…NCBIçš„æ•°æ®åº“æ¥è·å¾—ï¼Œè¿™ä¸ªå¯¹è°±ç³»å¤šæ ·æ€§ç ”ç©¶å¾ˆé‡è¦ã€‚ Measure methods è·å–äº†ä»¥ä¸Šè¿™äº›æ•°æ®åï¼Œæ¥ä¸‹æ¥å°±æ˜¯ä½¿ç”¨ä¸€äº›æŒ‡æ ‡å¯¹å¤šæ ·æ€§è¿›è¡Œåº¦é‡ã€‚\nTaxa Î± diversity é¦–å…ˆæ˜¯åˆ†ç±»çš„aå¤šæ ·æ€§æŒ‡æ•°ï¼Œä¸»è¦æœ‰ä»¥ä¸‹å‡ ä¸ªç±»åˆ«ï¼š\nä½¿ç”¨ç‰©ç§æ•°æŒ‡ç¤º ç‰©ç§æ•°å’Œç‰©ç§æ€»ä¸ªä½“æ•° ç‰©ç§æ•°å’Œç‰©ç§æ€»ä¸ªä½“æ•°å’Œæ¯ä¸ªç‰©ç§çš„ä¸ªä½“æ•°ï¼ˆè¿˜æœ‰ä¸€äº›ä¸“é—¨ç”¨åœ¨æµ‹åºæ•°æ®è¡¨å¾å¤šæ ·æ€§çš„ï¼Œå› ä¸ºæµ‹åºæ‰‹æ®µæˆ‘ä»¬èƒ½è·å¾—çš„ä¸°åº¦è¡¨æ˜¯ä¸ä¼ ç»Ÿçš„ã€‚è¿™ç§æ ‘æˆ‘çœ‹åˆ°äº†å‡ æ£µï¼Œé‚£ä¸ªåŠ¨ç‰©æœ‰å‡ åªç­‰ç­‰ï¼Œè€Œæ˜¯ç”¨æµ‹åºæµ‹åˆ°äº†å¤šå°‘æ¡DNAæ¥è¡¨å¾çš„ï¼Œæ‰€ä»¥ä¼šæœ‰å¾ˆå¤šæµ‹ä¸åˆ°çš„ï¼Œæˆ–è€…åªèƒ½æµ‹åˆ°å‡ æ¡åºåˆ—çš„ï¼Œå°±æœ‰Chao1å’ŒACEæŒ‡æ•°æ¥è€ƒè™‘è¿™äº›éå¸¸ä½çš„ç‰©ç§ï¼‰ ç”¨ä¿¡æ¯å…¬ç¤ºè¡¨ç¤ºï¼ˆå¸¸ç”¨çš„shannon-wieneræŒ‡æ•°å°±åœ¨è¿™é‡Œï¼‰ å‡ä¸€æ€§è¡¨ç¤º Taxa Î² diversity betaå¤šæ ·æ€§çš„ä¸‰ä¸ªå¸¸ç”¨çš„ç®€å•æŒ‡æ ‡ï¼š åŸºäºç›¸å¼‚ç³»æ•°è¿›è¡Œè®¡ç®—ï¼š è¿™é‡Œæ”¶é›†äº†ç›®å‰ä¼šç”¨åˆ°çš„å„ç§è·ç¦»çš„ç®—æ³•ï¼Œæ¯”å¦‚æˆ‘ä»¬å¸¸ç”¨çš„æ¬§å¼è·ç¦»ï¼Œè¿˜æœ‰è¿™ä¸ªbrayè·ç¦»ç­‰ï¼Œè¿™æ ·ç®—å‡ºæ¥å°±æ˜¯ä¸€ä¸ªè·ç¦»çŸ©é˜µï¼Œæˆ‘ä»¬å¯ä»¥çŸ¥é“å“ªäº›æ ·æ–¹ä¹‹é—´å·®å¼‚å¤§æˆ–è€…å·®å¼‚å° Taxa Î³ diversity gammaå¤šæ ·æ€§ï¼Œæ²¿ç€é•¿æ±Ÿå–æ ·æ¥ä¸¾ä¸ªä¾‹å­ï¼Œå›¾ä¸­æ¯ä¸ªå–æ ·ç‚¹æœ¬èº«çš„å¾®ç”Ÿç‰©å¤šæ ·æ€§æ˜¯Î±-å¤šæ ·æ€§ï¼ˆå•ä¸ªç¾¤è½æ°´å¹³ï¼‰ï¼›å°†1ï½9è¿™ä¹ä¸ªæ ·ç‚¹å½’ä¸ºä¸€ç»„ï¼Œåˆ™è¿™ä¸€ç»„å†…å„æ ·ç‚¹ä¹‹é—´çš„å·®å¼‚ï¼Œå¯ä»¥ç†è§£ä¸ºÎ²-å¤šæ ·æ€§ï¼ˆå±€éƒ¨æˆ–è€…åŒºåŸŸæ°´å¹³ï¼‰ï¼›å½“æˆ‘ä»¬æŠŠæ‰€æœ‰å–æ ·ç‚¹æ”¾åœ¨ä¸€èµ·ï¼Œç«™åœ¨ä¸€ä¸ªæ›´é«˜ã€æ›´å¹¿é˜”çš„å°ºåº¦ä¸Šæ—¶ï¼Œè¿™æ—¶å€™çš„å¤šæ ·æ€§å°±æ˜¯æ‰€è°“çš„Î³-å¤šæ ·æ€§ã€‚è¿™ä¸ªæŒ‡æ ‡å°±æ˜¯Î±-å¤šæ ·æ€§åœ¨å°ºåº¦ä¸Šçš„ä¸€ä¸ªæ¨å¹¿ã€‚\nä¸€ä¸ªä¾‹å­æ€»ç»“ä¸‰ä¸ªå°ºåº¦ä¸Šçš„ç‰©ç§å¤šæ ·æ€§ï¼š\nä¸‰ä¸ªç”Ÿæ€åŒºä¹åº§å±±å³°çš„ç”Ÿç‰©å¤šæ ·æ€§æŒ‡æ•°ã€‚æ¯ä¸ªç¬¦å·ä»£è¡¨ä¸åŒçš„ç‰©ç§ï¼›æœ‰äº›ç‰©ç§åªåœ¨ä¸€ä¸ªå³°ä¸Šæœ‰ç§ç¾¤ï¼Œè€Œå¦ä¸€äº›åˆ™åœ¨ä¸¤ä¸ªæˆ–æ›´å¤šå³°ä¸Šã€‚æ¯ä¸ªå³°ä¸Šç‰©ç§ä¸°å¯Œåº¦çš„å˜åŒ–å¯¼è‡´æ¯ä¸ªç”Ÿæ€åŒºçš„ä¸åŒ alphaã€gamma å’Œ beta å¤šæ ·æ€§å€¼ã€‚\nè¿™ç§å˜åŒ–å¯¹æˆ‘ä»¬å¦‚ä½•åˆ†é…æœ‰é™çš„èµ„æºä»¥æœ€å¤§é™åº¦åœ°ä¿æŠ¤èµ„æºæœ‰å½±å“ã€‚å¦‚æœåªèƒ½ä¿æŠ¤ä¸€ä¸ªç”Ÿæ€åŒºï¼Œç”Ÿæ€åŒº 3å¯èƒ½æ˜¯ä¸€ä¸ªä¸é”™çš„é€‰æ‹©ï¼Œå› ä¸ºå®ƒå…·æœ‰é«˜ä¼½é©¬ï¼ˆæ€»ï¼‰å¤šæ ·æ€§ã€‚ä½†æ˜¯ï¼Œå¦‚æœåªèƒ½ä¿æŠ¤ä¸€ä¸ªå±±å³°ï¼Œæ˜¯å¦åº”è¯¥ä¿æŠ¤ç”Ÿæ€åŒº 1ï¼ˆæœ‰è®¸å¤šåˆ†å¸ƒå¹¿æ³›çš„ç‰©ç§ï¼‰æˆ–ç”Ÿæ€åŒº3ï¼ˆæœ‰å‡ ä¸ªç‹¬ç‰¹çš„ã€èŒƒå›´å—é™çš„ç‰©ç§ï¼‰ä¸­çš„å±±å³°ï¼Ÿ\nPhylogenetic Î± diversity ç¾¤è½ç³»ç»Ÿå‘è‚²å¤šæ ·æ€§PDï¼šè°±ç³»æ ‘çš„æ€»æé•¿åº¦ å‡€ç›¸å…³æŒ‡æ•°NRIï¼š è®¡ç®—æ‰€æœ‰ç‰©ç§å¯¹çš„å¹³å‡è°±ç³»è·ç¦»MPDï¼Œä¿æŒç‰©ç§æ•°é‡å’Œä¸ªä½“æ•°ä¸å˜ æœ€è¿‘é‚»ä½“æŒ‡æ•°NTIï¼š è®¡ç®—æ‰€æœ‰ç‰©ç§å¯¹çš„å¹³å‡è°±ç³»è·ç¦»MNPDï¼Œä¿æŒç‰©ç§æ•°é‡å’Œä¸ªä½“æ•°ä¸å˜ å¯ä»¥çœ‹ä¸Šå›¾å³è¾¹çš„ä¾‹å­ï¼Œ3ä¸ªæ ·æ–¹å‘ç°çš„å››ç§ç‰©ç§ä¸°åº¦è¡¨ï¼Œæˆ‘ä»¬ç¡®å®šäº†ä»–ä»¬çš„ç³»ç»Ÿå‘è‚²å…³ç³»å°±å¯ä»¥è¿›è¡Œè®¡ç®—ã€‚\nPhylogenetic Î² diversity Betaçš„è®¡ç®—ä¼šç¨å¾®å¤æ‚ä¸€ç‚¹ï¼Œå…¬å¼æ²¡æœ‰ä¸€ä¸ªä¸ªåˆ—å‡ºï¼Œä½†æ˜¯æœ‰ç›¸å…³çš„RåŒ…è¿›è¡Œè®¡ç®—ï¼ˆveganï¼‰ã€‚\nFunctional diversity æœ€åå°±æ˜¯åŠŸèƒ½å¤šæ ·æ€§æŒ‡æ•°ï¼Œä»–æ˜¯å½±å“ç§ç¾¤ç”Ÿå­˜ã€ç¾¤è½å’Œç”Ÿæ€ç³»ç»Ÿç¨³å®šçš„é‡è¦å› ç´ ï¼Œ èƒ½æ›´å¥½åœ°åæ˜ ç”Ÿæ€ç³»ç»Ÿç”Ÿäº§ã€å…»åˆ†å¹³è¡¡ç­‰åŠŸèƒ½ã€‚\nè¿™ä¸ªæ€ä¹ˆè®¡ç®—å‘¢ï¼Œè¦æ”¶é›†å¥½ç‰©ç§çš„åŠŸèƒ½ç±»å‹ï¼Œæ¯”å¦‚å¯¹äºæ¤ç‰©æ¥è¯´ï¼Œæœ‰å…‰å’Œé€”å¾„ç­‰ç­‰ï¼Œä¹ŸåŒæ ·æ•´ç†ä¸ºåŠŸèƒ½è¡¨ï¼ŒåŠŸèƒ½è¡¨å’Œç‰©ç§ä¸°åº¦è¡¨mappingåˆå¹¶ä¸€ä¸‹å¯ä»¥å¾—åˆ°åŠŸèƒ½ä¸°åº¦è¡¨ï¼Œç„¶åå°±å¯ä»¥è®¡ç®—å„ç§æŒ‡æ•°äº†ã€‚\nAnalytical methods æˆ‘ä»¬åº”è¯¥æ€ä¹ˆåšæ•°æ®åˆ†æå‘¢ï¼Ÿï¼ˆå…·ä½“çš„æµç¨‹å’Œä»£ç ä¸‹æ¬¡åˆ†äº«ï¼Œè¿™é‡Œå…ˆç®€å•æè¿°ä¸€ä¸‹ï¼‰\né¦–å…ˆæ‹¿åˆ°ä¸°åº¦è¡¨ï¼Œå¯ä»¥å¯¹æ•´ä¸ªè¡¨è¿›è¡Œé‡é‡‡æ ·ï¼Œæ¯æ¬¡é‡‡æ ·è®¡ç®—ä¸€æ¬¡aå¤šæ ·æ€§æŒ‡æ•°ï¼Œå°±å¯ä»¥åšå‡ºè¿™ä¸ªç¨€é‡Šæ›²çº¿ï¼Œä»–å¯ä»¥è¯´æ˜æˆ‘ä»¬åœ¨è¿™ä¸ªæ ·æ–¹é‡Œçš„è°ƒæŸ¥æˆ–è€…è¯´æµ‹åºæ‰‹æ®µæ˜¯å¦æ˜¯å……è¶³çš„ã€‚\nç„¶åæ˜¯è®¡ç®—æ¯ä¸ªæ ·æ–¹çš„aå¤šæ ·æ€§æŒ‡æ•°ï¼Œ é€šè¿‡ç»“åˆç¯å¢ƒå› å­æ•°æ®ï¼Œæˆ‘ä»¬å¯ä»¥åšç»„é—´å¤šé‡æ¯”è¾ƒï¼Œæ¯”å¦‚è¯´ å¯¹äºä¸€äº›æ•°å€¼æ•°æ®ï¼Œæˆ‘ä»¬å¯ä»¥è®¡ç®—ç›¸å…³æ€§ï¼Œæˆ–è€…åšå›å½’åˆ†æã€‚ è¿™ä¸ªå›å½’åˆåˆ†ä¸ºå¾ˆå¤šæ–¹å¼ï¼Œæ¯”å¦‚çº¿æ€§å›å½’ï¼Œå¹¿ä¹‰çº¿æ€§å›å½’ç­‰ç­‰ï¼Œè¿™ä¸ªå¯ä»¥å¸®æˆ‘ä»¬å‘ç°é‚£äº›å› ç´ ä¼šä»¥æ€æ ·çš„æ–¹å¼å½±å“aå¤šæ ·æ€§ï¼Œæ¯”å¦‚è¿™é‡Œï¼Œå¯èƒ½æµ·æ‹”è¶Šé«˜å¤šæ ·æ€§è¶Šä½ã€‚\nå¯¹äºbetaå¤šæ ·æ€§ï¼Œæˆ‘ä»¬é¦–å…ˆè®¡ç®—ç›¸å¼‚çŸ©é˜µï¼Œè¿™é‡Œå°±æ˜¯æ ·æœ¬ä¸æ ·æœ¬é—´çš„è·ç¦» æˆ‘ä»¬å¯ä»¥åšçƒ­å›¾å±•ç¤ºå„æ ·æœ¬é—´çš„è·ç¦»ï¼Œ æˆ–è€…åšä¸€ä¸ªç›¸ä¼¼ç³»æ•°-åœ°ç†è·ç¦»çš„å›å½’åˆ†æï¼Œä¸€èˆ¬æ¥è¯´ï¼Œåœ°ç†è·ç¦»è¶Šè¿œï¼Œå¯èƒ½betaå¤šæ ·æ€§è¶Šé«˜ã€‚\næˆ–è€…å…·ä½“çœ‹çœ‹ç»„é—´å·®å¼‚ï¼Œè¿™é‡Œå¯ä»¥çœ‹åˆ°KO_OEç»„betaå¤šæ ·æ€§æœ€å¤§ï¼Œ è¿˜èƒ½åšèšç±»åˆ†æï¼Œçœ‹çœ‹åˆ°åº•å“ªäº›æ ·æœ¬æ›´åŠ ç±»ä¼¼ã€‚\nBetaå¤šæ ·æ€§çš„å¦ä¸€ç§å±•ç¤ºæ–¹æ³•æ˜¯æ’åºæ–¹æ³•ï¼Œä¹Ÿå«é™ç»´åˆ†æï¼Œæˆ‘ä»¬å¸¸ç”¨çš„æ–¹æ³•æœ‰PCAï¼ŒPcoAç­‰ç­‰ï¼Œ å¦å¤–å¯ä»¥åŠ ä¸Šç¯å¢ƒå› å­æ•°æ®ï¼Œåšçº¦æŸæ’åºï¼Œæ¯”å¦‚RDAï¼ŒCCAç­‰æ–¹æ³•ï¼Œä¸ä»…èƒ½çœ‹åˆ°æ ·æœ¬é—´çš„å·®å¼‚ï¼Œè¿˜å¯ä»¥çœ‹åˆ°è¿™ç§å·®å¼‚ä¸»è¦æ˜¯ç”±é‚£ç§ç¯å¢ƒå› å­å½±å“çš„ï¼Œæ¯”å¦‚è¿™é‡Œï¼Œåœ¨è½´ä¸€ä¸Šçš„å·®å¼‚ä¸»è¦æ˜¯ç”±env1è¿™ä¸ªå˜é‡å¼•èµ·çš„ã€‚\nTheories ç‰©ç§å¤šæ ·æ€§çš„ä¸­æ€§ç†è®ºåšå‡ºäº†ä¸€ä¸ªå…·æœ‰æŒ‘æˆ˜æ€§çš„å‡è®¾ï¼Œå³æ‰€æœ‰ä¸ªä½“åœ¨ç”Ÿæ€ä¸Šéƒ½æ˜¯ç›¸åŒçš„ï¼Œå¹¶ä¸”ä¸éœ€è¦ç”Ÿæ€ä½å·®å¼‚æ¥è§£é‡Šç”Ÿç‰©å¤šæ ·æ€§æ¨¡å¼ã€‚ æ ¹æ®ä¸­æ€§ç†è®ºï¼Œç­‰åŒç‰©ç§çš„é«˜åº¦å¤šæ ·åŒ–ç¾¤è½çš„å‡ºç°æ˜¯å› ä¸ºå¶ç„¶çš„ç­ç»è¢«ç‰©ç§å½¢æˆæ‰€å¹³è¡¡ã€‚å…·ä½“æ¥è¯´ï¼Œé€‚åº”æ€§ç­‰ä»·å‡è®¾ä¸éšæœºæˆ–éšæœºè¿‡ç¨‹ç›¸ç»“åˆï¼ŒåŒ…æ‹¬æ­»äº¡ã€æ¥è‡ªåŒºåŸŸç‰©ç§åº“çš„ç§»æ°‘å’Œç‰©ç§å½¢æˆï¼Œå¯ä»¥å¯¼è‡´ç‰©ç§ä¸°å¯Œçš„ç§ç¾¤ã€‚ï¼ˆæœ‰å…³ç”Ÿæ€ä½å’Œä¸­æ€§ä½œç”¨å¯¹å¤šæ ·æ€§å½±å“ï¼Œä¸“é—¨æœ‰ç ”ç©¶è¿™ç§ç¾¤è½æ„å»ºçš„ï¼‰\nReferences ","date":"2023-04-01T00:00:00Z","image":"/p/biodiversity/images/diversity_hu497d07d6085df17c480b385e6cae73d8_591092_120x120_fill_box_smart1_3.png","permalink":"/p/biodiversity/","title":"ç‰©ç§å¤šæ ·æ€§ç ”ç©¶çš„ç†è®ºå’Œæ–¹æ³•"},{"content":"Introduction Shiny æ˜¯ä¸€ä¸ª R åŒ…ï¼Œå¯è½»æ¾åœ°ç›´æ¥ä» R æ„å»ºäº¤äº’å¼ Web åº”ç”¨ç¨‹åºã€‚è¿˜å¯ä»¥åœ¨ç½‘é¡µä¸Šæ‰˜ç®¡ç‹¬ç«‹åº”ç”¨ç¨‹åºæˆ–å°†å®ƒä»¬åµŒå…¥ R Markdown æ–‡æ¡£æˆ–æ„å»ºä»ªè¡¨æ¿ï¼Œè¿˜å¯ä»¥ä½¿ç”¨ CSS ä¸»é¢˜ã€html å°éƒ¨ä»¶å’Œ JavaScript æ“ä½œæ‰©å±•æ‚¨çš„ Shiny åº”ç”¨ç¨‹åºã€‚\n1 2 3 4 5 6 7 8 #first app library(shiny) ui \u0026lt;- fluidPage( \u0026#34;Hello, world!\u0026#34; ) server \u0026lt;- function(input, output, session) { } shinyApp(ui, server) æ•´ä¸ªappå¯åˆ†ä¸ºä¸¤ä¸ªéƒ¨åˆ†ï¼Œuiä¸severï¼Œå¯ä»¥è®¤ä¸ºæ˜¯å‰ç«¯ä¸åç«¯çš„å…³ç³»ï¼ŒRshinyæä¾›äº†å¾ˆå¤šå†…ç½®çš„å°ç»„ä»¶å¸®æˆ‘ä»¬å°†å‰åç«¯è”ç³»èµ·æ¥ï¼Œéå¸¸æ–¹ä¾¿å¥½ç”¨ã€‚åªéœ€è¦æœ‰ä¸€ç‚¹ç‚¹çš„HTML/CSS/Javascriptçš„çŸ¥è¯†å°±å¯ä»¥è®¾è®¡å‡ºæ›´å¥½çœ‹çš„ç•Œé¢å’Œæ›´å¤šæœ‰è¶£çš„äº¤äº’ã€‚\nè¿™é‡Œæ˜¯shinyçš„è®°å¿†æ‰‹å†Œ,æµ“ç¼©äº†å¤§éƒ¨åˆ†çš„æ“ä½œã€‚ Methods UIè®¾è®¡ Layout æœ€åŸºç¡€çš„å¸ƒå±€å°±æ˜¯sidebarLayout,å¯ä»¥åˆ†æˆsidebarPanel,mainPanelä¸¤ä¸ªéƒ¨åˆ†ã€‚\n1 2 3 4 5 6 7 8 ui \u0026lt;- fluidPage( titlePanel(\u0026#34;title panel\u0026#34;), sidebarLayout( sidebarPanel(\u0026#34;sidebar panel\u0026#34;), mainPanel(\u0026#34;main panel\u0026#34;) ) ) å¯ä»¥é€šè¿‡å°†å†…å®¹æ”¾åœ¨ *Panel å‡½æ•°ä¸­æ¥å‘Shiny åº”ç”¨ç¨‹åºæ·»åŠ å†…å®¹ï¼Œshinyæä¾›äº†Rä»£ç æ–¹ä¾¿æ’å…¥HTML (Table 1)ï¼Œæ›´å¤šæ ‡ç­¾å¯ä»¥æŸ¥çœ‹tag-glossaryã€‚\nTable 1: shiny function\tHTML5 equivalent\tcreates shiny function HTML5 equivalent creates p \u0026lt;p\u0026gt; A paragraph of text h1 \u0026lt;h1\u0026gt; A first level header h2 \u0026lt;h2\u0026gt; A second level header h3 \u0026lt;h3\u0026gt; A third level header h4 \u0026lt;h4\u0026gt; A fourth level header h5 \u0026lt;h5\u0026gt; A fifth level header h6 \u0026lt;h6\u0026gt; A sixth level header a \u0026lt;a\u0026gt; A hyper link br \u0026lt;br\u0026gt; A line break (e.g. a blank line) div \u0026lt;div\u0026gt; A division of text with a uniform style span \u0026lt;span\u0026gt; An in-line division of text with a uniform style pre \u0026lt;pre\u0026gt; Text â€˜as isâ€™ in a fixed width font code \u0026lt;code\u0026gt; A formatted block of code img \u0026lt;img\u0026gt; An image strong \u0026lt;strong\u0026gt; Bold text em \u0026lt;em\u0026gt; Italicized text HTML NA Directly passes a character string as HTML code Control widgets è¿™äº›æ˜¯å¸¸ç”¨shinyå†…ç½®çš„å°æ§ä»¶ï¼Œæä¾›ä¸€ç§å‘ Shiny serveå‘é€æ¶ˆæ¯çš„æ–¹å¼ã€‚ Table 2: standard Shiny widgets function widget actionButton Action Button checkboxGroupInput A group of check boxes checkboxInput A single check box dateInput A calendar to aid date selection dateRangeInput A pair of calendars for selecting a date range fileInput A file upload control wizard helpText Help text that can be added to an input form numericInput A field to enter numbers radioButtons A set of radio buttons selectInput A box with choices to select from sliderInput A slider bar submitButton A submit button textInput A field to enter text å¯ä»¥æƒ³æƒ³æ€ä¹ˆè·å–æ›´å¤šæ§ä»¶ï¼Œæ¯”å¦‚ä¸€ä¸ªcolor panelç­‰ç­‰ã€‚\næ›´å¤šï¼š\nä½¿ç”¨ textInput() æ”¶é›†å°‘é‡æ–‡æœ¬ï¼Œä½¿ç”¨ passwordInput()3 æ”¶é›†å¯†ç ï¼Œä½¿ç”¨ textAreaInput() æ”¶é›†æ–‡æœ¬æ®µè½ã€‚\nè¦æ”¶é›†æ•°å€¼ï¼Œè¯·ä½¿ç”¨ numericInput() åˆ›å»ºä¸€ä¸ªå—çº¦æŸçš„æ–‡æœ¬æ¡†æˆ–ä½¿ç”¨ sliderInput() åˆ›å»ºä¸€ä¸ªæ»‘å—ã€‚å¦‚æœæ‚¨ä¸º sliderInput() çš„é»˜è®¤å€¼æä¾›ä¸€ä¸ªé•¿åº¦ä¸º 2 çš„æ•°å€¼å‘é‡ï¼Œæ‚¨å°†å¾—åˆ°ä¸€ä¸ªå…·æœ‰ä¸¤ç«¯çš„â€œèŒƒå›´â€æ»‘å—ã€‚\nä½¿ç”¨ dateInput() æ”¶é›†ä¸€å¤©æˆ–ä½¿ç”¨ dateRangeInput() æ”¶é›†ä¸¤å¤©çš„èŒƒå›´ã€‚è¿™äº›æä¾›äº†ä¸€ä¸ªæ–¹ä¾¿çš„æ—¥å†é€‰æ‹©å™¨ï¼Œå¹¶ä¸”è¯¸å¦‚ datesdisabled å’Œ daysofweekdisabled ä¹‹ç±»çš„é™„åŠ å‚æ•°å…è®¸æ‚¨é™åˆ¶æœ‰æ•ˆè¾“å…¥çš„é›†åˆã€‚\næœ‰ä¸¤ç§ä¸åŒçš„æ–¹æ³•å…è®¸ç”¨æˆ·ä»ä¸€ç»„é¢„å…ˆæŒ‡å®šçš„é€‰é¡¹ä¸­è¿›è¡Œé€‰æ‹©ï¼šselectInput()(è¿˜å¯ä»¥è®¾ç½® multiple = TRUE ä»¥å…è®¸ç”¨æˆ·é€‰æ‹©å¤šä¸ªå…ƒç´ )å’Œ radioButtons(); å¯ä»¥ä½¿ç”¨checkboxGroupInput()å½¢æˆå¤šé€‰ã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 ui \u0026lt;- fluidPage( textInput(\u0026#34;name\u0026#34;, \u0026#34;What\u0026#39;s your name?\u0026#34;), passwordInput(\u0026#34;password\u0026#34;, \u0026#34;What\u0026#39;s your password?\u0026#34;), textAreaInput(\u0026#34;story\u0026#34;, \u0026#34;Tell me about yourself\u0026#34;, rows = 3) ) ui \u0026lt;- fluidPage( numericInput(\u0026#34;num\u0026#34;, \u0026#34;Number one\u0026#34;, value = 0, min = 0, max = 100), sliderInput(\u0026#34;num2\u0026#34;, \u0026#34;Number two\u0026#34;, value = 50, min = 0, max = 100), sliderInput(\u0026#34;rng\u0026#34;, \u0026#34;Range\u0026#34;, value = c(10, 20), min = 0, max = 100) ) ui \u0026lt;- fluidPage( dateInput(\u0026#34;dob\u0026#34;, \u0026#34;When were you born?\u0026#34;), dateRangeInput(\u0026#34;holiday\u0026#34;, \u0026#34;When do you want to go on vacation next?\u0026#34;) ) animals \u0026lt;- c(\u0026#34;dog\u0026#34;, \u0026#34;cat\u0026#34;, \u0026#34;mouse\u0026#34;, \u0026#34;bird\u0026#34;, \u0026#34;other\u0026#34;, \u0026#34;I hate animals\u0026#34;) ui \u0026lt;- fluidPage( selectInput(\u0026#34;state\u0026#34;, \u0026#34;What\u0026#39;s your favourite state?\u0026#34;, state.name), radioButtons(\u0026#34;animal\u0026#34;, \u0026#34;What\u0026#39;s your favourite animal?\u0026#34;, animals), checkboxGroupInput(\u0026#34;animal\u0026#34;, \u0026#34;What animals do you like?\u0026#34;, animals) ) è®©ç”¨æˆ·ä½¿ç”¨ actionButton() æˆ– actionLink() æ‰§è¡Œæ“ä½œï¼Œå¯ä»¥ä½¿ç”¨â€œbtn-primaryâ€ã€â€œbtn-successâ€ã€â€œbtn-infoâ€ã€â€œbtn-warningâ€æˆ–â€œbtn-dangerâ€ä¹‹ä¸€ä½¿ç”¨ç±»å‚æ•°è‡ªå®šä¹‰å¤–è§‚ï¼Œä½¿ç”¨â€œbtn-lgâ€ã€â€œbtn-smâ€ã€â€œbtn-xsâ€æ›´æ”¹å¤§å°ï¼Œå¯ä»¥ä½¿ç”¨â€œbtn-blockâ€ä½¿æŒ‰é’®è·¨è¶Šå®ƒä»¬åµŒå…¥çš„å…ƒç´ çš„æ•´ä¸ªå®½åº¦ã€‚\n1 2 3 4 5 6 7 8 9 ui \u0026lt;- fluidPage( fluidRow( actionButton(\u0026#34;click\u0026#34;, \u0026#34;Click me!\u0026#34;, class = \u0026#34;btn-danger\u0026#34;), actionButton(\u0026#34;drink\u0026#34;, \u0026#34;Drink me!\u0026#34;, class = \u0026#34;btn-lg btn-success\u0026#34;) ), fluidRow( actionButton(\u0026#34;eat\u0026#34;, \u0026#34;Eat me!\u0026#34;, class = \u0026#34;btn-block\u0026#34;) ) ) è¿æ¥sever general æ·»åŠ è¾“å‡ºå¯¹è±¡åœ¨uiä¸­ Shiny æä¾›äº†ä¸€ç³»åˆ—å‡½æ•°ï¼Œå¯ä»¥å°† R å¯¹è±¡è½¬æ¢ä¸ºç”¨æˆ·ç•Œé¢çš„è¾“å‡ºã€‚æ¯ä¸ªå‡½æ•°åˆ›å»ºç‰¹å®šç±»å‹çš„è¾“å‡ºã€‚\nTable 3: output R objects family Output function Creates dataTableOutput DataTable htmlOutput raw HTML imageOutput image plotOutput plot tableOutput table textOutput text uiOutput raw HTML verbatimTextOutput text ç¼–å†™æ„å»ºRå¯¹è±¡çš„ä»£ç åœ¨serveä¸­ Table 4: render R objects family render function creates renderDataTable DataTable renderImage images (saved as a link to a source file) renderPlot plots renderPrint any printed output renderTable data frame, matrix, other table like structures renderText character strings renderUI a Shiny tag object or HTML ä½¿ç”¨inputï¼Œoutputè¿æ¥ ä»¥ä¸‹ä»£ç å°±å¯ä»¥å°†selectInputé€‰æ‹©çš„å€¼varé€šè¿‡input$varçš„å½¢å¼ä¼ é€’åˆ°renderText()ï¼Œå†renderæˆoutput$selected_varçš„å½¢å¼ï¼Œæœ€åé€šè¿‡textOutput()è¾“å‡ºåˆ°uiç•Œé¢ã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 library(shiny) ui \u0026lt;- fluidPage( titlePanel(\u0026#34;censusVis\u0026#34;), sidebarLayout( sidebarPanel( selectInput(\u0026#34;var\u0026#34;, label = \u0026#34;Choose a variable to display\u0026#34;, choices = c(\u0026#34;Percent White\u0026#34;, \u0026#34;Percent Black\u0026#34;, \u0026#34;Percent Hispanic\u0026#34;, \u0026#34;Percent Asian\u0026#34;), selected = \u0026#34;Percent White\u0026#34;) ), mainPanel( textOutput(\u0026#34;selected_var\u0026#34;) ) ) ) server \u0026lt;- function(input, output) { output$selected_var \u0026lt;- renderText({ paste(\u0026#34;You have selected\u0026#34;, input$var) }) } shinyApp(ui, server) æ›´å¤šï¼š\nä½¿ç”¨ textOutput() è¾“å‡ºå¸¸è§„æ–‡æœ¬ï¼Œä½¿ç”¨ verbatimTextOutput() è¾“å‡ºå›ºå®šä»£ç å’Œæ§åˆ¶å°è¾“å‡ºã€‚ renderText() å°†ç»“æœç»„åˆæˆä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œé€šå¸¸ä¸ textOutput() é…å¯¹ renderPrint() æ‰“å°ç»“æœï¼Œå°±åƒæ‚¨åœ¨ R æ§åˆ¶å°ä¸­ä¸€æ ·ï¼Œå¹¶ä¸”é€šå¸¸ä¸ verbatimTextOutput() é…å¯¹ã€‚\ntableOutput() å’Œ renderTable() å‘ˆç°é™æ€æ•°æ®è¡¨ï¼ŒåŒæ—¶æ˜¾ç¤ºæ‰€æœ‰æ•°æ®ã€‚ dataTableOutput() å’Œ renderDataTable() å‘ˆç°ä¸€ä¸ªåŠ¨æ€è¡¨ï¼Œæ˜¾ç¤ºå›ºå®šæ•°é‡çš„è¡Œä»¥åŠç”¨äºæ›´æ”¹å“ªäº›è¡Œå¯è§çš„æ§ä»¶ã€‚ tableOutput() å¯¹äºå°å‹ã€å›ºå®šçš„æ‘˜è¦ï¼ˆä¾‹å¦‚æ¨¡å‹ç³»æ•°ï¼‰æœ€æœ‰ç”¨ï¼›å¦‚æœæ‚¨æƒ³å‘ç”¨æˆ·å…¬å¼€å®Œæ•´çš„æ•°æ®æ¡†ï¼Œåˆ™ dataTableOutput() æ˜¯æœ€åˆé€‚çš„ã€‚\né»˜è®¤æƒ…å†µä¸‹ï¼ŒplotOutput() å°†å æ®å…¶å®¹å™¨çš„æ•´ä¸ªå®½åº¦ï¼ˆç¨åä¼šè¯¦ç»†ä»‹ç»ï¼‰ï¼Œå¹¶ä¸”é«˜åº¦ä¸º 400 åƒç´ ã€‚æ‚¨å¯ä»¥ä½¿ç”¨é«˜åº¦å’Œå®½åº¦å‚æ•°è¦†ç›–è¿™äº›é»˜è®¤å€¼ã€‚æˆ‘ä»¬å»ºè®®å§‹ç»ˆè®¾ç½® res = 96ï¼Œå› ä¸ºè¿™å°†ä½¿æ‚¨çš„ Shiny å›¾ä¸æ‚¨åœ¨ RStudio ä¸­çœ‹åˆ°çš„å°½å¯èƒ½æ¥è¿‘ã€‚\nreactive expressions This difference between commands and recipes is one of the key differences between two important styles of programming:\nIn imperative programming, you issue a specific command and itâ€™s carried out immediately. This is the style of programming youâ€™re used to in your analysis scripts: you command R to load your data, transform it, visualise it, and save the results to disk.\nIn declarative programming, you express higher-level goals or describe important constraints, and rely on someone else to decide how and/or when to translate that into action. This is the style of programming you use in Shiny.\nShiny ä¸­å£°æ˜å¼ç¼–ç¨‹çš„ä¼˜åŠ¿ä¹‹ä¸€æ˜¯å®ƒå…è®¸åº”ç”¨ç¨‹åºéå¸¸æ‡’æƒ°ã€‚ Shiny åº”ç”¨ç¨‹åºåªä¼šæ‰§è¡Œæ›´æ–°æ‚¨å½“å‰å¯ä»¥çœ‹åˆ°çš„è¾“å‡ºæ§ä»¶æ‰€éœ€çš„æœ€å°‘å·¥ä½œé‡ï¼Œä¼˜ç‚¹æ˜¯å¿«é€Ÿï¼Œç¼ºç‚¹æ˜¯å¦‚æœä½ ä¸è¿è¡Œæ‰€æœ‰ä»£ç ï¼Œå¯èƒ½ä¸ä¼šå‘ç°é”™è¯¯ã€‚\nååº”å¼è¡¨è¾¾å¼æ¯”å¸¸è§„ R å‡½æ•°æ›´èªæ˜ã€‚å®ƒä»¬ç¼“å­˜å€¼å¹¶çŸ¥é“å®ƒä»¬çš„å€¼ä½•æ—¶ä¼šå˜ã€‚ç¬¬ä¸€æ¬¡è¿è¡Œååº”å¼è¡¨è¾¾å¼æ—¶ï¼Œè¡¨è¾¾å¼ä¼šå°†å…¶ç»“æœä¿å­˜åœ¨è®¡ç®—æœºçš„å†…å­˜ä¸­ã€‚ä¸‹æ¬¡è°ƒç”¨ååº”å¼è¡¨è¾¾å¼æ—¶ï¼Œå®ƒå¯ä»¥è¿”å›ä¿å­˜çš„ç»“æœè€Œä¸è¿›è¡Œä»»ä½•è®¡ç®—ï¼ˆè¿™å°†ä½¿æ‚¨çš„åº”ç”¨ç¨‹åºæ›´å¿«ï¼‰ã€‚\nå¦‚æœååº”å¼è¡¨è¾¾å¼çŸ¥é“ç»“æœæ˜¯æœ€æ–°çš„ï¼Œå®ƒåªä¼šè¿”å›ä¿å­˜çš„ç»“æœã€‚å¦‚æœååº”å¼è¡¨è¾¾å¼å¾—çŸ¥ç»“æœå·²è¿‡æ—¶ï¼ˆå› ä¸ºå°éƒ¨ä»¶å·²æ›´æ”¹ï¼‰ï¼Œåˆ™è¡¨è¾¾å¼å°†é‡æ–°è®¡ç®—ç»“æœã€‚ç„¶åå®ƒè¿”å›æ–°ç»“æœå¹¶ä¿å­˜ä¸€ä¸ªæ–°å‰¯æœ¬ã€‚ååº”å¼è¡¨è¾¾å¼å°†ä½¿ç”¨è¿™ä¸ªæ–°å‰¯æœ¬ï¼Œç›´åˆ°å®ƒä¹Ÿå˜å¾—è¿‡æ—¶ä¸ºæ­¢ã€‚ è®©æˆ‘ä»¬æ€»ç»“ä¸€ä¸‹è¿™ç§è¡Œä¸ºï¼š\nååº”å¼è¡¨è¾¾å¼ä¼šåœ¨æ‚¨ç¬¬ä¸€æ¬¡è¿è¡Œæ—¶ä¿å­˜å…¶ç»“æœã€‚\nä¸‹æ¬¡è°ƒç”¨ååº”å¼è¡¨è¾¾å¼æ—¶ï¼Œå®ƒä¼šæ£€æŸ¥ä¿å­˜çš„å€¼æ˜¯å¦å·²è¿‡æ—¶ï¼ˆå³ï¼Œå®ƒæ‰€ä¾èµ–çš„å°éƒ¨ä»¶æ˜¯å¦å·²æ›´æ”¹ï¼‰ã€‚\nå¦‚æœè¯¥å€¼å·²è¿‡æœŸï¼Œååº”å¯¹è±¡å°†é‡æ–°è®¡ç®—å®ƒï¼ˆç„¶åä¿å­˜æ–°ç»“æœï¼‰ã€‚\nå¦‚æœè¯¥å€¼æ˜¯æœ€æ–°çš„ï¼Œååº”å¼è¡¨è¾¾å¼å°†è¿”å›ä¿å­˜çš„å€¼è€Œä¸è¿›è¡Œä»»ä½•è®¡ç®—ã€‚\nå»ºè®®æŠŠæ–‡ä»¶å¯¼å…¥ç­‰ä¸éœ€è¦æ¯æ¬¡æ›´æ–°çš„ä»£ç æ”¾åœ¨reactiveé‡Œã€‚\nåœ¨ Shiny ä¸­ï¼Œåº”è¯¥è€ƒè™‘ä¸€ä¸ªè§„åˆ™ï¼šæ¯å½“å¤åˆ¶å’Œç²˜è´´ä¸€æ¬¡ä¸œè¥¿æ—¶ï¼Œå°±åº”è¯¥è€ƒè™‘å°†é‡å¤çš„ä»£ç æå–åˆ°ä¸€ä¸ªååº”è¡¨è¾¾å¼ä¸­ï¼Œå› ä¸ºååº”å¼è¡¨è¾¾å¼ä¸ä»…è®©äººç±»æ›´å®¹æ˜“ç†è§£ä»£ç ï¼Œå®ƒä»¬è¿˜æé«˜äº† Shiny é«˜æ•ˆé‡æ–°è¿è¡Œä»£ç çš„èƒ½åŠ›ã€‚\nè€ƒè™‘ä»¥ä¸‹ä»£ç ï¼Œreactive()ç¡®ä¿åªæœ‰åœ¨æ”¹å˜næˆ–lambdaæ—¶æ‰ä¼šé‡æ–°è®¡ç®—ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 library(ggplot2) freqpoly \u0026lt;- function(x1, x2, binwidth = 0.1, xlim = c(-3, 3)) { df \u0026lt;- data.frame( x = c(x1, x2), g = c(rep(\u0026#34;x1\u0026#34;, length(x1)), rep(\u0026#34;x2\u0026#34;, length(x2))) ) ggplot(df, aes(x, colour = g)) + geom_freqpoly(binwidth = binwidth, size = 1) + coord_cartesian(xlim = xlim) } ui \u0026lt;- fluidPage( fluidRow( column(3, numericInput(\u0026#34;lambda1\u0026#34;, label = \u0026#34;lambda1\u0026#34;, value = 3), numericInput(\u0026#34;lambda2\u0026#34;, label = \u0026#34;lambda2\u0026#34;, value = 5), numericInput(\u0026#34;n\u0026#34;, label = \u0026#34;n\u0026#34;, value = 1e4, min = 0) ), column(9, plotOutput(\u0026#34;hist\u0026#34;)) ) ) server \u0026lt;- function(input, output, session) { x1 \u0026lt;- reactive(rpois(input$n, input$lambda1)) x2 \u0026lt;- reactive(rpois(input$n, input$lambda2)) output$hist \u0026lt;- renderPlot({ freqpoly(x1(), x2(), binwidth = 1, xlim = c(0, 40)) }, res = 96) } shinyApp(ui,server) æ§åˆ¶reactiveè¡Œä¸ºï¼š\nè®¡æ—¶å™¨ reactiveTimer() æ˜¯ä¸€ä¸ªå“åº”å¼è¡¨è¾¾å¼ï¼Œå®ƒä¾èµ–äºéšè—çš„è¾“å…¥ï¼šå½“å‰æ—¶é—´ã€‚ å°†serveré‡Œçš„reactiveä¿®æ”¹æˆä¸‹åˆ—å½¢å¼å¯ä»¥è®©å›¾å½¢æ¯500msåˆ·æ–°ä¸€æ¬¡ã€‚ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 server \u0026lt;- function(input, output, session) { timer \u0026lt;- reactiveTimer(500) x1 \u0026lt;- reactive({ timer() rpois(input$n, input$lambda1) }) x2 \u0026lt;- reactive({ timer() rpois(input$n, input$lambda2) }) output$hist \u0026lt;- renderPlot({ freqpoly(x1(), x2(), binwidth = 1, xlim = c(0, 40)) }, res = 96) } ç‚¹å‡»åˆ·æ–° å½“ä½ çš„serveè¿è¡Œä¸€æ¬¡éœ€è¦åºå¤§è®¡ç®—å’Œæ—¶é—´æ—¶ï¼Œå¯èƒ½å¸Œæœ›è¦æ±‚ç”¨æˆ·é€šè¿‡å•å‡»æŒ‰é’®æ¥é€‰æ‹©æ‰§è¡Œæ˜‚è´µçš„è®¡ç®—ã€‚è¿™æ˜¯ actionButton() çš„ä¸€ä¸ªå¾ˆå¥½çš„ç”¨ä¾‹ï¼š å¹¶ä¸”æˆ‘ä»¬éœ€è¦ eventReactive()ï¼Œå®ƒæœ‰ä¸¤ä¸ªå‚æ•°ï¼šç¬¬ä¸€ä¸ªå‚æ•°æŒ‡å®šä¾èµ–ä»€ä¹ˆï¼Œç¬¬äºŒä¸ªå‚æ•°æŒ‡å®šè®¡ç®—ä»€ä¹ˆã€‚\nä¿®æ”¹uiå’Œserveï¼Œæ·»åŠ äº†æŒ‰é”®ï¼Œç”¨æˆ·ç‚¹å‡»æŒ‰é”®å³å¯å‡ºç°æ–°çš„æ¨¡æ‹Ÿç»“æœã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 ui \u0026lt;- fluidPage( fluidRow( column(3, numericInput(\u0026#34;lambda1\u0026#34;, label = \u0026#34;lambda1\u0026#34;, value = 3), numericInput(\u0026#34;lambda2\u0026#34;, label = \u0026#34;lambda2\u0026#34;, value = 5), numericInput(\u0026#34;n\u0026#34;, label = \u0026#34;n\u0026#34;, value = 1e4, min = 0), actionButton(\u0026#34;simulate\u0026#34;, \u0026#34;Simulate!\u0026#34;) ), column(9, plotOutput(\u0026#34;hist\u0026#34;)) ) ) server \u0026lt;- function(input, output, session) { x1 \u0026lt;- eventReactive(input$simulate, { rpois(input$n, input$lambda1) }) x2 \u0026lt;- eventReactive(input$simulate, { rpois(input$n, input$lambda2) }) output$hist \u0026lt;- renderPlot({ freqpoly(x1(), x2(), binwidth = 1, xlim = c(0, 40)) }, res = 96) } observeEvent() ä¸ eventReactive() éå¸¸ç›¸ä¼¼ã€‚å®ƒæœ‰ä¸¤ä¸ªé‡è¦çš„å‚æ•°ï¼ševentExpr å’Œ handlerExprã€‚ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯è¦ä¾èµ–çš„è¾“å…¥æˆ–è¡¨è¾¾å¼ï¼›ç¬¬äºŒä¸ªå‚æ•°æ˜¯å°†è¦è¿è¡Œçš„ä»£ç ã€‚ä¾‹å¦‚ï¼Œå¯¹ server() çš„ä»¥ä¸‹ä¿®æ”¹æ„å‘³ç€æ¯æ¬¡æ›´æ–°è¯¥åç§°æ—¶ï¼Œéƒ½ä¼šå‘æ§åˆ¶å°å‘é€ä¸€æ¡æ¶ˆæ¯ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 ui \u0026lt;- fluidPage( textInput(\u0026#34;name\u0026#34;, \u0026#34;What\u0026#39;s your name?\u0026#34;), textOutput(\u0026#34;greeting\u0026#34;) ) server \u0026lt;- function(input, output, session) { string \u0026lt;- reactive(paste0(\u0026#34;Hello \u0026#34;, input$name, \u0026#34;!\u0026#34;)) output$greeting \u0026lt;- renderText(string()) observeEvent(input$name, { message(\u0026#34;Greeting performed\u0026#34;) }) } file up/download ä½¿ç”¨fileInputåœ¨uiä¸­ä¸Šä¼ æ–‡ä»¶åï¼Œå¾—åˆ°çš„inputæ˜¯ä¸€ä¸ªåˆ—è¡¨ï¼Œå…¶ä¸­çš„datapathæ˜¯æ–‡ä»¶ä¸Šä¼ åçš„è·¯å¾„ï¼Œéœ€è¦ä½¿ç”¨read.csvç­‰å‡½æ•°è¯»å–file$datapathã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 ui \u0026lt;- fluidPage( sidebarLayout( sidebarPanel( fileInput(\u0026#34;file1\u0026#34;, \u0026#34;Choose CSV File\u0026#34;, accept = \u0026#34;.csv\u0026#34;), checkboxInput(\u0026#34;header\u0026#34;, \u0026#34;Header\u0026#34;, TRUE) ), mainPanel( tableOutput(\u0026#34;contents\u0026#34;) ) ) ) server \u0026lt;- function(input, output) { output$contents \u0026lt;- renderTable({ file \u0026lt;- input$file1 ext \u0026lt;- tools::file_ext(file$datapath) req(file) validate(need(ext == \u0026#34;csv\u0026#34;, \u0026#34;Please upload a csv file\u0026#34;)) read.csv(file$datapath, header = input$header) }) } shinyApp(ui, server) æ‚¨å¯ä»¥è®©ç”¨æˆ·ä½¿ç”¨ downloadButton() æˆ– downloadLink() ä¸‹è½½æ–‡ä»¶ã€‚è¿™äº›éƒ½éœ€è¦æœåŠ¡å™¨åŠŸèƒ½ä¸­çš„æ–°æŠ€æœ¯ï¼Œå› æ­¤æˆ‘ä»¬å°†åœ¨ç¬¬ 9 ç« ä¸­å›è¿‡å¤´æ¥è®¨è®ºã€‚\nShare æ–‡ä»¶å½¢å¼ ä»»ä½•æ‹¥æœ‰ R çš„äººéƒ½å¯ä»¥è¿è¡ŒShiny åº”ç”¨ç¨‹åºï¼Œåˆ†äº«ä½ çš„app.R æ–‡ä»¶å‰¯æœ¬ï¼Œä»¥åŠæ‚¨çš„åº”ç”¨ç¨‹åºä¸­ä½¿ç”¨çš„ä»»ä½•è¡¥å……ææ–™ï¼ˆä¾‹å¦‚ï¼Œwww æ–‡ä»¶å¤¹æˆ– helpers.R æ–‡ä»¶ï¼‰å³å¯ï¼Œæœ€å¥½å†™ä¸Šä»£ç è¿è¡Œçš„ä¾èµ–åŒ…å®‰è£…ä»£ç ã€‚\nrunUrl() will download and launch a Shiny app straight from a weblink. runGitHub( \u0026quot;\u0026lt;your repository name\u0026gt;\u0026quot;, \u0026quot;\u0026lt;your user name\u0026gt;\u0026quot;) ç½‘é¡µå½¢å¼ ä¸Šè¿°æ–¹æ³•è¦æ±‚ç”¨æˆ·åœ¨ä»–ä»¬çš„è®¡ç®—æœºä¸Šå®‰è£… R å’Œ Shinyã€‚ä½†å¦‚æœæˆ‘ä»¬è‡ªå·±æ­å»ºå¥½äº†æœåŠ¡å™¨ï¼Œä¹Ÿå¯ä»¥ç›´æ¥ç”¨æµè§ˆå™¨ä½¿ç”¨æˆ‘ä»¬çš„APPã€‚\nShinyapps.io å°† Shiny åº”ç”¨ç¨‹åºè½¬æ¢ä¸ºç½‘é¡µçš„æœ€ç®€å•æ–¹æ³•æ˜¯ä½¿ç”¨ shinyapps.ioï¼Œè¿™æ˜¯ RStudio ä¸º Shiny åº”ç”¨ç¨‹åºæä¾›çš„æ‰˜ç®¡æœåŠ¡ã€‚ 2. Shiny Server\nRStudio Connect Reference å®˜æ–¹æ•™ç¨‹ï¼šShiny Learning Resources\nå‚è€ƒä¹¦ï¼šMastering Shiny\n","date":"2023-03-27T00:00:00Z","image":"/p/rshiny/Rshiny_hu0864f99837a84b3a0d6c26cdeddf969b_6899_120x120_fill_q75_box_smart1.jpg","permalink":"/p/rshiny/","title":"å¼€å‘æˆ‘çš„Rshinyåº”ç”¨"},{"content":"Introduction å®åŸºå› ç»„ï¼ˆMetagenomeï¼‰æ˜¯æŒ‡å¯¹ä¸€ä¸ªç”Ÿæ€ç³»ç»Ÿä¸­çš„æ‰€æœ‰å¾®ç”Ÿç‰©è¿›è¡ŒDNAåˆ†æçš„è¿‡ç¨‹ï¼Œå¯ä»¥å¸®åŠ©ç ”ç©¶äººå‘˜äº†è§£å¾®ç”Ÿç‰©çš„å¤šæ ·æ€§ã€åŠŸèƒ½å’Œäº’ä½œå…³ç³»ã€‚\nå®åŸºå› ç»„çš„åº”ç”¨éå¸¸å¹¿æ³›ï¼ŒåŒ…æ‹¬ï¼š\nç”Ÿç‰©å¤šæ ·æ€§ç ”ç©¶ï¼šé€šè¿‡å¯¹å®åŸºå› ç»„è¿›è¡Œåˆ†æï¼Œå¯ä»¥äº†è§£ä¸åŒç”Ÿæ€ç³»ç»Ÿä¸­å¾®ç”Ÿç‰©çš„å¤šæ ·æ€§å’Œåˆ†å¸ƒæƒ…å†µã€‚\nç”Ÿæ€å­¦ç ”ç©¶ï¼šå®åŸºå› ç»„å¯ä»¥å¸®åŠ©ç ”ç©¶äººå‘˜äº†è§£å¾®ç”Ÿç‰©åœ¨ç”Ÿæ€ç³»ç»Ÿä¸­çš„åŠŸèƒ½ã€äº’ä½œå…³ç³»å’Œç”Ÿæ€ä½ç­‰ã€‚\nç”Ÿç‰©æŠ€æœ¯ï¼šå®åŸºå› ç»„å¯ä»¥ç”¨äºç­›é€‰å…·æœ‰ç‰¹å®šåŠŸèƒ½çš„å¾®ç”Ÿç‰©ï¼Œä¾‹å¦‚ï¼Œå¯»æ‰¾èƒ½å¤Ÿé™è§£æœ‰å®³ç‰©è´¨çš„å¾®ç”Ÿç‰©ã€‚\nå®åŸºå› ç»„çš„åˆ†æä¸€èˆ¬åŒ…æ‹¬ä»¥ä¸‹æ­¥éª¤ï¼š\nDNAæå–ä¸å»ºåº“ã€‚\né«˜é€šé‡æµ‹åºï¼šä½¿ç”¨é«˜é€šé‡æµ‹åºæŠ€æœ¯å¯¹æ‰©å¢åçš„DNAè¿›è¡Œæµ‹åºï¼Œå¾—åˆ°åŸå§‹åºåˆ—æ•°æ®ã€‚\næ•°æ®æ¸…æ´—å’Œç»„è£…ï¼šå¯¹åŸå§‹æ•°æ®è¿›è¡Œè´¨é‡æ§åˆ¶ã€å»é™¤ä½è´¨é‡åºåˆ—å’Œå†—ä½™åºåˆ—ï¼Œå°†åºåˆ—æ‹¼æ¥æˆè¾ƒé•¿çš„è¿ç»­åºåˆ—ï¼ˆcontigsï¼‰ã€‚\nåŸºå› æ³¨é‡Šï¼šå°†contigsä¸­çš„åŸºå› è¿›è¡Œæ³¨é‡Šï¼Œå¾—åˆ°åŸºå› åŠŸèƒ½ä¿¡æ¯ã€‚\næ•°æ®åˆ†æï¼šäº†è§£å¾®ç”Ÿç‰©å¤šæ ·æ€§ã€ç¾¤è½ç»“æ„ã€åŠŸèƒ½ç‰¹å¾ç­‰ä¿¡æ¯ï¼ˆæ›´å¤šæ˜¯æŒ‡è·å–äº†ç‰©ç§ä¸°åº¦è¡¨æˆ–åŠŸèƒ½ä¸°åº¦è¡¨ä¹‹åçš„è¿›ä¸€æ­¥åˆ†æï¼‰ã€‚\nMAGs binningï¼Œ è¿›åŒ–åŠ¨æ€ç­‰è¿›ä¸€æ­¥åˆ†æ\nè¿™æ˜¯æˆ‘å¸¸ç”¨çš„ä¸€å¥—åŸºæœ¬æµç¨‹(Figure 1)ï¼Œå½“ç„¶åœ¨é¢å¯¹ä¸åŒé¡¹ç›®æ—¶åº”è¯¥æœ‰ä¸åŒçš„ä¾§é‡ç‚¹å’Œé€‚ç”¨çš„åˆ†ææ–¹æ³•ï¼Œå¯ä»¥åœ¨æ­¤åŸºç¡€ä¸Šæ·»åŠ æˆ–ä¿®æ”¹ã€‚\næœ€æ—©è¿™æ–¹é¢çš„åˆ†ææˆ‘éƒ½æ˜¯å‚è€ƒåˆ˜æ°¸é‘«è€å¸ˆçš„EasyMetagenome,ç°åœ¨è¿™å¥—æµç¨‹ä¹Ÿå‘æ–‡ç« äº† (1)ï¼Œå€¼å¾—å‚è€ƒï¼Œå¯¹ä¸Šæ‰‹16Sæµ‹åºæ•°æ®æˆ–å®åŸºå› ç»„æ•°æ®éƒ½å¾ˆæœ‰å¸®åŠ©ã€‚\nFigure 1: Basic workflow preprocess ç»å¤§å¤šæ•°è¿™é‡Œä»‹ç»çš„è½¯ä»¶éƒ½æ˜¯ä»…æ”¯æŒlinuxå¹³å°çš„ï¼Œæˆ‘ä»¬åšæµ‹åºæ–‡ä»¶çš„ä¸Šæ¸¸åˆ†æä¹Ÿè‚¯å®šæ˜¯åœ¨æœåŠ¡å™¨ä¸Šåšï¼Œä¸ªäººPCä¸€èˆ¬å¾ˆéš¾æ»¡è¶³éœ€æ±‚ï¼Œæ‰€ä»¥åœ¨åšè¿™äº›åˆ†æå‰å¿…é¡»å…ˆå­¦ä¹ linuxåŸºç¡€çŸ¥è¯†å¦‚æ–‡ä»¶ç³»ç»Ÿï¼Œshellè„šæœ¬ç¼–å†™ï¼Œè½¯ä»¶å®‰è£…ç­‰ã€‚\nå®‰è£…è½¯ä»¶å»ºè®®ä½¿ç”¨condaæˆ–mambaï¼ˆæ–°å»ºç¯å¢ƒå’Œç®¡ç†ï¼‰ï¼Œæœ‰å¾ˆå¤šå‚è€ƒæ–¹æ³•ã€‚\næˆ‘ä»¬æœåŠ¡å™¨ä½¿ç”¨çš„æ˜¯slurmä½œä¸šç®¡ç†ç³»ç»Ÿï¼Œå°½é‡å…ˆå­¦ä¹ ä¸€ä¸‹slurmçš„ä½¿ç”¨å†å°è¯•æäº¤ä½œä¸šã€‚\nä¸€èˆ¬æŠŠæ‰€æœ‰æ ·æœ¬çš„æµ‹åºåŒç«¯æ–‡ä»¶æ”¾åœ¨ä¸€ä¸ªæ–‡ä»¶å¤¹ä¸‹\nè´¨æ§ï¼šfastp 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 #!/bin/bash #SBATCH --job-name=fastp #SBATCH --output=/share/home/jianglab/pengchen/work/asthma/fastp/log/%x_%a.out #SBATCH --error=/share/home/jianglab/pengchen/work/asthma/fastp/log/%x_%a.err #SBATCH --array=1-33 #SBATCH --partition=short #SBATCH --cpus-per-task=8 echo start: `date +\u0026#39;%Y-%m-%d %T\u0026#39;` start=`date +%s` echo \u0026#34;SLURM_ARRAY_TASK_ID: \u0026#34; $SLURM_ARRAY_TASK_ID sample=$(head -n $SLURM_ARRAY_TASK_ID ~/work/asthma/data/namelist | tail -1) #sample=$(head -n 1 namelist | tail -1) echo handling: $sample #################### fastp -w 8 -i ~/work/asthma/data/$sample/$sample\u0026#39;_f1.fastq\u0026#39; -o ${sample}_1 \\ -I ~/work/asthma/data/$sample/$sample\u0026#39;_r2.fastq\u0026#39; -O ${sample}_2 -j ~/work/asthma/fastp/${i}.json #################### echo end: `date +\u0026#39;%Y-%m-%d %T\u0026#39;` end=`date +%s` echo TIME:`expr $end - $start`s åé¢æ¥ä¸€ä¸ªpythonè„šæœ¬å°±å¯ä»¥ç»Ÿè®¡å¸¸ç”¨æŒ‡æ ‡äº†ã€‚\næŠŠæ‰€æœ‰çš„.jsonæ–‡ä»¶ç§»åˆ°ä¸€ä¸ªæ–‡ä»¶å¤¹é‡Œï¼Œreport/ä¸‹ï¼Œå°±å¯ä»¥ç»Ÿè®¡äº†ã€‚\nå»å®¿ä¸»ï¼šbowtie2 å…¶å®å°±æ˜¯å°†åºåˆ—æ¯”å¯¹åˆ°äººç±»åŸºå› ç»„ä¸Šï¼Œæ²¡æœ‰æ¯”å¯¹åˆ°çš„åºåˆ—æ•´åˆæˆæ–°æ–‡ä»¶å°±æ˜¯å»å®¿ä¸»åçš„äº†ã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 #!/bin/bash #SBATCH --job-name=rm_human #SBATCH --output=/share/home/jianglab/pengchen/work/meta/%x_%a.out #SBATCH --error=/share/home/jianglab/pengchen/work/meta/%x_%a.err #SBATCH --cpus-per-task=32 #SBATCH --partition=short echo start: `date +\u0026#39;%Y-%m-%d %T\u0026#39;` start=`date +%s` ############# for i in C1 C2 do bowtie2 -p 32 -x ~/db/humangenome/hg38 -1 seq/${i}_1.fq.gz \\ -2 seq/${i}_2.fq.gz -S ${i}.sam --un-conc ${i}.fq --very-sensitive done ############## echo end: `date +\u0026#39;%Y-%m-%d %T\u0026#39;` end=`date +%s` echo TIME:`expr $end - $start`s åŸºæœ¬ä¿¡æ¯ç»Ÿè®¡ å¯ä»¥ç”¨FastqCountï¼š\n1 2 3 4 ~/biosoft/FastqCount-master/FastqCount_v0.5 xx.fastq.gz Total Reads Total Bases N Bases Q20 Q30 GC 11568822 (11.57 M) 1702829127 (1.70 G) 0.00% 98.00% 94.00% 54.00% reads-based ç‰©ç§æ³¨é‡Šï¼škraken2 Kraken 2æ˜¯ä¸€ä¸ªç”¨äºå¯¹é«˜é€šé‡æµ‹åºæ•°æ®è¿›è¡Œåˆ†ç±»å’Œæ ‡è¯†ç‰©ç§çš„è½¯ä»¶ã€‚å®ƒä½¿ç”¨å‚è€ƒæ•°æ®åº“ä¸­çš„åŸºå› ç»„åºåˆ—æ¥è¿›è¡Œåˆ†ç±»ï¼Œå¹¶ä½¿ç”¨k-meræ–¹æ³•æ¥å®ç°å¿«é€Ÿå’Œå‡†ç¡®çš„åˆ†ç±»ã€‚\nä½¿ç”¨Kraken 2è¿›è¡ŒåŸºæœ¬åˆ†ç±»çš„ç®€å•æ­¥éª¤ï¼š\nå‡†å¤‡å‚è€ƒæ•°æ®åº“ï¼šKraken 2éœ€è¦ä¸€ä¸ªå‚è€ƒæ•°æ®åº“ï¼Œä»¥ä¾¿å¯¹æµ‹åºæ•°æ®è¿›è¡Œåˆ†ç±»ã€‚å¯ä»¥ä»NCBIã€Ensemblæˆ–å…¶ä»–æ•°æ®åº“ä¸‹è½½ç›¸åº”çš„åŸºå› ç»„åºåˆ—ï¼Œå¹¶ä½¿ç”¨Kraken 2å†…ç½®çš„å·¥å…·æ¥æ„å»ºæ•°æ®åº“ã€‚\nå®‰è£…Kraken 2ï¼šå¯ä»¥ä»Kraken 2å®˜æ–¹ç½‘ç«™ä¸‹è½½å¹¶å®‰è£…Kraken 2è½¯ä»¶ã€‚\nè¿è¡ŒKraken 2ï¼šä½¿ç”¨Kraken 2å¯¹æµ‹åºæ•°æ®è¿›è¡Œåˆ†ç±»éœ€è¦ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤ï¼š\nkraken2 \\--db \\\u0026lt;path_to_database\\\u0026gt; \\\u0026lt;input_file\\\u0026gt; \\--output \\\u0026lt;output_file\\\u0026gt;\nè¿™é‡Œï¼Œ**\u0026lt;path_to_database\u0026gt;æ˜¯å‚è€ƒæ•°æ®åº“çš„è·¯å¾„ï¼Œ\u0026lt;input_file\u0026gt;æ˜¯éœ€è¦è¿›è¡Œåˆ†ç±»çš„è¾“å…¥æ–‡ä»¶ï¼Œ\u0026lt;output_file\u0026gt;**æ˜¯è¾“å‡ºæ–‡ä»¶çš„åç§°ã€‚Kraken 2å°†è¾“å‡ºä¸€ä¸ªåˆ†ç±»æŠ¥å‘Šæ–‡ä»¶å’Œä¸€ä¸ªåºåˆ—æ–‡ä»¶ã€‚\nkraken2-build --standard --threads 24 --db ./\n\u0026ndash;standardæ ‡å‡†æ¨¡å¼ä¸‹åªä¸‹è½½5ç§æ•°æ®åº“ï¼šå¤èŒarchaeaã€ç»†èŒbacteriaã€äººç±»humanã€è½½ä½“UniVec_Coreã€ç—…æ¯’viralã€‚ä¹Ÿå¯é€‰ç›´æ¥ä¸‹è½½ä½œè€…æ„å»ºçš„ç´¢å¼•ï¼Œè¿˜åŒ…æ‹¬brackençš„ç´¢å¼•ã€‚\nè¿™ä¸ªkrakenæ•°æ®åº“æ˜¯å¯ä»¥è‡ªå·±æ„å»ºçš„ï¼Œæ‰€ä»¥é€‚ç”¨äºå„ç§é¡¹ç›®çš„ç‰©ç§æ³¨é‡Šï¼Œæˆ‘åšçš„æ¯”è¾ƒå¤šçš„æ˜¯ç¯å¢ƒæ ·æœ¬çš„å®åŸºå› ç»„ï¼Œå°±å¯èƒ½éœ€è¦æ›´å…¨é¢çš„ç‰©ç§æ•°æ®åº“ï¼ˆç”šè‡³é™¤äº†å„ç§å¾®ç”Ÿç‰©ï¼Œè¿˜è¦åŠ¨æ¤ç‰©æ•°æ®ç­‰ï¼‰ï¼Œå®éªŒå®¤çš„WXå¸ˆå§æ”¶é›†æ„å»ºäº†ä¸€ä¸ªè¶…å¤§çš„ç‰©ç§åº“ã€‚\néœ€è¦æ³¨æ„çš„æ˜¯krakenè¿è¡Œè‡³å°‘è¦æä¾›æ•°æ®åº“å¤§å°çš„å†…å­˜å¤§å°ï¼ˆè¿è¡Œå†…å­˜ï¼‰ï¼Œå› ä¸ºå®ƒä¼šæŠŠæ•´ä¸ªæ•°æ®åº“è½½å…¥å†…å­˜åè¿›è¡Œåºåˆ—çš„æ³¨é‡Šï¼Œæ‰€ä»¥å¦‚æœå‘ç°æ— æ³•è½½å…¥æ•°æ®åº“çš„æŠ¥é”™ï¼Œå¯ä»¥å°è¯•è°ƒå¤§å†…å­˜èµ„æºã€‚\nkrakenè½¯ä»¶è¿è¡Œæ—¶è½½å…¥æ•°æ®åº“æ˜¯ä¸€ä¸ªååˆ†è€—æ—¶çš„æ­¥éª¤ï¼Œè€Œæ¯æ¡åºåˆ—çš„é‰´å®šæ—¶é—´å·®ä¸å¤šï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥å°†å¾ˆå¤šæ ·æœ¬çš„fastqæ–‡ä»¶åˆå¹¶æˆä¸€ä¸ªå¤§æ–‡ä»¶åè¾“å…¥krakenæ³¨é‡Šï¼Œä¹‹åå†æŒ‰ç…§åºåˆ—çš„æ•°é‡æ‹†åˆ†ç»“æœæ–‡ä»¶ï¼Œè¿™æ ·å¤šä¸ªæ ·æœ¬ä¹Ÿåªéœ€è¦è½½å…¥ä¸€æ¬¡æ•°æ®åº“ï¼ŒèŠ‚çœæ—¶é—´ã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 #!/bin/bash #SBATCH --job-name=kraken2M #SBATCH --output=/share/home/jianglab/pengchen/work/asthma/kraken/%x_%a.out #SBATCH --error=/share/home/jianglab/pengchen/work/asthma/kraken/%x_%a.err #SBATCH --time=14-00:00:00 #SBATCH --partition=mem #SBATCH --cpus-per-task=32 #SBATCH --mem-per-cpu=100G fqp=~/work/asthma/data/CRR205159/ python /share/home/jianglab/shared/krakenDB/K2ols/kraken2M.py -t 32 \\ -i ${fqp} \\ -c 0.05 \\ -s _f1.fastq,_r2.fastq \\ -o ~/work/asthma/kraken/ \\ -d /share/home/jianglab/shared/krakenDB/mydb2 \\ -k ~/miniconda3/envs/waste/bin/kraken2 \\ -kt /share/home/jianglab/shared/krakenDB/K2ols/KrakenTools è¾“å‡ºæ–‡ä»¶æ ¼å¼ Krakenæ ‡å‡†è¾“å‡ºæ ¼å¼\näº”åˆ—è¡¨ output\nC/Uä»£è¡¨åˆ†ç±»classifiedæˆ–éåˆ†ç±»unclassifed\nåºåˆ—ID\nç‰©ç§æ³¨é‡Š\næ¯”åºåˆ—æ³¨é‡Šçš„åŒºåŸŸï¼Œå¦‚98|94ä»£è¡¨å·¦ç«¯98bpï¼Œå³ç«¯94bpæ¯”å¯¹è‡³æ•°æ®åº“\nLCAæ¯”å¯¹ç»“æœï¼Œå¦‚â€562:13 561:4â€ä»£è¡¨13 k-meræ¯”å¯¹è‡³ç‰©ç§#562ï¼Œ4 k-meræ¯”å¯¹è‡³#561ç‰©ç§\næŠ¥å‘Šè¾“å‡ºæ ¼å¼ report\nåŒ…æ‹¬6åˆ—ï¼Œæ–¹ä¾¿æ•´ç†ä¸‹æ¸¸åˆ†æã€‚\nç™¾åˆ†æ¯”\ncount\ncountæœ€ä¼˜\n(U)nclassified, (R)oot, (D)omain, (K)ingdom, (P)hylum, (C)lass, (O)rder, (F)amily, (G)enus, or (S)pecies. â€œG2â€ä»£è¡¨ä½äºå±ä¸€ç§é—´\nNCBIç‰©ç§ID\nç§‘å­¦ç‰©ç§å\nå¸¸ç”¨çš„ç‰©ç§ä¸°åº¦è¡¨æ ¼å¼é™¤äº†kraken reportï¼Œè¿˜æœ‰mpaï¼Œspfï¼Œkronaç­‰æ ¼å¼ï¼Œå…³äºkrakenç»“æœçš„æ•´ç†ä»¥åŠæ ¼å¼è½¬æ¢æ–¹å¼ï¼Œæœ‰ä¸€äº›ç°æˆçš„è„šæœ¬æˆ–è€…è‡ªå·±å†™ã€‚\nKrakenTools (jhu.edu) å°±æ˜¯ä¸€å¥—å¾ˆå¥½ç”¨çš„krakenå·¥å…·åŒ…ï¼Œå…¶ä¸­å¸¸ç”¨çš„æœ‰ï¼š\nextract_kraken_reads.py æ­¤ç¨‹åºæå–è¯»å–åœ¨ä»»ä½•ç”¨æˆ·æŒ‡å®šçš„åˆ†ç±»idå¤„åˆ†ç±»çš„å†…å®¹ã€‚ç”¨æˆ·å¿…é¡»æŒ‡å®šKrakenè¾“å‡ºæ–‡ä»¶ã€åºåˆ—æ–‡ä»¶å’Œè‡³å°‘ä¸€ä¸ªåˆ†ç±»æ³•IDã€‚ä¸‹é¢æŒ‡å®šäº†å…¶ä»–é€‰é¡¹ã€‚æˆªè‡³2021å¹´4æœˆ19æ—¥ï¼Œæ­¤è„šæœ¬ä¸KrakenUniq/Kraken2UniqæŠ¥å‘Šå…¼å®¹ã€‚\ncombine_kreports.py This script combines multiple Kraken reports into a combined report file.\npython combine_kreports.py\n-r 1.KREPORT 2.KREPORT\u0026hellip;\u0026hellip;\u0026hellip;\u0026hellip;\u0026hellip;\u0026hellip;\u0026hellip;\u0026hellip;Kraken-style reports to combine\n-o COMBINED.KREPORT\u0026hellip;\u0026hellip;\u0026hellip;\u0026hellip;\u0026hellip;\u0026hellip;\u0026hellip;\u0026hellip;\u0026hellip;Output file\nkreport2krona.py This program takes a Kraken report file and prints out a krona-compatible TEXT file\næ¢æˆkronaæ–‡ä»¶å¥½ç”»å›¾ã€‚å˜¿å˜¿\nkronaè£…äº†ä¸€ä¸ªexcelçš„æ’ä»¶å¯ä»¥å¾ˆå®¹æ˜“ç”»å›¾\npython kreport2krona.py\n-r/\u0026ndash;report MYFILE.KREPORT\u0026hellip;.â€¦.Kraken report file\n-o/\u0026ndash;output MYFILE.KRONA\u0026hellip;\u0026hellip;.â€¦Output Krona text file\nthen, ktImportText MYSAMPLE.krona -o MYSAMPLE.krona.html\nå¥½çœ‹çš„ç½‘é¡µå°±å‡ºæ¥äº†ã€‚\nkreport2mpa.py This program takes a Kraken report file and prints out a mpa (MetaPhlAn) -style TEXT file\npython kreport2mpa.py\n-r/\u0026ndash;report MYFILE.KREPORT\u0026hellip;.â€¦.Kraken report file\n-o/\u0026ndash;output MYFILE.MPA.TXT\u0026hellip;.â€¦.Output MPA-STYLE text file\ncombine_mpa.py python combine_mpa.py\n-i/\u0026ndash;input MYFILE1.MPA MYFILE2.MPA\u0026hellip;.â€¦Multiple MPA-STYLE text files (separated by spaces)\n-o/\u0026ndash;output MYFILE.COMBINED.MPA\u0026hellip;\u0026hellip;.â€¦Output MPA-STYLE text file\nThis program combines multiple outputs from kreport2mpa.py. Files to be combined must have been generated using the same kreport2mpa.py options.\npython combine_mpa.py -i -o --intermediate-ranks\nHUMAnN HUMAnN2ï¼ˆThe HMP Unified Metabolic Analysis Network 2ï¼‰æ˜¯ä¸€æ¬¾ç”¨äºåˆ†æäººç±»å¾®ç”Ÿç‰©ç»„çš„åŠŸèƒ½å’Œä»£è°¢èƒ½åŠ›çš„å·¥å…·ã€‚å®ƒé€šè¿‡å°†å®åŸºå› ç»„åºåˆ—ä¸å‚è€ƒåŸºå› ç»„æ•°æ®åº“æ¯”å¯¹ï¼Œåˆ©ç”¨MetaCycä»£è°¢é€šè·¯æ•°æ®åº“å’ŒUniRefè›‹ç™½è´¨åºåˆ—æ•°æ®åº“ï¼Œåˆ†æå¾®ç”Ÿç‰©ç»„åœ¨åŠŸèƒ½å’Œä»£è°¢é€šè·¯æ°´å¹³ä¸Šçš„ç»„æˆå’Œæ´»æ€§ã€‚HUMAnN2è¿˜æä¾›äº†å¤šæ ·æ€§åˆ†æã€å…³è”åˆ†æå’Œå¯è§†åŒ–å·¥å…·ï¼Œå¯ç”¨äºæ·±å…¥ç ”ç©¶äººç±»å¾®ç”Ÿç‰©ç»„å¯¹å®¿ä¸»å¥åº·çš„å½±å“å’Œæ²»ç–—ç­–ç•¥çš„åˆ¶å®šç­‰æ–¹é¢ã€‚\nHUMAnN2æ˜¯ç”±ç¾å›½å›½å®¶äººç±»å¾®ç”Ÿç‰©ç»„è®¡åˆ’ï¼ˆHMPï¼‰å¼€å‘çš„ï¼Œç›®å‰æœ€æ–°ç‰ˆæœ¬ä¸ºHUMAnN3ï¼Œäº2020å¹´å‘å¸ƒã€‚ä¸HUMAnN2ç›¸æ¯”ï¼ŒHUMAnN3æ”¹è¿›äº†åŸºå› å®¶æ—æ³¨é‡Šçš„æ–¹æ³•ï¼Œæé«˜äº†æ³¨é‡Šç²¾åº¦å’Œé€Ÿåº¦ï¼Œå¹¶æä¾›äº†æ–°çš„åŠŸèƒ½å’Œå·¥å…·ï¼Œå¦‚åŠŸèƒ½éŸ§åº¦åˆ†æã€ä»£è°¢æŒ‡çº¹è¯†åˆ«å’Œå¤šæ ·æ€§åˆ†æç­‰ã€‚\nä½†æ˜¯HUMAnN2çš„æ•°æ®åº“åŸºæœ¬éƒ½æ˜¯ä¸äººç›¸å…³çš„å¾®ç”Ÿç‰©ï¼Œæ¯”è¾ƒé€‚åˆåšå„ç§äººä½“å¾®ç”Ÿç‰©ç»„ï¼ˆè‚ é“ï¼Œè‚ºéƒ¨ï¼Œå£è…”ï¼Œçš®è‚¤ç­‰ç­‰ï¼‰ï¼Œå¯¹äºç¯å¢ƒæ ·æœ¬å¯èƒ½unclassifiedæ¯”è¾ƒå¤šã€‚\nHUMAnN2è¦æ±‚åŒç«¯åºåˆ—åˆå¹¶çš„æ–‡ä»¶ä½œä¸ºè¾“å…¥ï¼Œforå¾ªç¯æ ¹æ®å®éªŒè®¾è®¡æ ·æœ¬åæ‰¹é‡åŒç«¯åºåˆ—åˆå¹¶ã€‚\nç‰©ç§ç»„æˆè°ƒç”¨MetaPhlAn2, bowtie2æ¯”å¯¹è‡³æ ¸é…¸åºåˆ—ï¼Œè§£å†³æœ‰å“ªäº›å¾®ç”Ÿç‰©å­˜åœ¨çš„é—®é¢˜ï¼›\nåŠŸèƒ½ç»„æˆä¸ºhumann2è°ƒç”¨diamondæ¯”å¯¹è‡³è›‹ç™½åº“11Gbï¼Œè§£å†³è¿™äº›å¾®ç”Ÿç‰©å‚ä¸å“ªäº›åŠŸèƒ½é€šè·¯çš„é—®é¢˜ï¼›\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 cd alldata for i in `cat ~/work/asthma/data/namelist` do echo $i cat ${i}_f1.fastq ${i}_r2.fastq \u0026gt;${i}_paired.fastq done #!/bin/bash #SBATCH --job-name=humann2 #SBATCH --output=/share/home/jianglab/pengchen/work/asthma/humann/%x_%a.out #SBATCH --error=/share/home/jianglab/pengchen/work/asthma/humann/%x_%a.err #SBATCH --array=1-32 #SBATCH --cpus-per-task=24 #SBATCH --partition=cpu echo start: `date +\u0026#39;%Y-%m-%d %T\u0026#39;` start=`date +%s` ############## myarray=(`cat ~/work/asthma/data/namelist`) echo $SLURM_ARRAY_TASK_ID #this is your single file name sample=${myarray[${SLURM_ARRAY_TASK_ID}]} echo handling: $sample humann2 --input data/alldata/${sample}_paired.fastq \\ --output temp/humann2/ --threads 24 ## é“¾æ¥é‡è¦æ–‡ä»¶è‡³humann2ç›®å½• ln temp/humann2/${sample}_paired_humann2_temp/${sample}_paired_metaphlan_bugs_list.tsv temp/humann2/ ## åˆ é™¤ä¸´æ—¶æ–‡ä»¶ rm -rf temp/humann2/${sample}_paired_humann2_temp ############## echo end: `date +\u0026#39;%Y-%m-%d %T\u0026#39;` end=`date +%s` echo TIME:`expr $end - $start`s ## åˆå¹¶ã€ä¿®æ­£æ ·æœ¬åã€é¢„è§ˆ merge_metaphlan_tables2.py \\ temp/humann2/*_metaphlan_bugs_list.tsv | \\ sed \u0026#39;s/_metaphlan_bugs_list//g\u0026#39; \\ \u0026gt; metaphlan2/taxonomy.tsv contigs-based ç»„è£…ï¼šmegahit MegaHitæ˜¯ä¸€ä¸ªç”¨äºå¯¹é«˜é€šé‡æµ‹åºæ•°æ®è¿›è¡Œde novoç»„è£…çš„è½¯ä»¶ã€‚å®ƒä½¿ç”¨äº†ä¸€ç§åŸºäºçŸ­è¯»æ¯”å¯¹å’Œå›¾å½¢æ„å»ºçš„ç®—æ³•æ¥ç»„è£…åŸºå› ç»„ï¼Œå¯ä»¥é«˜æ•ˆåœ°å¤„ç†å¤§è§„æ¨¡çš„æ•°æ®é›†ã€‚ä»¥ä¸‹æ˜¯MegaHitçš„ä¸€äº›ä¼˜ç‚¹å’Œé€‚ç”¨æƒ…å†µï¼š\né€Ÿåº¦å¿«ï¼šMegaHitçš„ç®—æ³•éå¸¸é«˜æ•ˆï¼Œå¯ä»¥å¤„ç†å¤§è§„æ¨¡çš„æ•°æ®é›†ï¼Œé€šå¸¸æ¯”å…¶ä»–de novoç»„è£…å·¥å…·æ›´å¿«ã€‚\né«˜è´¨é‡çš„ç»„è£…ï¼šMegaHitåœ¨ç»„è£…ç»“æœçš„è¿é€šæ€§å’Œå‡†ç¡®æ€§æ–¹é¢è¡¨ç°ä¼˜å¼‚ï¼Œå°¤å…¶åœ¨å¤„ç†é«˜GCå«é‡åŸºå› ç»„æ—¶æ•ˆæœæ˜¾è‘—ã€‚\né€‚ç”¨äºä¸åŒç±»å‹çš„æµ‹åºæ•°æ®ï¼šMegaHitæ”¯æŒå¤šç§ä¸åŒç±»å‹çš„æµ‹åºæ•°æ®ï¼ŒåŒ…æ‹¬ Illumina HiSeq/MiSeqã€IonTorrentå’ŒPacBioç­‰å¹³å°ã€‚\næ˜“äºä½¿ç”¨ï¼šMegaHitå…·æœ‰ç®€å•çš„å‘½ä»¤è¡Œè¯­æ³•ï¼Œæ–¹ä¾¿ç”¨æˆ·è¿›è¡Œç»„è£…æ“ä½œï¼Œä¸”å…·æœ‰ä¸­æ–­ç‚¹ï¼Œé¿å…å¤±è´¥åå…¨éƒ¨é‡è·‘ã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 #!/bin/bash #SBATCH --job-name=asthma_megahit #SBATCH --output=/share/home/jianglab/pengchen/work/asthma/megahit/log/%x_%a.out #SBATCH --error=/share/home/jianglab/pengchen/work/asthma/megahit/log/%x_%a.err #SBATCH --array=1-33 #SBATCH --partition=cpu #SBATCH --cpus-per-task=32 echo start: `date +\u0026#39;%Y-%m-%d %T\u0026#39;` start=`date +%s` echo \u0026#34;SLURM_ARRAY_TASK_ID: \u0026#34; $SLURM_ARRAY_TASK_ID sample=$(head -n $SLURM_ARRAY_TASK_ID ~/work/asthma/data/namelist | tail -1) #sample=$(head -n 1 namelist | tail -1) echo handling: $sample\t#################### megahit -t 32 -1 ~/work/asthma/data/$sample/$sample\u0026#39;_f1.fastq\u0026#39; \\ -2 ~/work/asthma/data/$sample/$sample\u0026#39;_r2.fastq\u0026#39; -o ~/work/asthma/megahit/$sample --out-prefix $sample #################### echo end: `date +\u0026#39;%Y-%m-%d %T\u0026#39;` end=`date +%s` echo TIME:`expr $end - $start`s ç»„è£…è¯„ä¼°ï¼šQUAST QUASTä»£è¡¨è´¨é‡è¯„ä¼°å·¥å…·ã€‚ QUASTå¯ä»¥ä½¿ç”¨å‚è€ƒåŸºå› ç»„ä»¥åŠä¸ä½¿ç”¨å‚è€ƒåŸºå› ç»„æ¥è¯„ä¼°è£…é…ã€‚ QUASTç”Ÿæˆè¯¦ç»†çš„æŠ¥å‘Šï¼Œè¡¨æ ¼å’Œå›¾è§£ï¼Œä»¥æ˜¾ç¤ºè£…é…çš„ä¸åŒæ–¹é¢ã€‚\nåŸºå› é¢„æµ‹ï¼šProdigal è¾“å…¥æ–‡ä»¶ï¼šæ‹¼è£…å¥½çš„åºåˆ—æ–‡ä»¶ megahit/final.contigs.fa\nè¾“å‡ºæ–‡ä»¶ï¼šprodigalé¢„æµ‹çš„åŸºå› åºåˆ— prodigal/gene.fa\nprodigalä¸æ”¯æŒå¤šçº¿ç¨‹è¿è¡Œï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥è‡ªè¡Œåˆ†å‰²åºåˆ—æ–‡ä»¶è°ƒç”¨å¤šä¸ªprodigalç¨‹åºåˆ†åˆ«è·‘å®ç°ä¼ªå¤šçº¿ç¨‹ã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 #!/bin/bash #SBATCH --job-name=prodigal #SBATCH --output=/share/home/jianglab/pengchen/work/asthma/prodigal/log/%x_%a.out #SBATCH --error=/share/home/jianglab/pengchen/work/asthma/prodigal/log/%x_%a.err #SBATCH --array=1-33 #SBATCH --partition=cpu #SBATCH --cpus-per-task=1 echo start: `date +\u0026#39;%Y-%m-%d %T\u0026#39;` start=`date +%s` echo \u0026#34;SLURM_ARRAY_TASK_ID: \u0026#34; $SLURM_ARRAY_TASK_ID sample=$(head -n $SLURM_ARRAY_TASK_ID ~/work/asthma/data/namelist | tail -1) #sample=$(head -n 1 namelist | tail -1) echo handling: $sample #################### prodigal -i ~/work/asthma/megahit/contigs/$sample.fa \\ -d ~/work/asthma/prodigal/$sample.gene.fa \\ -o ~/work/asthma/prodigal/$sample.gene.gff \\ -p meta -f gff grep \u0026#39;partial=00\u0026#39; ~/work/asthma/prodigal/$sample.gene.fa | cut -f1 -d \u0026#39; \u0026#39;| sed \u0026#39;s/\u0026gt;//\u0026#39; \u0026gt; ~/work/asthma/prodigal/$sample.fullid seqkit grep -f ~/work/asthma/prodigal/$sample.fullid ~/work/asthma/prodigal/$sample.gene.fa \u0026gt; ~/work/asthma/prodigal/fullgene/$sample.gene.fa #################### echo end: `date +\u0026#39;%Y-%m-%d %T\u0026#39;` end=`date +%s` echo TIME:`expr $end - $start`s ============================================================================ ## ç»Ÿè®¡åŸºå› æ•°é‡ grep -c \u0026#39;\u0026gt;\u0026#39; temp/prodigal/gene.fa ## ç»Ÿè®¡å®Œæ•´åŸºå› æ•°é‡ï¼Œæ•°æ®é‡å¤§å¯åªç”¨å®Œæ•´åŸºå› éƒ¨åˆ† grep -c \u0026#39;partial=00\u0026#39; temp/prodigal/gene.fa ## æå–å®Œæ•´åŸºå› (å®Œæ•´ç‰‡æ®µè·å¾—çš„åŸºå› å…¨ä¸ºå®Œæ•´ï¼Œå¦‚æˆç¯çš„ç»†èŒåŸºå› ç»„) grep \u0026#39;partial=00\u0026#39; temp/prodigal/gene.fa | cut -f1 -d \u0026#39; \u0026#39;| sed \u0026#39;s/\u0026gt;//\u0026#39; \u0026gt; temp/prodigal/full_length.id seqkit grep -f temp/prodigal/full_length.id temp/prodigal/gene.fa \u0026gt; temp/prodigal/full_length.fa seqkit stat temp/prodigal/full_length.fa å»å†—ä½™ ä¸Šé¢äº§ç”Ÿäº†nä¸ªæ ·æœ¬çš„åŸºå› é¢„æµ‹ç»“æœæ–‡ä»¶ï¼Œgene.faæ–‡ä»¶è¦æƒ³åŠæ³•æ•´åˆä¸ºä¸€ä¸ªæ–‡ä»¶å†å»å»å†—ä½™ã€‚\n1 2 3 4 5 6 7 8 9 10 #!/bin/bash #ä¿®æ”¹æ¯æ¡åºåˆ—çš„åç§°ï¼ŒåŠ ä¸Šæ ·æœ¬å for i in `cat ~/work/asthma/data/namelist` do echo $i sed -i \u0026#34;/\u0026gt;/s/\u0026gt;/\u0026gt;${i}_/\u0026#34; $i.gene.fa done echo \u0026#39;start merge\u0026#39; cat *.gene.fa\u0026gt;all.fullgene.fa echo \u0026#39;done\u0026#39; Cd-hit 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 #!/bin/bash #SBATCH --job-name=cdhit #SBATCH --output=/share/home/jianglab/pengchen/work/asthma/%x_%a.out #SBATCH --error=/share/home/jianglab/pengchen/work/asthma/%x_%a.err #SBATCH --cpus-per-task=32 #SBATCH --partition=short echo start: `date +\u0026#39;%Y-%m-%d %T\u0026#39;` start=`date +%s` ############## ## è¾“å…¥æ–‡ä»¶ï¼šprodigalé¢„æµ‹çš„åŸºå› åºåˆ— all.fullgene.fa ## è¾“å‡ºæ–‡ä»¶ï¼šå»å†—ä½™åçš„åŸºå› å’Œè›‹ç™½åºåˆ—ï¼šNR/nucleotide.fa;NR/protein.fa mkdir NR ## aSè¦†ç›–åº¦ï¼Œcç›¸ä¼¼åº¦ï¼ŒGå±€éƒ¨æ¯”å¯¹ï¼Œgæœ€ä¼˜è§£ï¼ŒTå¤šçº¿ç¨‹ï¼ŒMå†…å­˜0ä¸é™åˆ¶ ## 2ä¸‡åŸºå› 2mï¼Œ2åƒä¸‡éœ€è¦2000hï¼Œå¤šçº¿ç¨‹å¯åŠ é€Ÿ\tcd-hit-est -i prodigal/fullgene/all.fullgene.fa \\ -o NR/nucleotide.fa \\ -aS 0.9 -c 0.9 -G 0 -g 0 -T 0 -M 0 ## ç»Ÿè®¡éå†—ä½™åŸºå› æ•°é‡ï¼Œå•æ¬¡æ‹¼æ¥ç»“æœæ•°é‡ä¸‹é™ä¸å¤§ï¼Œå¤šæ‰¹æ‹¼æ¥å†—ä½™åº¦é«˜ echo \u0026#39;after remove, the number of genes: \u0026#39; grep -c \u0026#39;\u0026gt;\u0026#39; NR/nucleotide.fa ## ç¿»è¯‘æ ¸é…¸ä¸ºå¯¹åº”è›‹ç™½åºåˆ—ï¼Œemboss ## emboss transeqå·¥å…·ï¼Œ93.9 MB conda install emboss -y transeq -sequence NR/nucleotide.fa \\ -outseq NR/protein.fa -trim Y ## åºåˆ—åè‡ªåŠ¨æ·»åŠ äº†_1ï¼Œä¸ºä¸æ ¸é…¸å¯¹åº”è¦å»é™¤ sed -i \u0026#39;s/_1 / /\u0026#39; NR/protein.fa ############## echo end: `date +\u0026#39;%Y-%m-%d %T\u0026#39;` end=`date +%s` echo TIME:`expr $end - $start`s mmseq2 è¿™ä¸ªè¦æ¯”cd-hitå¿«éå¸¸å¤š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 #mmseqs2 ##min-seq-id:identityï¼Œcè¦†ç›–åº¦ï¼Œrescore-mode3: global alignment #èšç±» input_fa=tmp_com.gene mmseqs easy-linclust $input_fa lin_res tmp \\ --min-seq-id 0.9 -c 0.9 --cov-mode 1 --threads 8 #æˆ–è€… mmseqs easy-cluster $input_fa lin_res tmp \\ --min-seq-id 0.9 -c 0.9 --cov-mode 1 --threads 8 ##ä»¥ä¸‹æ˜¯ä¸ºäº†ç†è§£æ­¥éª¤åšçš„ï¼Œä½¿ç”¨ä¸Šé¢ğŸ‘†çš„easyæ¨¡å¼å³å¯ #å»ºåº“ input_fa=../prodigal/C1.gene.fa DB=C1.geneDB DB_clu=mmseq_out mmseqs createdb $input_fa $DB #èšç±» mmseqs cluster $DB $DB_clu tmp \\ --min-seq-id 0.9 -c 0.9 --cov-mode 1 --threads 8 --rescore-mode 3 #è¾“å‡ºè½¬æ¢ #ç¬¬ä¸€åˆ—æ˜¯ä»£è¡¨åºåˆ—idï¼Œç¬¬äºŒåˆ—æ˜¯æˆå‘˜åºåˆ—id #mmseqs createtsv $DB $DB mmseq_out mmseq_out.tsv #mmseqs createseqfiledb $DB $DB_clu ${DB_clu}_seq #mmseqs result2flat $DB $DB ${DB_clu}_seq ${DB_clu}_seq.fasta #è·å–represent sequence mmseqs createsubdb $DB_clu $DB ${DB_clu}_rep mmseqs convert2fasta ${DB_clu}_rep ${DB_clu}_rep.fasta åŸºå› å®šé‡ï¼šsalmon å»ºç«‹ç´¢å¼• 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 #!/bin/bash #SBATCH --job-name=salmon-index #SBATCH --output=/share/home/jianglab/pengchen/work/asthma/%x_%a.out #SBATCH --error=/share/home/jianglab/pengchen/work/asthma/%x_%a.err #SBATCH --cpus-per-task=32 #SBATCH --partition=short echo start: `date +\u0026#39;%Y-%m-%d %T\u0026#39;` start=`date +%s` ############## mkdir -p temp/salmon ## å»ºç´¢å¼•, -tåºåˆ—, -i ç´¢å¼•ï¼Œ10s salmon index \\ -t NR/nucleotide.fa \\ -p 32 \\ -i temp/salmon/index ############## echo end: `date +\u0026#39;%Y-%m-%d %T\u0026#39;` end=`date +%s` echo TIME:`expr $end - $start`s å¯¹æ¯ä¸ªæ ·æœ¬å®šé‡ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 #!/bin/bash #SBATCH --job-name=salmon #SBATCH --output=/share/home/jianglab/pengchen/work/asthma/salmon/log/%x_%a.out #SBATCH --error=/share/home/jianglab/pengchen/work/asthma/salmon/log/%x_%a.err #SBATCH --array=1-33 #SBATCH --partition=cpu #SBATCH --cpus-per-task=32 echo start: `date +\u0026#39;%Y-%m-%d %T\u0026#39;` start=`date +%s` echo \u0026#34;SLURM_ARRAY_TASK_ID: \u0026#34; $SLURM_ARRAY_TASK_ID sample=$(head -n $SLURM_ARRAY_TASK_ID ~/work/asthma/data/namelist | tail -1) #sample=$(head -n 1 namelist | tail -1) echo handling: $sample #################### ## è¾“å…¥æ–‡ä»¶ï¼šå»å†—ä½™åçš„åŸºå› å’Œè›‹ç™½åºåˆ—ï¼šNR/nucleotide.fa ## è¾“å‡ºæ–‡ä»¶ï¼šSalmonå®šé‡åçš„ç»“æœï¼šsalmon/gene.count;salmon/gene.TPM ## å®šé‡ï¼Œlæ–‡åº“ç±»å‹è‡ªåŠ¨é€‰æ‹©ï¼Œpçº¿ç¨‹ï¼Œ--metaå®åŸºå› ç»„æ¨¡å¼ salmon quant \\ -i temp/salmon/index -l A -p 32 --meta \\ -1 data/alldata/${sample}_f1.fastq \\ -2 data/alldata/${sample}_r2.fastq \\ -o temp/salmon/${sample}.quant #################### echo end: `date +\u0026#39;%Y-%m-%d %T\u0026#39;` end=`date +%s` echo TIME:`expr $end - $start`s åˆå¹¶å„æ ·æœ¬ç»“æœ 1 2 3 4 5 6 7 8 9 10 11 12 ## åˆå¹¶ mkdir -p salmon salmon quantmerge \\ --quants temp/salmon/*.quant \\ -o salmon/gene.TPM salmon quantmerge \\ --quants temp/salmon/*.quant \\ --column NumReads -o salmon/gene.count sed -i \u0026#39;1 s/.quant//g\u0026#39; salmon/gene.* ## é¢„è§ˆç»“æœè¡¨æ ¼ head -n3 salmon/gene.* åŠŸèƒ½åŸºå› æ³¨é‡Š ä¸Šä¸€æ­¥å·²ç»æœ‰äº†æ‰€æœ‰çš„åŸºå› å’Œæ¯ä¸ªæ ·æœ¬æ‰€æœ‰åŸºå› çš„read countå®šé‡ç»“æœï¼Œæˆ‘ä»¬åªéœ€è¦å¯¹ä¸Šä¸€æ­¥çš„åŸºå› åºåˆ—ï¼ˆæˆ–è›‹ç™½è´¨åºåˆ—ï¼‰è¿›è¡Œä¸åŒæ•°æ®åº“çš„æ³¨é‡Šï¼ˆå¾ˆå¤šè½¯ä»¶éƒ½æ˜¯ç”¨diamondæ¯”å¯¹ï¼Œå¦‚æœæ²¡æœ‰ä¸“ç”¨è½¯ä»¶çš„æ•°æ®åº“æˆ‘ä»¬ä¹Ÿå¯ä»¥è‡ªå·±ç”¨diamondæ¯”å¯¹ï¼‰ï¼Œåˆå¹¶æ³¨é‡Šç»“æœå¾—åˆ°çš„å°±æ˜¯åŠŸèƒ½ä¸°åº¦è¡¨ã€‚\ndiamondé€‰æ‹©\u0026ndash;outfmt 6çš„è¾“å‡ºç»“æœå’Œblastpä¸€æ ·ï¼š\n1. qseqid query sequence id 2. sseqid subject (e.g., reference genome) sequence id 3. pident percentage of identical matches 4. length alignment length 5. mismatch number of mismatches 6. gapopen number of gap openings 7. qstart start of alignment in query 8. qend end of alignment in query 9. sstart start of alignment in subject 10. send end of alignment in subject 11. evalue expect value 12. bitscore bit score 1 eggNOG(COG/KEGG/CAZy) EggNOGæ•°æ®åº“æ”¶é›†äº†COGï¼ˆClusters of Orthologous Groups of proteinsï¼Œç›´ç³»åŒæºè›‹ç™½ç°‡ï¼‰,æ„æˆæ¯ä¸ªCOGçš„è›‹ç™½éƒ½æ˜¯è¢«å‡å®šä¸ºæ¥è‡ªäºä¸€ä¸ªç¥–å…ˆè›‹ç™½ï¼Œå› æ­¤æ˜¯orthologsæˆ–è€…æ˜¯paralogsã€‚é€šè¿‡æŠŠæ‰€æœ‰å®Œæ•´åŸºå› ç»„çš„ç¼–ç è›‹ç™½ä¸€ä¸ªä¸€ä¸ªçš„äº’ç›¸æ¯”è¾ƒç¡®å®šçš„ã€‚åœ¨è€ƒè™‘æ¥è‡ªä¸€ä¸ªç»™å®šåŸºå› ç»„çš„è›‹ç™½æ—¶ï¼Œè¿™ç§æ¯”è¾ƒå°†ç»™å‡ºæ¯ä¸ªå…¶ä»–åŸºå› ç»„çš„ä¸€ä¸ªæœ€ç›¸ä¼¼çš„è›‹ç™½ï¼ˆå› æ­¤éœ€è¦ç”¨å®Œæ•´çš„åŸºå› ç»„æ¥å®šä¹‰COGï¼‰ï¼Œè¿™äº›åŸºå› çš„æ¯ä¸€ä¸ªéƒ½è½®ç•ªåœ°è¢«è€ƒè™‘ã€‚å¦‚æœåœ¨è¿™äº›è›‹ç™½ï¼ˆæˆ–å­é›†ï¼‰ä¹‹é—´ä¸€ä¸ªç›¸äº’çš„æœ€ä½³åŒ¹é…å…³ç³»è¢«å‘ç°ï¼Œé‚£ä¹ˆé‚£äº›ç›¸äº’çš„æœ€ä½³åŒ¹é…å°†å½¢æˆä¸€ä¸ªCOGã€‚è¿™æ ·ï¼Œä¸€ä¸ªCOGä¸­çš„æˆå‘˜å°†ä¸è¿™ä¸ªCOGä¸­çš„å…¶ä»–æˆå‘˜æ¯”èµ·è¢«æ¯”è¾ƒçš„åŸºå› ç»„ä¸­çš„å…¶ä»–è›‹ç™½æ›´ç›¸åƒã€‚\nEggNOGé‡Œé¢åŒ…å«äº†GOï¼ŒKEGGï¼ŒCAZyç­‰ã€‚\n1 2 3 4 5 6 7 8 9 ## ä¸‹è½½å¸¸ç”¨æ•°æ®åº“ï¼Œæ³¨æ„è®¾ç½®ä¸‹è½½ä½ç½® mkdir -p ${db}/eggnog5 \u0026amp;\u0026amp; cd ${db}/eggnog5 ## -yé»˜è®¤åŒæ„ï¼Œ-få¼ºåˆ¶ä¸‹è½½ï¼Œeggnog.db.gz 7.9G+4.9G download_eggnog_data.py -y -f --data_dir ./ ## ä¸‹è½½æ–¹å¼2(å¯é€‰)ï¼šé“¾æ¥ç›´æ¥ä¸‹è½½ wget -c http://eggnog5.embl.de/download/emapperdb-5.0.0/eggnog.db.gz ## 7.9G wget -c http://eggnog5.embl.de/download/emapperdb-5.0.0/eggnog_proteins.dmnd.gz ## 4.9G gunzip *.gz 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 #!/bin/bash #SBATCH --job-name=eggo #SBATCH --output=/share/home/jianglab/pengchen/work/asthma/%x_%j.out #SBATCH --error=/share/home/jianglab/pengchen/work/asthma/%x_%j.err #SBATCH --cpus-per-task=32 #SBATCH --partition=cpu echo start: `date +\u0026#39;%Y-%m-%d %T\u0026#39;` start=`date +%s` ############## #åˆ‡æ¢ç¯å¢ƒ ## diamondæ¯”å¯¹åŸºå› è‡³eggNOG 5.0æ•°æ®åº“, 1~9hï¼Œé»˜è®¤diamond 1e-3 mkdir -p temp/eggnog emapper.py --no_annot --no_file_comments --override \\ --data_dir ~/db/eggnog5 \\ -i NR/protein.fa \\ --cpu 32 -m diamond \\ -o temp/eggnog/protein ## æ¯”å¯¹ç»“æœåŠŸèƒ½æ³¨é‡Š, 1h emapper.py \\ --annotate_hits_table temp/eggnog/protein.emapper.seed_orthologs \\ --data_dir ~/db/eggnog5 \\ --cpu 32 --no_file_comments --override \\ -o temp/eggnog/output ## æ·»è¡¨å¤´, 1åˆ—ä¸ºIDï¼Œ9åˆ—KOï¼Œ16åˆ—CAZyï¼Œ21åˆ—COGï¼Œ22åˆ—æè¿° sed \u0026#39;1 i Name\\tortholog\\tevalue\\tscore\\ttaxonomic\\tprotein\\tGO\\tEC\\tKO\\tPathway\\tModule\\tReaction\\trclass\\tBRITE\\tTC\\tCAZy\\tBiGG\\ttax_scope\\tOG\\tbestOG\\tCOG\\tdescription\u0026#39; \\ temp/eggnog/output.emapper.annotations \\ \u0026gt; temp/eggnog/output ############## echo end: `date +\u0026#39;%Y-%m-%d %T\u0026#39;` end=`date +%s` echo TIME:`expr $end - $start`s 2 ç¢³æ°´åŒ–åˆç‰©dbCAN2 1 2 3 4 5 6 7 8 9 10 11 12 13 14 ## dbCAN2 http://bcb.unl.edu/dbCAN2 ## åˆ›å»ºæ•°æ®åº“å­˜æ”¾ç›®å½•å¹¶è¿›å…¥ mkdir -p ${db}/dbCAN2 \u0026amp;\u0026amp; cd ${db}/dbCAN2 ## ä¸‹è½½åºåˆ—å’Œæè¿° wget -c http://bcb.unl.edu/dbCAN2/download/CAZyDB.07312020.fa wget -c http://bcb.unl.edu/dbCAN2/download/Databases/CAZyDB.07302020.fam-activities.txt ## å¤‡ç”¨æ•°æ®åº“ä¸‹è½½åœ°å€å¹¶è§£å‹ #wget -c http://210.75.224.110/db/dbcan2/CAZyDB.07312020.fa.gz #gunzip CAZyDB.07312020.fa.gz ## diamondå»ºç´¢å¼•ï¼Œ800Mï¼Œ1m diamond --version ## 0.8.22/2.0.5 time diamond makedb \\ --in CAZyDB.07312020.fa \\ --db CAZyDB.07312020 1 2 3 4 5 6 7 8 ## æ¯”å¯¹CAZyæ•°æ®åº“, ç”¨æ—¶2~18m; åŠ --sensitiveæ›´å…¨ä½†æ…¢è‡³1h mkdir -p temp/dbcan2 diamond blastp \\ --db ~/db/dbcan2/CAZyDB.07312020 \\ --query NR/protein.fa \\ --threads 64 -e 1e-5 --outfmt 6 \\ --max-target-seqs 1 --quiet \\ --out temp/dbcan2/gene_diamond.f6 3 ARGsï¼ˆCARDï¼‰ ## Github: https://github.com/arpcard/rgi\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 #!/bin/bash #SBATCH --job-name=rgi #SBATCH --output=/share/home/jianglab/pengchen/work/asthma/%x_%a.out #SBATCH --error=/share/home/jianglab/pengchen/work/asthma/%x_%a.err #SBATCH --cpus-per-task=32 #SBATCH --partition=cpu echo start: `date +\u0026#39;%Y-%m-%d %T\u0026#39;` start=`date +%s` ############## mkdir -p card rgi main --input_sequence ~/work/asthma/temp/protein.fa \\ --output_file card/protein \\ --input_type protein --num_threads 32 \\ --clean --alignment_tool DIAMOND ############## echo end: `date +\u0026#39;%Y-%m-%d %T\u0026#39;` end=`date +%s` echo TIME:`expr $end - $start`s 4 æ¯’åŠ›å› å­VFDB å®˜ç½‘åœ°å€ï¼šhttp://www.mgc.ac.cn/VFs/ åœ¨å®˜ç½‘ä¸‹è½½æ•°æ®åº“æ—¶ï¼Œå¸¦æœ‰setA çš„åº“ä¸ºVFDBæ•°æ®åº“æ ¸å¿ƒåº“(set A)ï¼Œè€ŒsetBä¸ºå…¨åº“(setB), å…¶ä¸­setAä»…åŒ…å«ç»å®éªŒéªŒè¯è¿‡çš„æ¯’åŠ›åŸºå› ï¼Œè€ŒsetBåˆ™åœ¨setAçš„åŸºç¡€ä¸Šå¢åŠ äº†é¢„æµ‹çš„æ¯’åŠ›åŸºå› ï¼Œé€‰æ‹©å¥½æ•°æ®åº“åï¼Œç›´æ¥ç”¨blast/diamondå³å¯å®Œæˆæ³¨é‡Šã€‚\n1 2 3 4 5 6 7 mkdir -p temp/vfdb diamond blastp \\ --db ~/db/VFDB/VFDB_setB_pro \\ --query NR/protein.fa \\ --threads 32 -e 1e-5 --outfmt 6 \\ --max-target-seqs 1 --quiet \\ --out temp/vfdb/gene_diamond.f6 5 å…¶ä»–å„ç§æ•°æ®åº“ åŠŸèƒ½æ³¨é‡Šåˆå¹¶ å†™ä¸€ä¸ªpythonè„šæœ¬ï¼Œå°†è¡¨1ï¼ˆåŸºå› -åŠŸèƒ½çš„å¯¹åº”è¡¨ï¼‰ä¸è¡¨2ï¼ˆåŸºå› ä¸°åº¦è¡¨ï¼‰åˆå¹¶ï¼Œå³ä¸åŒåŸºå› å¯èƒ½æ³¨é‡Šåˆ°ç›¸åŒåŠŸèƒ½ï¼ŒæŠŠå®ƒä»¬çš„ä¸°åº¦åŠ åœ¨ä¸€èµ·å¾—åˆ°æ–°è¡¨3ï¼ˆåŠŸèƒ½ä¸°åº¦è¡¨ï¼‰\nbinning å®åŸºå› ç»„binningæ˜¯æŒ‡å°†ä¸åŒçš„åºåˆ—é›†åˆï¼ˆå¦‚metagenomeåºåˆ—é›†åˆï¼‰æ ¹æ®å®ƒä»¬çš„ç‰©ç§å½’ç±»åˆ°ä¸åŒçš„binsä¸­ï¼Œä»¥ä¾¿è¿›ä¸€æ­¥ç ”ç©¶å®ƒä»¬çš„ç»„æˆå’ŒåŠŸèƒ½ã€‚è¿™ä¸ªè¿‡ç¨‹å¯ä»¥å°†ç±»ä¼¼çš„åºåˆ—ç»„åˆåœ¨ä¸€èµ·ï¼Œå½¢æˆä»£è¡¨ä¸åŒç‰©ç§æˆ–åŸºå› ç»„çš„binsï¼Œä»¥ä¾¿è¿›è¡Œåç»­åˆ†æï¼Œå¦‚ç‰©ç§æ³¨é‡Šã€åŸºå› ç»„ç»„è£…ç­‰ã€‚\nä»¥ä¸‹æ˜¯å¸¸ç”¨çš„å®åŸºå› ç»„binningæ–¹æ³•ï¼š\nåŸºäºèšç±»çš„æ–¹æ³•ï¼šè¯¥æ–¹æ³•ä½¿ç”¨åºåˆ—èšç±»å°†ç›¸ä¼¼åºåˆ—åˆ†åˆ°åŒä¸€ä¸ªbinä¸­ã€‚ä¸€èˆ¬æ¥è¯´ï¼Œèšç±»ç®—æ³•å¯åˆ†ä¸ºä¸¤ç±»ï¼šæ— ç›‘ç£èšç±»ï¼ˆå¦‚k-meansã€DBSCANç­‰ï¼‰å’Œæœ‰ç›‘ç£èšç±»ï¼ˆå¦‚CAMIã€MyCCç­‰ï¼‰ã€‚\nåŸºäºç»„è£…çš„æ–¹æ³•ï¼šè¯¥æ–¹æ³•ä½¿ç”¨de novoç»„è£…æ¥å°†ç›¸ä¼¼åºåˆ—ç»„è£…æˆè¿ç»­çš„åºåˆ—ï¼Œå†æ ¹æ®è¿™äº›åºåˆ—çš„åŸºå› ç»„ä¿¡æ¯æ¥å°†å…¶åˆ†ç±»åˆ°ä¸åŒçš„binsä¸­ã€‚è¿™ç§æ–¹æ³•çš„ä¼˜ç‚¹æ˜¯å¯ä»¥æ›´å¥½åœ°å¤„ç†é‡å¤åºåˆ—ï¼Œç¼ºç‚¹æ˜¯éœ€è¦å¤§é‡çš„è®¡ç®—èµ„æºå’Œæ—¶é—´ã€‚\nåŸºäºåˆ†ç±»å™¨çš„æ–¹æ³•ï¼šè¯¥æ–¹æ³•ä½¿ç”¨æœºå™¨å­¦ä¹ åˆ†ç±»å™¨æ¥å°†åºåˆ—åˆ†é…åˆ°ä¸åŒçš„binsä¸­ã€‚è¿™ç§æ–¹æ³•çš„ä¼˜ç‚¹æ˜¯å¯ä»¥è‡ªåŠ¨å­¦ä¹ ç‰¹å¾å¹¶åœ¨å¤„ç†å¤§è§„æ¨¡æ•°æ®æ—¶æ•ˆç‡é«˜ï¼Œç¼ºç‚¹æ˜¯éœ€è¦å…ˆå»ºç«‹ä¸€ä¸ªåˆ†ç±»å™¨å¹¶è¿›è¡Œè®­ç»ƒã€‚\nåœ¨è¿›è¡Œå®åŸºå› ç»„binningæ—¶ï¼Œé€šå¸¸éœ€è¦ä½¿ç”¨å¤šä¸ªæ–¹æ³•è¿›è¡Œæ¯”è¾ƒï¼Œä»¥é€‰æ‹©æœ€é€‚åˆæ•°æ®é›†çš„æ–¹æ³•ã€‚å¯ä»¥ä½¿ç”¨ä¸€äº›æµè¡Œçš„å·¥å…·æ¥è¿›è¡Œbinningï¼Œå¦‚MetaBATã€MaxBinã€CONCOCTå’ŒMEGANç­‰ã€‚è¿™äº›å·¥å…·é€šå¸¸åŒ…å«å„ç§binningæ–¹æ³•ï¼Œå¯ä»¥æ ¹æ®æ•°æ®é›†å’Œåˆ†æç›®çš„é€‰æ‹©é€‚åˆçš„æ–¹æ³•ã€‚\nç¯‡å¹…é™åˆ¶ï¼Œå…·ä½“çš„æ–¹æ³•æ”¾åœ¨å¦ä¸€ç¯‡é‡Œé¢è®²è§£å§ã€‚\nReference 1. Y.-X. Liu, Y. Qin, T. Chen, M. Lu, X. Qian, X. Guo, Y. Bai, A practical guide to amplicon and metagenomic analysis of microbiome data. Protein \u0026amp; Cell. 12, 315â€“330 (2021).\n","date":"2023-03-26T00:00:00Z","permalink":"/p/metagenomic-workflow/","title":"Metagenomic workflow"},{"content":"æ˜¥åˆ†åˆšè¿‡ï¼Œæ ¡å›­è®¸å¤šèŠ±å„¿éƒ½äº‰ç›¸ç»½æ”¾ã€‚å¤©æ°”è¿˜æ˜¯æœ‰ç‚¹å†·ï¼Œä½†è¿˜æ˜¯æƒ³è·Ÿç¾¤é’åŒå­¦ä¸€èµ·é€›é€›ç´«é‡‘æ¸¯ï¼ŒèµèµèŠ±ï¼Œè§‚è§‚é¸Ÿã€‚\nè¿™ä¸ªæ—¶å€™æ ¡å›­é‡Œæœ€å¤šçš„ä¾¿æ˜¯è”·è–‡ç§‘çš„èŠ±äº†ï¼Œè™½ç„¶æˆ‘å‘æ¥æ˜¯â€æ¡ƒæææ¢…æ¨±ï¼Œå‚»å‚»åˆ†ä¸æ¸…â€çš„ğŸ˜‚ï¼Œè¿™æ¬¡åœ¨ç¾¤é’åŒå­¦çš„å¸®åŠ©ä¸‹æ”¶é›†åˆ°äº†ä¹å®«æ ¼ï¼šèŠèŠ±æ¡ƒï¼Œç¢§æ¡ƒï¼Œå‚ä¸æµ·æ£ ï¼Œè¥¿åºœæµ·æ£ ï¼Œæ¹–åŒ—æµ·æ£ ï¼Œå¤§å²›æ¨±ï¼Œæ—¥æœ¬æ™šæ¨±ï¼Œæ—¥æœ¬æ¨±èŠ±ï¼Œè“¬è˜½(ç–‘ä¼¼)\næ—¥æœ¬æ¨±èŠ± å¤§å²›æ¨± æ—¥æœ¬æ™šæ¨± è¥¿åºœæµ·æ£  æ¹–åŒ—æµ·æ£  å‚ä¸æµ·æ£  èŠèŠ±æ¡ƒ ç¢§æ¡ƒ è“¬è˜½(ç–‘ä¼¼) æ¹–å¿ƒå²›å‡ºå‘ï¼Œå¤§ç‰‡çš„äºŒæœˆå…°ï¼Œåˆšå†’èŠ½çš„æ°´æ‰ï¼Œå·å·ç»½æ”¾çš„æ°´ä»™å’Œè´è¶èŠ±ã€‚\näºŒæœˆå…° æ°´ä»™ è´è¶èŠ± æ°´æ‰ æ—©æ¨± é¸Ÿå„¿å¤§å¤šè¿˜æ˜¯è€æœ‹å‹ï¼Œå¿«æ­¥èµ°çš„ç™½é¹¡é¸°ï¼Œæ‚ é—²çš„é»‘æ°´é¸¡å’Œæ–‘å˜´é¸­ï¼Œå¤§å–œé¹Šå’Œçº¢å˜´è“é¹Šï¼Œä¸€åªæ­Œå£°å©‰è½¬çš„ä¹Œé¸«ã€‚æœ¬æ¥è¿™æ¬¡æœ€æƒ³çœ‹åˆ°çš„å°±æ˜¯ç½•è§æ—…å®¢é»‘ç¿…é•¿è„šé¹¬çš„ï¼Œä½†æ˜¯è¿™å„¿æœç„¶åªæ˜¯å®ƒä»¬æ­‡æ­‡è„šçš„åœ°æ–¹ï¼Œæ²¡èƒ½è§åˆ°ğŸ˜­ï¼Œå·æµ™å¤§å®˜å¾®çš„ç¾å›¾ï¼Œå“ˆå“ˆã€‚å—èŠ±å›­è¿˜æ˜¯å¤œé¹­ä¸ç™½é¹­ä»¬çš„é¢†åœ°ã€‚\nç™½é¹¡é¸° é»‘æ°´é¸¡ æ–‘å˜´é¸­ å–œé¹Š å¤œé¹­ ä¹Œé¸« é»‘ç¿…é•¿è„šé¹¬ ï¼ˆæµ™æ±Ÿå¤§å­¦Bç«™å·ï¼‰ çº¢å˜´è“é¹Š ç”Ÿç‰©å®éªŒä¸­å¿ƒä¹‹å‰æ¯å¹´è¿™ä¸ªæ—¶å€™éƒ½æ˜¯å¤§ç‰‡æ²¹èœèŠ±ï¼Œæ‰“å¡åœ£åœ°ï¼Œä½†ä»Šå¹´çš„è¯•éªŒç”°æ¬åˆ°äº†é“¶æ³‰ï¼Œè¿™é‡Œå±…ç„¶ç§æ»¡äº†éº¦å­ï¼Œç»¿æ²¹æ²¹çš„éº¦ç”°éå¸¸æ²»æ„ˆã€‚å»å¹´çš„æ²¹èœèŠ±åº”è¯¥è¿˜ç•™ä¸‹äº†ä¸€äº›ç§å­ï¼Œè¿™ä¸ªæˆ‘å«åšå•åŒå­å¶çš„ç¢°æ’ã€‚\nå•åŒå­å¶çš„ç¢°æ’ æƒŠå–œå‡ºç°åœ¨éº¦ç”°çš„æ‹è§’å¤„ï¼Œå‡ åªå¯çˆ±çš„å•¾å•¾æ­£åœ¨å·éº¦å­åƒï¼ŒåŸæ¥æ˜¯ç™½è…°æ–‡é¸Ÿï¼Œä¸Šæ¬¡è§å®ƒä¹Ÿæ˜¯åœ¨å·åƒç”Ÿç§‘é™¢çš„å®éªŒæ°´ç¨»ã€‚ç«™åœ¨ç´«è†ä¸›ä¸­çš„æ–‡é¸Ÿè¶…æœ‰æ°”è´¨ã€‚\nå…¶ä»–ä¸€äº›ç¬é—´ï¼ŒåŒ»å­¦é™¢çš„ä¸€æ’æ¨±èŠ±ï¼ŒLYåŒå­¦æœ€èµçš„ä¸€æ ªæ¨±èŠ±ï¼Œå·²ç»åƒäº†å››å¹´è¿˜è¦å†åƒå››å¹´çš„éº¦é¦™ï¼Œæ™¶è¹çš„æ°´ç â€¦\nåŒ»å­¦é™¢ è¯å­¦é™¢ åŒ»å›¾ éº¦é¦™ æ„Ÿè°¢ç¾¤é’åŒå­¦çš„æ‘„å½±ï¼Œè¶Šæ¥è¶Šå¼ºäº†ğŸ‘ã€‚ä¸‹ä¸€ä¸ªå­£èŠ‚å†æ¥çœ‹çœ‹ã€‚\n","date":"2023-03-25T00:00:00Z","image":"/p/%E7%B4%AB%E9%87%91%E6%98%A5%E6%97%A5/images/%E8%A5%BF%E5%BA%9C_hu9cec70a3d2a230bf39151bcb5362fd23_124766_120x120_fill_q75_box_smart1.jpg","permalink":"/p/%E7%B4%AB%E9%87%91%E6%98%A5%E6%97%A5/","title":"ç´«é‡‘æ˜¥æ—¥"},{"content":"Introduction ç»Ÿè®¡åˆ†æåœ¨ç”Ÿç‰©ä¿¡æ¯å­¦ä¸­å…·æœ‰éå¸¸é‡è¦çš„æ„ä¹‰ï¼Œå› ä¸ºç”Ÿç‰©ä¿¡æ¯å­¦ç ”ç©¶çš„æ•°æ®é‡åºå¤§ã€å¤æ‚æ€§é«˜ï¼Œè€Œç»Ÿè®¡åˆ†æå¯ä»¥å¸®åŠ©æˆ‘ä»¬æ›´å¥½åœ°ç†è§£å’Œè§£é‡Šè¿™äº›æ•°æ®ã€‚ä¸‹é¢æ˜¯ç»Ÿè®¡åˆ†æå¯¹ç”Ÿç‰©ä¿¡æ¯å­¦çš„å‡ ä¸ªé‡è¦æ„ä¹‰ï¼š\næ•°æ®æ¸…æ´—å’Œé¢„å¤„ç†ï¼šç”Ÿç‰©ä¿¡æ¯å­¦ç ”ç©¶ä¸­ç»å¸¸éœ€è¦å¤„ç†å¤§è§„æ¨¡çš„æ•°æ®ï¼Œè€Œè¿™äº›æ•°æ®å¯èƒ½å­˜åœ¨å™ªå£°ã€é”™è¯¯å’Œç¼ºå¤±å€¼ç­‰é—®é¢˜ã€‚ç»Ÿè®¡åˆ†æå¯ä»¥å¸®åŠ©æˆ‘ä»¬å¯¹æ•°æ®è¿›è¡Œæ¸…æ´—å’Œé¢„å¤„ç†ï¼Œä»¥ç¡®ä¿æ•°æ®çš„è´¨é‡å’Œå¯é æ€§ã€‚ æ•°æ®å¯è§†åŒ–ï¼šç»Ÿè®¡åˆ†æå¯ä»¥å¸®åŠ©æˆ‘ä»¬å°†å¤æ‚çš„æ•°æ®è½¬åŒ–ä¸ºå¯è§†åŒ–å›¾å½¢ï¼Œä»è€Œæ›´å¥½åœ°ç†è§£æ•°æ®çš„åˆ†å¸ƒã€å…³ç³»å’Œè¶‹åŠ¿ã€‚è¿™äº›å›¾å½¢å¯ä»¥å¸®åŠ©æˆ‘ä»¬å‘ç°éšè—åœ¨æ•°æ®ä¸­çš„æ¨¡å¼å’Œè§„å¾‹ã€‚ æ•°æ®åˆ†æï¼šç”Ÿç‰©ä¿¡æ¯å­¦ç ”ç©¶ä¸­éœ€è¦å¯¹å¤§é‡çš„æ•°æ®è¿›è¡Œåˆ†æï¼Œä¾‹å¦‚æ¯”è¾ƒåŸºå› ç»„å­¦ã€è½¬å½•ç»„å­¦ã€è›‹ç™½è´¨ç»„å­¦ç­‰ã€‚ç»Ÿè®¡åˆ†æå¯ä»¥å¸®åŠ©æˆ‘ä»¬å¯¹æ•°æ®è¿›è¡Œå»ºæ¨¡å’Œé¢„æµ‹ï¼Œä»è€Œæ·±å…¥æ¢ç©¶ç”Ÿç‰©å­¦çš„å¤æ‚ç°è±¡å’Œæœºåˆ¶ã€‚ æ•°æ®æŒ–æ˜ï¼šç”Ÿç‰©ä¿¡æ¯å­¦ç ”ç©¶ä¸­éœ€è¦æŒ–æ˜å¤§é‡çš„æ•°æ®æ¥å‘ç°æ–°çš„ç”Ÿç‰©å­¦ç°è±¡å’Œæœºåˆ¶ã€‚ç»Ÿè®¡åˆ†æå¯ä»¥å¸®åŠ©æˆ‘ä»¬ä»æ•°æ®ä¸­æå–å‡ºæœ‰ç”¨çš„ä¿¡æ¯å’ŒçŸ¥è¯†ï¼Œè¿›è€Œæ¨åŠ¨ç”Ÿç‰©å­¦çš„ç ”ç©¶å’Œå‘å±•ã€‚ Rè¯­è¨€æ˜¯ä¸€ä¸ªä¸“é—¨ç”¨äºæ•°æ®åˆ†æå’Œç»Ÿè®¡å»ºæ¨¡çš„ç¼–ç¨‹è¯­è¨€ï¼Œå®ƒæœ‰ä»¥ä¸‹å‡ ä¸ªä¼˜ç‚¹ï¼Œä½¿å…¶æˆä¸ºåšç»Ÿè®¡åˆ†æçš„ç†æƒ³é€‰æ‹©ï¼š\nå…è´¹å’Œå¼€æºï¼šRè¯­è¨€æ˜¯ä¸€ä¸ªå…è´¹å’Œå¼€æºçš„è½¯ä»¶ï¼Œå¯ä»¥åœ¨ä¸ä»˜å‡ºé¢å¤–æˆæœ¬çš„æƒ…å†µä¸‹ä½¿ç”¨å’Œå®šåˆ¶ã€‚è¿™ä½¿å¾—è®¸å¤šå­¦ç”Ÿã€å­¦è€…å’Œæ•°æ®åˆ†æå¸ˆé€‰æ‹©Rè¯­è¨€ä½œä¸ºä»–ä»¬çš„é¦–é€‰ç»Ÿè®¡åˆ†æå·¥å…·ã€‚\nå¼ºå¤§çš„æ•°æ®å¤„ç†èƒ½åŠ›ï¼šRè¯­è¨€å…·æœ‰å¼ºå¤§çš„æ•°æ®å¤„ç†èƒ½åŠ›ï¼Œæ”¯æŒå¤šç§æ•°æ®ç»“æ„å’Œæ•°æ®ç±»å‹ï¼Œå¯ä»¥è½»æ¾åœ°è¿›è¡Œæ•°æ®æ¸…æ´—ã€æ•´åˆã€å˜æ¢å’Œåˆ†æã€‚\nä¸°å¯Œçš„ç»Ÿè®¡åˆ†æå‡½æ•°åº“ï¼šRè¯­è¨€å…·æœ‰ä¸°å¯Œçš„ç»Ÿè®¡åˆ†æå‡½æ•°åº“ï¼ŒåŒ…æ‹¬çº¿æ€§å›å½’ã€é€»è¾‘å›å½’ã€èšç±»åˆ†æã€ä¸»æˆåˆ†åˆ†æã€æ—¶é—´åºåˆ—åˆ†æç­‰ç­‰ã€‚è¿™äº›å‡½æ•°åº“æä¾›äº†è®¸å¤šå¸¸ç”¨çš„ç»Ÿè®¡åˆ†ææ–¹æ³•ï¼Œå¯ä»¥æ»¡è¶³ä¸åŒæ•°æ®åˆ†æéœ€æ±‚ã€‚\nå›¾å½¢å¯è§†åŒ–åŠŸèƒ½ï¼šRè¯­è¨€å…·æœ‰å¼ºå¤§çš„å›¾å½¢å¯è§†åŒ–åŠŸèƒ½ï¼Œå¯ä»¥è½»æ¾åœ°åˆ›å»ºå„ç§ç±»å‹çš„å›¾è¡¨ï¼ŒåŒ…æ‹¬æ•£ç‚¹å›¾ã€æ¡å½¢å›¾ã€æŠ˜çº¿å›¾ã€çƒ­å›¾ç­‰ã€‚è¿™äº›å›¾è¡¨å¯ä»¥å¸®åŠ©æ•°æ®åˆ†æå¸ˆæ›´å¥½åœ°ç†è§£æ•°æ®ã€å‘ç°è§„å¾‹å’Œæå–ä¿¡æ¯ã€‚\nç¤¾åŒºæ”¯æŒå’Œç”Ÿæ€ç³»ç»Ÿï¼šRè¯­è¨€æ‹¥æœ‰åºå¤§çš„ç”¨æˆ·ç¤¾åŒºå’Œç”Ÿæ€ç³»ç»Ÿï¼Œç”¨æˆ·å¯ä»¥è½»æ¾åœ°æ‰¾åˆ°å¹¶ä½¿ç”¨æ•°åƒç§å¯ç”¨çš„ç»Ÿè®¡åˆ†æå·¥å…·å’ŒRåŒ…ï¼Œè¿™äº›å·¥å…·å’ŒRåŒ…å¯ä»¥å¸®åŠ©ç”¨æˆ·æ›´åŠ é«˜æ•ˆåœ°å®Œæˆç»Ÿè®¡åˆ†æä»»åŠ¡ã€‚\næˆ‘æƒ³åœ¨è¿™é‡Œç¨å¾®è®°å½•ä¸€ä¸‹æˆ‘ä½¿ç”¨Rå¸¸ç”¨çš„ä¸€äº›åˆç­‰ç»Ÿè®¡åˆ†ææ–¹æ³•ï¼Œå¦‚å›å½’ï¼Œæ–¹å·®åˆ†æï¼Œå¹¿ä¹‰çº¿æ€§æ¨¡å‹ç­‰ï¼Œä¸»è¦å‚è€ƒèµ„æ–™æ˜¯ã€ŠRè¯­è¨€æ•™ç¨‹ã€‹ VIIéƒ¨åˆ†ç»Ÿè®¡åˆ†æçš„å†…å®¹ã€‚\nStatistics åŸºç¡€ç”¨æ³• å•æ ·æœ¬å‡å€¼æ£€éªŒ 1 2 3 4 5 6 7 ?t.test() #install.packages(\u0026#34;ggstatsplot\u0026#34;,dependencies = T) library(ggstatsplot) #è¿™ä¸ªåŒ…ä¼šåœ¨ç”»å›¾çš„è¿‡ç¨‹ä¸­è®¡ç®—å¾ˆå¤šç»Ÿè®¡é‡ï¼Œå¸®æˆ‘ä»¬æ›´å¥½åœ°æŠŠæ¡æ•°æ®çš„æ€§è´¨ #æ¯”å¦‚æˆ‘ä»¬æƒ³çœ‹tooth lengthå‡å€¼æ˜¯å¦å’Œ25æœ‰æ˜¾è‘—å·®å¼‚ t.test(ToothGrowth$len,mu = 25,alternative = \u0026#34;two.sided\u0026#34;) ## ## One Sample t-test ## ## data: ToothGrowth$len ## t = -6.2648, df = 59, p-value = 0.00000004681 ## alternative hypothesis: true mean is not equal to 25 ## 95 percent confidence interval: ## 16.83731 20.78936 ## sample estimates: ## mean of x ## 18.81333 1 2 3 4 5 6 gghistostats( data = ToothGrowth, x = len, xlab = \u0026#34;Tooth length\u0026#34;, test.value = 25 ) æ£€éªŒçš„åŠŸæ•ˆï¼Œ æ˜¯æŒ‡å¯¹ç«‹å‡è®¾æˆç«‹æ—¶æ£€éªŒæ‹’ç»$H_0$çš„æ¦‚ç‡$1-\\beta$ï¼Œ å…¶ä¸­$\\beta$æ˜¯ç¬¬äºŒç±»é”™è¯¯ï¼Œ å³å½“å¯¹ç«‹å‡è®¾æˆç«‹æ—¶é”™è¯¯åœ°æ¥å—$H_0$çš„æ¦‚ç‡ã€‚ éœ€è¦è¶³å¤Ÿå¤§çš„æ ·æœ¬é‡æ‰èƒ½ä½¿å¾—æ£€éªŒèƒ½å¤Ÿå‘ç°å®é™…å­˜åœ¨çš„æ˜¾è‘—å·®å¼‚ã€‚\n1 2 3 4 5 6 7 pwr::pwr.t.test( type = \u0026#34;one.sample\u0026#34;, alternative=\u0026#34;greater\u0026#34;, d = (7.25 - 7.0)/1.052, sig.level = 0.05, power = 0.80 ) |\u0026gt; plot() å‡å€¼æ¯”è¾ƒ ç‹¬ç«‹ä¸¤æ ·æœ¬tæ£€éªŒ\n1 t.test(mpg~am,data = mtcars) ## ## Welch Two Sample t-test ## ## data: mpg by am ## t = -3.7671, df = 18.332, p-value = 0.001374 ## alternative hypothesis: true difference in means between group 0 and group 1 is not equal to 0 ## 95 percent confidence interval: ## -11.280194 -3.209684 ## sample estimates: ## mean in group 0 mean in group 1 ## 17.14737 24.39231 1 ggbetweenstats(mtcars, am, mpg) æ¯”ä¾‹æ£€éªŒ 1 2 #æŠ½æŸ¥400ä¸ªæ ·æœ¬100ä¸ªå¼‚å¸¸ï¼Œå¼‚å¸¸æ¯”ä¾‹æ˜¯å¦æ˜¾è‘—å¤§äº0.2 prop.test(100, 400, p=0.20, alternative = \u0026#34;greater\u0026#34;) ## ## 1-sample proportions test with continuity correction ## ## data: 100 out of 400, null probability 0.2 ## X-squared = 5.9414, df = 1, p-value = 0.007395 ## alternative hypothesis: true p is greater than 0.2 ## 95 percent confidence interval: ## 0.2149649 1.0000000 ## sample estimates: ## p ## 0.25 1 2 #ä¸¤æ¬¡æŠ½æŸ¥çš„æ¯”ä¾‹æ˜¯å¦ä¸€è‡´ prop.test(c(35,27), c(250,300), alternative = \u0026#34;two.sided\u0026#34;) ## ## 2-sample test for equality of proportions with continuity correction ## ## data: c(35, 27) out of c(250, 300) ## X-squared = 2.9268, df = 1, p-value = 0.08712 ## alternative hypothesis: two.sided ## 95 percent confidence interval: ## -0.007506845 0.107506845 ## sample estimates: ## prop 1 prop 2 ## 0.14 0.09 æ–¹å·®çš„å‡è®¾æ£€éªŒ æ£€æŸ¥ä¸¤ç»„æ•°æ®çš„æ–¹å·®æœ‰è¯¯æ˜¾è‘—å·®å¼‚ï¼Ÿ\n1 2 3 4 var.test(c( 20.5, 18.8, 19.8, 20.9, 21.5, 19.5, 21.0, 21.2), c( 17.7, 20.3, 20.0, 18.8, 19.0, 20.1, 20.2, 19.1), alternative = \u0026#34;two.sided\u0026#34;) ## ## F test to compare two variances ## ## data: c(20.5, 18.8, 19.8, 20.9, 21.5, 19.5, 21, 21.2) and c(17.7, 20.3, 20, 18.8, 19, 20.1, 20.2, 19.1) ## F = 1.069, num df = 7, denom df = 7, p-value = 0.9322 ## alternative hypothesis: true ratio of variances is not equal to 1 ## 95 percent confidence interval: ## 0.214011 5.339386 ## sample estimates: ## ratio of variances ## 1.068966 æ‹Ÿåˆä¼˜åº¦æ£€éªŒ 1 2 #6ç±»faceçš„countæ¯”ä¾‹æ˜¯å¦ç›¸ç­‰ï¼Œå¡æ–¹æ£€éªŒ chisq.test(c(168, 159, 168, 180, 167, 158)) ## ## Chi-squared test for given probabilities ## ## data: c(168, 159, 168, 180, 167, 158) ## X-squared = 1.892, df = 5, p-value = 0.8639 1 2 3 4 5 6 7 ggpiestats( data = data.frame(face=1:6, counts=c(168, 159, 168, 180, 167, 158)), x = face, counts = counts, title = \u0026#34;Dice equality\u0026#34; ) 1 2 #å„ç±»æ¯”ä¾‹æ˜¯å¦ä¸ºæŒ‡å®šå€¼ chisq.test(c(48, 98, 54), p=c(0.3, 0.5, 0.2)) ## ## Chi-squared test for given probabilities ## ## data: c(48, 98, 54) ## X-squared = 7.34, df = 2, p-value = 0.02548 æ£€éªŒåˆ†å¸ƒç±»å‹ vcdåŒ…æä¾›äº†ä¸€ä¸ªgoodfitå‡½æ•°ï¼Œ å¯ä»¥ç”¨æ¥æ‹ŸåˆæŒ‡å®šçš„æŸç§ç†è®ºåˆ†å¸ƒ(åŒ…æ‹¬æ³Šæ¾ã€äºŒé¡¹ã€è´ŸäºŒé¡¹åˆ†å¸ƒï¼‰ï¼Œ å¹¶æ£€éªŒæœä»è¯¥ç†è®ºåˆ†å¸ƒçš„é›¶å‡è®¾ã€‚\n1 2 3 set.seed(101) datax \u0026lt;- rpois(100, 2) summary(vcd::goodfit(datax, \u0026#34;poisson\u0026#34;)) ## ## Goodness-of-fit test for poisson distribution ## ## X^2 df P(\u0026gt; X^2) ## Likelihood Ratio 4.289456 5 0.5085374 ç‹¬ç«‹æ€§å¡æ–¹æ£€éªŒ 1 2 3 4 5 6 ctab.beer \u0026lt;- rbind(c( 20, 40, 20), c(30,30,10)) colnames(ctab.beer) \u0026lt;- c(\u0026#34;Light\u0026#34;, \u0026#34;Regular\u0026#34;, \u0026#34;Dark\u0026#34;) rownames(ctab.beer) \u0026lt;- c(\u0026#34;Male\u0026#34;, \u0026#34;Female\u0026#34;) addmargins(ctab.beer) ## Light Regular Dark Sum ## Male 20 40 20 80 ## Female 30 30 10 70 ## Sum 50 70 30 150 1 2 #åˆ—è”è¡¨ç‹¬ç«‹æ€§æ£€éªŒï¼š chisq.test(ctab.beer) ## ## Pearson's Chi-squared test ## ## data: ctab.beer ## X-squared = 6.1224, df = 2, p-value = 0.04683 1 #åœ¨0.05æ°´å¹³ä¸‹è®¤ä¸ºå•¤é…’ç±»å‹åå¥½ä¸æ€§åˆ«æœ‰å…³ éå‚æ•°æ£€éªŒ å¸¸ç”¨çš„æœ‰ç‹¬ç«‹ä¸¤æ ·æœ¬æ¯”è¾ƒçš„Wilcoxonç§©å’Œæ£€éªŒï¼Œ å•æ ·æœ¬çš„ç¬¦å·ç§©æ£€éªŒå’Œç¬¦å·æ£€éªŒç­‰\n1 2 3 x \u0026lt;- c(0.80, 0.83, 1.89, 1.04, 1.45, 1.38, 1.91, 1.64, 0.73, 1.46) y \u0026lt;- c(1.15, 0.88, 0.90, 0.74, 1.21) wilcox.test(x,mu = 0.7) ## ## Wilcoxon signed rank exact test ## ## data: x ## V = 55, p-value = 0.001953 ## alternative hypothesis: true location is not equal to 0.7 1 wilcox.test(x, y, alternative = \u0026#34;g\u0026#34;) ## ## Wilcoxon rank sum exact test ## ## data: x and y ## W = 35, p-value = 0.1272 ## alternative hypothesis: true location shift is greater than 0 å›å½’åˆ†æ ç›¸å…³åˆ†æ Pearsonç›¸å…³ç³»æ•°ï¼š $$ \\rho(X,Y)=\\frac{E[(X-E(X))(Y-E(Y))]}{\\sqrt{Var(X)Var(Y)}} $$ ç›¸å…³ç³»æ•°ç»å¯¹å€¼åœ¨0.8ä»¥ä¸Šè®¤ä¸ºé«˜åº¦ç›¸å…³ã€‚ åœ¨0.5åˆ°0.8ä¹‹é—´è®¤ä¸ºä¸­åº¦ç›¸å…³ã€‚ åœ¨0.3åˆ°0.5ä¹‹é—´è®¤ä¸ºä½åº¦ç›¸å…³ã€‚ åœ¨0.3ä»¥ä¸‹è®¤ä¸ºä¸ç›¸å…³æˆ–ç›¸å…³æ€§å¾ˆå¼±ä»¥è‡³äºæ²¡æœ‰å®é™…ä»·å€¼ã€‚ å½“ç„¶ï¼Œåœ¨ç‰¹åˆ«é‡è¦çš„é—®é¢˜ä¸­ï¼Œ åªè¦ç»è¿‡æ£€éªŒæ˜¾è‘—ä¸ç­‰äºé›¶çš„ç›¸å…³éƒ½è®¤ä¸ºæ˜¯æœ‰æ„ä¹‰çš„ã€‚\nç›¸å…³ç³»æ•°æ£€éªŒï¼š\næ£€éªŒç»Ÿè®¡é‡: $$ t=\\frac{r\\sqrt{n-2}}{\\sqrt{1-r^2}} $$ på€¼ä¸ºï¼š$P(|t(n-2)|\u0026gt;|t_0|)$\n1 2 3 4 5 6 7 set.seed(1) x \u0026lt;- runif(30, 0, 10) xx \u0026lt;- seq(0, 10, length.out = 100) y \u0026lt;- 40 - (x-7)^2 + rnorm(30) yy \u0026lt;- 40 - (xx-7)^2 plot(x, y, pch=16) lines(xx, yy) 1 cor(x,y,method = \u0026#34;pearson\u0026#34;) ## [1] 0.8244374 1 cor.test(x,y,method = \u0026#34;pearson\u0026#34;) ## ## Pearson's product-moment correlation ## ## data: x and y ## t = 7.7083, df = 28, p-value = 0.00000002136 ## alternative hypothesis: true correlation is not equal to 0 ## 95 percent confidence interval: ## 0.6602859 0.9134070 ## sample estimates: ## cor ## 0.8244374 1 2 3 4 5 ggstatsplot::ggscatterstats( data = data.frame(x,y), x = x, y = y ) ç›¸å…³æ€§çŸ©é˜µï¼Œ`n*n`æˆ–`n*m`çš„$r$ å’Œ$p-value$çŸ©é˜µ 1 2 3 ggstatsplot::ggcorrmat( data = mtcars ) 1 pcutils::cor_plot(mtcars) 1 corrplot::corrplot(cor(mtcars)) 1 ggcorrplot::ggcorrplot(cor(mtcars),method = \u0026#34;circle\u0026#34;) Spearmanç§©ç›¸å…³ç³»æ•° Spearman rhoç³»æ•°ï¼Œ æ˜¯ä¸¤ä¸ªå˜é‡çš„ç§©ç»Ÿè®¡é‡çš„ç›¸å…³ç³»æ•°\nKendall tauç³»æ•° å½“å˜é‡æ­£ç›¸å…³æ€§å¾ˆå¼ºæ—¶ï¼Œ ä»»æ„ä¸¤ä¸ªè§‚æµ‹çš„Xå€¼çš„å¤§å°é¡ºåºåº”è¯¥ä¸Yå€¼çš„å¤§å°é¡ºåºç›¸åŒï¼› å¦‚æœç‹¬ç«‹ï¼Œ ä¸€å¯¹è§‚æµ‹çš„Xå€¼æ¯”è¾ƒå’ŒYå€¼æ¯”è¾ƒé¡ºåºç›¸åŒä¸é¡ºåºç›¸åçš„æ•°ç›®åº”è¯¥åŸºæœ¬ç›¸åŒã€‚Kandall tauç³»æ•°ä¹Ÿæ˜¯å–å€¼äºåŒºé—´[-1,1]ï¼Œ ç”¨è¿™æ ·çš„æ€æƒ³è¡¨ç¤ºä¸¤ä¸ªå˜é‡çš„ç›¸å…³æ€§å’Œæ­£è´Ÿã€‚\n1 cor.test(x,y,method = \u0026#34;spearman\u0026#34;) ## ## Spearman's rank correlation rho ## ## data: x and y ## S = 922, p-value = 0.000001339 ## alternative hypothesis: true rho is not equal to 0 ## sample estimates: ## rho ## 0.7948832 1 cor.test(x,y,method = \u0026#34;kendall\u0026#34;) ## ## Kendall's rank correlation tau ## ## data: x and y ## T = 354, p-value = 0.000000159 ## alternative hypothesis: true tau is not equal to 0 ## sample estimates: ## tau ## 0.6275862 ä¸€å…ƒå›å½’ $$ Y=a+bX+\\varepsilon, \\varepsilon \\sim N(0,\\sigma^2) $$\næœ€å°äºŒä¹˜æ³• $$ \\hat{b}=\\frac{\\sum_i(x_i-\\overline{x})(y_i-\\overline{y})}{\\sum_i{(x-x_i)}^2}=r_{xy}\\frac{S_y}{S_x} $$\n$$ \\hat{a}=\\overline{y}-\\hat{b}\\overline{x} $$ å›å½’æœ‰æ•ˆæ€§å¯ä»¥ç”¨$R^2$å’Œ$p-valuie$æ¥åº¦é‡ï¼Œ $R^2=1-\\frac{SSE}{SST}$\nç»Ÿè®¡é‡$F=\\frac{SSR}{SSE/(n-2)}$,$p-value$ä¸º$P(F(1,n-2)\u0026gt;c)$,cä¸ºFçš„å€¼ã€‚\n1 2 lm1 \u0026lt;- lm(y ~ x) summary(lm1) ## ## Call: ## lm(formula = y ~ x) ## ## Residuals: ## Min 1Q Median 3Q Max ## -17.856 -4.549 2.141 6.048 9.664 ## ## Coefficients: ## Estimate Std. Error t value Pr(\u0026gt;|t|) ## (Intercept) 9.9855 2.6930 3.708 0.000914 *** ## x 3.5396 0.4592 7.708 0.0000000214 *** ## --- ## Signif. codes: 0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1 ## ## Residual standard error: 7.302 on 28 degrees of freedom ## Multiple R-squared: 0.6797,\tAdjusted R-squared: 0.6683 ## F-statistic: 59.42 on 1 and 28 DF, p-value: 0.00000002136 1 2 #prediction predict(lm1,newdata =data.frame(x=c(5,10,15))) ## 1 2 3 ## 27.68364 45.38182 63.08000 1 pcutils::my_lm(y,x) å¤šå…ƒå›å½’ 1 2 lm2 \u0026lt;- lm(mpg ~ cyl + disp, data=mtcars) summary(lm2) ## ## Call: ## lm(formula = mpg ~ cyl + disp, data = mtcars) ## ## Residuals: ## Min 1Q Median 3Q Max ## -4.4213 -2.1722 -0.6362 1.1899 7.0516 ## ## Coefficients: ## Estimate Std. Error t value Pr(\u0026gt;|t|) ## (Intercept) 34.66099 2.54700 13.609 4.02e-14 *** ## cyl -1.58728 0.71184 -2.230 0.0337 * ## disp -0.02058 0.01026 -2.007 0.0542 . ## --- ## Signif. codes: 0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1 ## ## Residual standard error: 3.055 on 29 degrees of freedom ## Multiple R-squared: 0.7596,\tAdjusted R-squared: 0.743 ## F-statistic: 45.81 on 2 and 29 DF, p-value: 0.000000001058 1 ggstatsplot::ggcoefstats(lm2) 1 2 #å›å½’è‡ªå˜é‡ç­›é€‰ lm3 \u0026lt;- step(lm(mpg ~ cyl + disp+hp+drat+vs, data=mtcars)) ## Start: AIC=77.08 ## mpg ~ cyl + disp + hp + drat + vs ## ## Df Sum of Sq RSS AIC ## - vs 1 0.3134 244.90 75.124 ## - cyl 1 7.6839 252.27 76.073 ## - drat 1 14.3330 258.92 76.905 ## - disp 1 14.6709 259.26 76.947 ## \u0026lt;none\u0026gt; 244.59 77.083 ## - hp 1 19.8255 264.41 77.577 ## ## Step: AIC=75.12 ## mpg ~ cyl + disp + hp + drat ## ## Df Sum of Sq RSS AIC ## - cyl 1 8.444 253.35 74.209 ## - disp 1 14.765 259.67 74.997 ## \u0026lt;none\u0026gt; 244.90 75.124 ## - drat 1 16.467 261.37 75.206 ## - hp 1 19.613 264.51 75.589 ## ## Step: AIC=74.21 ## mpg ~ disp + hp + drat ## ## Df Sum of Sq RSS AIC ## \u0026lt;none\u0026gt; 253.35 74.209 ## - drat 1 30.148 283.49 75.806 ## - disp 1 38.107 291.45 76.693 ## - hp 1 49.550 302.90 77.925 å¤šé‡å…±çº¿æ€§\nç‹­ä¹‰çš„å¤šé‡å…±çº¿æ€§ï¼ˆmulticollinearityï¼‰ï¼š è‡ªå˜é‡çš„æ•°æ®å­˜åœ¨çº¿æ€§ç»„åˆè¿‘ä¼¼åœ°ç­‰äºé›¶ï¼Œ ä½¿å¾—è§£çº¿æ€§æ–¹ç¨‹ç»„æ±‚è§£å›å½’ç³»æ•°æ—¶ç»“æœä¸ç¨³å®šï¼Œ å›å½’ç»“æœå¾ˆå·®ã€‚\nå¹¿ä¹‰çš„å¤šé‡å…±çº¿æ€§ï¼š è‡ªå˜é‡ä¹‹é—´å­˜åœ¨è¾ƒå¼ºçš„ç›¸å…³æ€§ï¼Œ è¿™æ ·è‡ªå˜é‡æ˜¯è”åŠ¨çš„ï¼Œ äº’ç›¸ä¹‹é—´æœ‰æ›¿ä»£ä½œç”¨ã€‚ ç”šè‡³äºæ–œç‡é¡¹çš„æ­£è´Ÿå·éƒ½å› ä¸ºè¿™ç§æ›¿ä»£ä½œç”¨è€Œå¯èƒ½æ˜¯é”™è¯¯çš„æ–¹å‘ã€‚\n1 2 #caråŒ…çš„vif()å‡½æ•°è®¡ç®—æ–¹å·®è†¨èƒ€å› å­ car::vif(lm3) ## disp hp drat ## 4.621988 2.868264 2.166843 éå‚æ•°å›å½’ æ‰€è°“å‚æ•°å›å½’ï¼Œ æ˜¯æŒ‡å›å½’å‡½æ•°æœ‰é¢„å…ˆç¡®å®šçš„å…¬å¼ï¼Œ ä»…éœ€è¦ä¼°è®¡çš„æœªçŸ¥å‚æ•°ï¼› éå‚æ•°å›å½’ï¼Œ å°±æ˜¯æ²¡æœ‰é¢„å…ˆç¡®å®šçš„å…¬å¼ï¼Œ çš„å½¢å¼æœ¬èº«ä¹Ÿä¾èµ–äºè¾“å…¥çš„æ ·æœ¬, ã€‚ ä¸‹é¢æè¿°çš„æ ¸å›å½’å°±æ˜¯è¿™æ ·å…¸å‹çš„éå‚æ•°å›å½’ï¼Œ æ ·æ¡å¹³æ»‘ã€æ ·æ¡å‡½æ•°å›å½’ä¸€èˆ¬ä¹Ÿçœ‹ä½œæ˜¯éå‚æ•°å›å½’ã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 #æ ·æ¡å¹³æ»‘ set.seed(1) nsamp \u0026lt;- 30 x \u0026lt;- runif(nsamp, -10, 10) xx \u0026lt;- seq(-10, 10, length.out=100) x \u0026lt;- sort(x) y \u0026lt;- 10*sin(x/10*pi)^2 + rnorm(nsamp,0,0.3) plot(x, y) curve(10*sin(x/10*pi)^2, -10, 10, add=TRUE, lwd=2) library(splines) res \u0026lt;- smooth.spline(x, y) lines(spline(res$x, res$y), col=\u0026#34;red\u0026#34;) res2 \u0026lt;- loess(y ~ x, degree=2, span=0.3) lines(xx, predict(res2, newdata=data.frame(x=xx)), col=\u0026#34;blue\u0026#34;) legend(\u0026#34;top\u0026#34;, lwd=c(2,1,1), col=c(\u0026#34;black\u0026#34;, \u0026#34;red\u0026#34;, \u0026#34;blue\u0026#34;), legend=c(\u0026#34;real data\u0026#34;, \u0026#34;smooth.spline\u0026#34;, \u0026#34;local lm\u0026#34;)) 1 2 3 4 ## çº¿æ€§å¯åŠ æ¨¡å‹ ## Ræ‰©å±•åŒ…mgcvçš„gam()å‡½æ•°å¯ä»¥æ‰§è¡Œè¿™æ ·çš„å¯åŠ æ¨¡å‹çš„éå‚æ•°å›å½’æ‹Ÿåˆã€‚ lm.rock \u0026lt;- lm(log(perm) ~ area + peri + shape, data=rock) summary(lm.rock) ## ## Call: ## lm(formula = log(perm) ~ area + peri + shape, data = rock) ## ## Residuals: ## Min 1Q Median 3Q Max ## -1.8092 -0.5413 0.1734 0.6493 1.4788 ## ## Coefficients: ## Estimate Std. Error t value Pr(\u0026gt;|t|) ## (Intercept) 5.33314499 0.54867792 9.720 1.59e-12 *** ## area 0.00048498 0.00008657 5.602 1.29e-06 *** ## peri -0.00152661 0.00017704 -8.623 5.24e-11 *** ## shape 1.75652601 1.75592362 1.000 0.323 ## --- ## Signif. codes: 0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1 ## ## Residual standard error: 0.8521 on 44 degrees of freedom ## Multiple R-squared: 0.7483,\tAdjusted R-squared: 0.7311 ## F-statistic: 43.6 on 3 and 44 DF, p-value: 3.094e-13 1 2 gam.rock1 \u0026lt;- mgcv::gam(log(perm) ~ s(area) + s(peri) + s(shape), data=rock) summary(gam.rock1) ## ## Family: gaussian ## Link function: identity ## ## Formula: ## log(perm) ~ s(area) + s(peri) + s(shape) ## ## Parametric coefficients: ## Estimate Std. Error t value Pr(\u0026gt;|t|) ## (Intercept) 5.1075 0.1222 41.81 \u0026lt;2e-16 *** ## --- ## Signif. codes: 0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1 ## ## Approximate significance of smooth terms: ## edf Ref.df F p-value ## s(area) 1.000 1.000 29.13 0.00000307 *** ## s(peri) 1.000 1.000 71.30 \u0026lt; 2e-16 *** ## s(shape) 1.402 1.705 0.58 0.437 ## --- ## Signif. codes: 0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1 ## ## R-sq.(adj) = 0.735 Deviance explained = 75.4% ## GCV = 0.78865 Scale est. = 0.71631 n = 48 1 plot(gam.rock1) æ–¹å·®åˆ†æ å•å› ç´ æ–¹å·®åˆ†æå¯ä»¥çœ‹æˆåŸºç¡€ç»Ÿè®¡ä¸­ä¸¤æ ·æœ¬tæ£€éªŒçš„ä¸€ä¸ªæ¨å¹¿ï¼Œ è¦æ¯”è¾ƒè¯•éªŒè§‚æµ‹å€¼çš„æŸä¸ªå› å˜é‡ï¼ˆç§°ä¸ºâ€œæŒ‡æ ‡â€ï¼‰æŒ‰ç…§ä¸€ä¸ªåˆ†ç»„å˜é‡ï¼ˆç§°ä¸ºâ€œå› ç´ â€ï¼‰åˆ†ç»„åï¼Œ å„ç»„çš„å› å˜é‡å‡å€¼æœ‰æ— æ˜¾è‘—å·®å¼‚ã€‚\n1 2 3 mtcars$cyl=as.factor(mtcars$cyl) aov.manu \u0026lt;- aov(mpg ~ cyl, data=mtcars) summary(aov.manu) ## Df Sum Sq Mean Sq F value Pr(\u0026gt;F) ## cyl 2 824.8 412.4 39.7 0.00000000498 *** ## Residuals 29 301.3 10.4 ## --- ## Signif. codes: 0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1 1 pcutils::group_box(mtcars[\u0026#34;mpg\u0026#34;],group = \u0026#34;cyl\u0026#34;,metadata = mtcars) 1 2 #éå‚æ•°å½¢å¼ kruskal.test(mpg ~ cyl, data=mtcars) ## ## Kruskal-Wallis rank sum test ## ## data: mpg by cyl ## Kruskal-Wallis chi-squared = 25.746, df = 2, p-value = 0.000002566 è¿›è¡Œå¤šä¸ªå‡è®¾æ£€éªŒï¼ˆå¦‚å‡å€¼æ¯”è¾ƒï¼‰çš„æ“ä½œç§°ä¸º*â€œå¤šé‡æ¯”è¾ƒâ€*ï¼ˆmultiple comparisonï¼Œ æˆ–multiple testingï¼‰ï¼Œ å¤šæ¬¡æ£€éªŒä¼šä½¿å¾—æ€»ç¬¬ä¸€ç±»é”™è¯¯æ¦‚ç‡å¢å¤§ã€‚\n1 pcutils::multitest(mtcars$mpg,mtcars$cyl) ## ====================================1.ANOVA:==================================== ## Df Sum Sq Mean Sq F value Pr(\u0026gt;F) ## group 2 824.8 412.4 39.7 0.00000000498 *** ## Residuals 29 301.3 10.4 ## --- ## Signif. codes: 0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1 ## ================================2.Kruskal.test:================================ ## ## Kruskal-Wallis rank sum test ## ## data: var by group ## Kruskal-Wallis chi-squared = 25.746, df = 2, p-value = 0.000002566 ## ## ==========================3.LSDtest, bonferroni p-adj:========================== ## var groups ## 4 26.66364 a ## 6 19.74286 b ## 8 15.10000 c ## ==================================4.tukeyHSD:================================== ## Tukey multiple comparisons of means ## 95% family-wise confidence level ## ## Fit: aov(formula = var ~ group) ## ## $group ## diff lwr upr p adj ## 6-4 -6.920779 -10.769350 -3.0722086 0.0003424 ## 8-4 -11.563636 -14.770779 -8.3564942 0.0000000 ## 8-6 -4.642857 -8.327583 -0.9581313 0.0112287 ## ## =================================5.Wilcox-test:================================= ## 4 6 8 ## 4 1.00000000000 0.0006658148 0.00002774715 ## 6 0.00066581478 1.0000000000 0.00101304469 ## 8 0.00002774715 0.0010130447 1.00000000000 å¹¿ä¹‰çº¿æ€§æ¨¡å‹ æ³Šæ¾å›å½’ 1 2 3 4 5 6 counts \u0026lt;- c(18,17,15,20,10,20,25,13,12) outcome \u0026lt;- gl(3,1,9) treatment \u0026lt;- gl(3,3) D93=data.frame(treatment, outcome, counts) ## showing data ggplot(data = D93, mapping = aes(x = counts)) +geom_bar() 1 2 glm.D93 \u0026lt;- glm(counts ~ outcome + treatment,data = D93, family = poisson()) summary(glm.D93) ## ## Call: ## glm(formula = counts ~ outcome + treatment, family = poisson(), ## data = D93) ## ## Deviance Residuals: ## 1 2 3 4 5 6 7 8 ## -0.67125 0.96272 -0.16965 -0.21999 -0.95552 1.04939 0.84715 -0.09167 ## 9 ## -0.96656 ## ## Coefficients: ## Estimate Std. Error z value Pr(\u0026gt;|z|) ## (Intercept) 3.045e+00 1.709e-01 17.815 \u0026lt;2e-16 *** ## outcome2 -4.543e-01 2.022e-01 -2.247 0.0246 * ## outcome3 -2.930e-01 1.927e-01 -1.520 0.1285 ## treatment2 -3.242e-16 2.000e-01 0.000 1.0000 ## treatment3 -2.148e-16 2.000e-01 0.000 1.0000 ## --- ## Signif. codes: 0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1 ## ## (Dispersion parameter for poisson family taken to be 1) ## ## Null deviance: 10.5814 on 8 degrees of freedom ## Residual deviance: 5.1291 on 4 degrees of freedom ## AIC: 56.761 ## ## Number of Fisher Scoring iterations: 4 é€»è¾‘æ–¯è°›å›å½’ â€¦.\n","date":"2023-03-24T00:00:00Z","image":"/p/r-statistics/index.en_files/figure-html/unnamed-chunk-4-1_hu6a7295393dc4d80def3bf7388e19d776_109022_120x120_fill_box_smart1_3.png","permalink":"/p/r-statistics/","title":"R-statistics"},{"content":"åœ¨Rblogdownä½¿ç”¨stack-themeé‡åˆ°äº†å‡ ä¸ªé—®é¢˜ï¼Œåº”è¯¥æ˜¯Rblogdownä¸åŸç”Ÿhugoé—´çš„ä¸å¤ªå…¼å®¹ã€‚\næˆ‘å¾ˆå¿«å‘ç°äº†é—®é¢˜æ˜¯Rmdäº§ç”Ÿçš„mdæ–‡ä»¶å¯èƒ½è·Ÿstackä¸»é¢˜ä¸å¤ªåŒ¹é…ï¼Œä¸€å¼€å§‹æƒ³çœ‹çœ‹yamlæ–‡ä»¶èƒ½ä¸èƒ½ä¿®æ”¹è§£å†³ï¼Œä½†æ‰¾äº†ä¸å°‘åœ°æ–¹éƒ½æ²¡æ‰¾åˆ°ğŸ˜­ã€‚\nå› ä¸ºé—®é¢˜è¿˜æ¯”è¾ƒç¡®å®šï¼Œå¯ä»¥è¯•è¯•è‡ªå·±å†™è„šæœ¬è½¬æ¢Rmdäº§ç”Ÿçš„mdæ–‡ä»¶ã€‚\nå…¬å¼é—®é¢˜ rblogdown æ¸²æŸ“Rmdæˆmdä¼šæŠŠæˆ‘å†™çš„å…¬å¼è¯­æ³•æ”¹å˜ï¼š\nä¾‹å¦‚ï¼š $a=sum_i^2$å˜æˆ$a=sum_i^2$\nä½†æ˜¯stackä¸»é¢˜è¯†åˆ«ä¸äº†åé¢é‚£ç§è¯­æ³•ï¼Œè¿™ä¸ªæ¯”è¾ƒç®€å•ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 import re # å®šä¹‰ä¸€ä¸ªæ­£åˆ™è¡¨è¾¾å¼ï¼ŒåŒ¹é…LaTeXæ•°å­¦å…¬å¼ä¸­çš„èµ·å§‹å’Œç»“æŸè¡Œå†…æ•°å­¦æ¨¡å¼ç¬¦å· pattern = r\u0026#39;\\\\\\((.*?)\\\\\\)\u0026#39; # å®šä¹‰ä¸€ä¸ªå­—ç¬¦ä¸²ï¼ŒåŒ…å«è¦å¤„ç†çš„LaTeXå­—ç¬¦ä¸² latex_string = r\u0026#39;For the equation$\\sum_{i=1}^n i^2$\u0026#39; # ä½¿ç”¨sub()å‡½æ•°æ›¿æ¢åŒ¹é…åˆ°çš„æ–‡æœ¬ processed_string = re.sub(pattern, r\u0026#39;$\\1$\u0026#39;, latex_string) # è¾“å‡ºå¤„ç†åçš„å­—ç¬¦ä¸² print(processed_string) a=re.sub(r\u0026#39;`\\\\\\((.*?)\\\\\\)`\u0026#39;,r\u0026#39;$\\1$\u0026#39;,$a=sum_i^2$jjjh$a=sum_i^2$\u0026#34;) å›¾ç‰‡å¤§å°è°ƒæ•´ å› ä¸º![from data to viz website](images/data2viz.png){width=60%}è¿™ç§è¯­æ³•æ˜¯stackä¸»é¢˜ä¸æ”¯æŒçš„ï¼Œ ä½†æ˜¯\n1 2 3 \u0026#39;\u0026lt;p style=\u0026#34;text-align: center;\u0026#34;\u0026gt; \u0026lt;img src=\u0026#34;images/data2viz.png\u0026#34; width=\u0026#34;60%\u0026#34; title=\u0026#34;from data to viz website\u0026#34;/\u0026gt; \u0026lt;/p\u0026gt;\u0026#39; è¿™ç§è¯­æ³•æ˜¯æ”¯æŒçš„ï¼Œæ‰€ä»¥æƒ³å†™ä¸€ä¸ªå°è„šæœ¬è½¬æ¢ä¸€ä¸‹\nè‡ªå·±ä¸å¤ªç†Ÿæ‚‰æ­£åˆ™ï¼ˆä¸Šé¢é‚£ä¸ªå…¬å¼è½¬æ¢çš„ä¹Ÿæ˜¯ä»–å¸®æˆ‘å†™çš„ï¼Œå“ˆå“ˆï¼‰ï¼Œæ‰€ä»¥è¯•è¯•é—®äº†ChatGPT ï¼š\nå¯ä»¥å¸®æˆ‘å†™ä¸€ä¸ªå°†æ’å…¥å›¾ç‰‡çš„markdownè¯­æ³•è½¬æ¢ä¸ºhtmlè¯­æ³•çš„å°è„šæœ¬å—ï¼Ÿ æ¯”å¦‚ï¼š![A](B.png){width=60%}è½¬æ¢ä¸º\u0026lt;img src=\u0026quot;B.png\u0026quot; width=\u0026quot;60%\u0026quot; title=\u0026quot;A\u0026quot;/\u0026gt;\nå®ƒç«‹é©¬ç”¨pythonå¸®æˆ‘å†™äº†ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 import re def convert_markdown_to_html(markdown_text): # å°†æ’å…¥å›¾ç‰‡çš„Markdownè¯­æ³•è½¬æ¢ä¸ºHTMLè¯­æ³• pattern = r\u0026#34;!\\[(.*?)\\]\\((.*?)\\){(.*?)}\u0026#34; matches = re.findall(pattern, markdown_text) for match in matches: title = match[0] src = match[1] attributes = match[2].split(\u0026#34;,\u0026#34;) attr_dict = dict([tuple(attribute.split(\u0026#34;=\u0026#34;)) for attribute in attributes]) html_tag = f\u0026#39;\u0026lt;img src=\u0026#34;{src}\u0026#34; title=\u0026#34;{title}\u0026#34;\u0026#39; for key, value in attr_dict.items(): html_tag += f\u0026#39; {key}=\u0026#34;{value}\u0026#34;\u0026#39; html_tag += \u0026#34;/\u0026gt;\u0026#34; markdown_text = markdown_text.replace(f\u0026#34;![{title}]({src}){{{match[2]}}}\u0026#34;, html_tag) return markdown_text def convert_latex_to_md(markdown_text): html_text=re.sub(r\u0026#39;`\\\\\\((.*?)\\\\\\)`\u0026#39;,r\u0026#39;$\\1$\u0026#39;,markdown_text) return html_text def convert_markdown_file_to_html(file_path): # è¯»å–Markdownæ–‡ä»¶ with open(file_path, \u0026#34;r\u0026#34;, encoding=\u0026#34;utf-8\u0026#34;) as f: markdown_text = f.read() # å°†Markdownè¯­æ³•è½¬æ¢ä¸ºHTMLè¯­æ³• html_text = convert_markdown_to_html(markdown_text) html_text = convert_latex_to_md(html_text) # å°†HTMLæ–‡æœ¬å†™å…¥æ–‡ä»¶ with open(file_path, \u0026#34;w\u0026#34;, encoding=\u0026#34;utf-8\u0026#34;) as f: f.write(html_text) if __name__ == \u0026#34;__main__\u0026#34;: file_path = \u0026#34;index.md\u0026#34; convert_markdown_file_to_html(file_path) ç‰›ç‰›ç‰›ï¼ å†é—®ä¸€ä¸‹ï¼Œå¯ä»¥ç”¨Rè¯­è¨€å†™ä¸€ä¸‹å—ï¼Ÿ\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 convert_markdown_to_html \u0026lt;- function(markdown_text) { # é€šè¿‡æ­£åˆ™è¡¨è¾¾å¼åŒ¹é…å›¾ç‰‡è¯­æ³• matches \u0026lt;- gregexpr(\u0026#34;!\\\\[(.*?)\\\\]\\\\((.*?)\\\\){(.*?)}\u0026#34;, markdown_text, perl = TRUE) # éå†åŒ¹é…ç»“æœï¼Œå°†Markdownè¯­æ³•æ›¿æ¢ä¸ºHTMLè¯­æ³• for (i in seq_along(matches[[1]])) { # åˆ¤æ–­åŒ¹é…ç»“æœæ˜¯å¦ä¸ºç©ºåˆ—è¡¨ if (length(matches[[1]][i]) == 0) { next } match \u0026lt;- regmatches(markdown_text, matches[[1]][i]) title \u0026lt;- match[[2]] src \u0026lt;- match[[3]] attributes \u0026lt;- strsplit(match[[4]], \u0026#34;,\u0026#34;)[[1]] attr_dict \u0026lt;- setNames(sapply(strsplit(attributes, \u0026#34;=\u0026#34;), \u0026#34;[\u0026#34;, 2), sapply(strsplit(attributes, \u0026#34;=\u0026#34;), \u0026#34;[\u0026#34;, 1)) # æ„é€ HTMLæ ‡ç­¾ html_tag \u0026lt;- sprintf(\u0026#39;\u0026lt;img src=\u0026#34;%s\u0026#34; title=\u0026#34;%s\u0026#34;\u0026#39;, src, title) for (key in names(attr_dict)) { value \u0026lt;- attr_dict[[key]] html_tag \u0026lt;- paste(html_tag, sprintf(\u0026#39;%s=\u0026#34;%s\u0026#34;\u0026#39;, key, value), sep = \u0026#34; \u0026#34;) } html_tag \u0026lt;- paste(html_tag, \u0026#34;/\u0026gt;\u0026#34;, sep = \u0026#34;\u0026#34;) # å°†Markdownè¯­æ³•æ›¿æ¢ä¸ºHTMLè¯­æ³• markdown_text \u0026lt;- sub(\u0026#34;!\\\\[(.*?)\\\\]\\\\((.*?)\\\\){(.*?)}\u0026#34;, html_tag, markdown_text, fixed = TRUE) } return(markdown_text) } markdown_text \u0026lt;- \u0026#34;![A](B.png){width=60%}\u0026#34; html_text \u0026lt;- convert_markdown_to_html(markdown_text) print(html_text) å”‰ï¼Œå®é™…ä¸Šè¿™ä¸ªä»£ç æ²¡æœ‰ç”¨ï¼Œæˆ‘ä¹Ÿä¸çŸ¥é“bugæ€ä¹ˆæï¼ŒRçš„æ­£åˆ™è¡¨è¾¾å¼ä¸€ç›´æ„Ÿè§‰æ²¡æœ‰pythonå¥½ç”¨ã€‚\nè¿˜æ˜¯ç”¨å†™å¥½çš„pythonè„šæœ¬å§ã€‚\nä¿®æ”¹æ–°çš„mdæ–‡ä»¶ æˆ‘ä»¬è¿˜éœ€è¦æ‰¾åˆ°æœ€æ–°renderå‡ºæ¥çš„mdæ–‡ä»¶æŒ‰ä¸Šè¿°è§„åˆ™è¿›è¡Œä¿®æ”¹ï¼ˆå¦åˆ™ä¸€å£æ°”æ”¹å…¨éƒ¨çš„è¯ï¼Œå®³æ€•ä¼šè¶Šæ¥è¶Šæ…¢ï¼Œç”šè‡³æŸåä»¥å‰çš„mdæ–‡ä»¶ï¼‰ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 import os import datetime # å®šä¹‰è¦æŸ¥æ‰¾çš„ç›®å½• directory = \u0026#39;./content/post/\u0026#39; # å­˜å‚¨æ‰€æœ‰çš„mdæ–‡ä»¶ md_files = [] # é€’å½’æŸ¥æ‰¾ç›®å½•ä¸‹çš„æ‰€æœ‰æ–‡ä»¶ for root, dirs, files in os.walk(directory): for file in files: if file.endswith(\u0026#39;.md\u0026#39;): file_path = os.path.join(root, file) md_files.append((file_path, os.path.getmtime(file_path))) # æ‰¾åˆ°æœ€æ–°ä¿®æ”¹çš„æ–‡ä»¶ latest_file = max(md_files, key=lambda x: x[1])[0] print(\u0026#34;æœ€æ–°ä¿å­˜çš„.mdæ–‡ä»¶æ˜¯ï¼š\u0026#34;, latest_file) å†é—®é—®ï¼Œå¯ä»¥æ‰¾åˆ°ç›®å½•ä¸‹æ‰€æœ‰æ–°ä¿å­˜çš„.mdæ–‡ä»¶å—ï¼Œå°±æ˜¯ä¿®æ”¹æ—¶é—´ä¸ä¸Šæ¬¡ä¸ä¸€è‡´çš„ï¼Ÿ\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 import os import datetime # å®šä¹‰è¦æŸ¥æ‰¾çš„ç›®å½• directory = \u0026#39;./content/\u0026#39; # å­˜å‚¨æ‰€æœ‰æ–°ä¿å­˜çš„mdæ–‡ä»¶ new_md_files = [] # è¯»å–ä¸Šä¸€æ¬¡æ£€æŸ¥çš„æ—¶é—´æˆ³ if os.path.isfile(\u0026#39;last_check_time.txt\u0026#39;): with open(\u0026#39;last_check_time.txt\u0026#39;, \u0026#39;r\u0026#39;) as f: last_check_time = datetime.datetime.strptime(f.read(), \u0026#39;%Y-%m-%d %H:%M:%S.%f\u0026#39;) else: last_check_time = datetime.datetime.now() # é€’å½’æŸ¥æ‰¾ç›®å½•ä¸‹çš„æ‰€æœ‰æ–‡ä»¶ for root, dirs, files in os.walk(directory): for file in files: if file.endswith(\u0026#39;.md\u0026#39;): file_path = os.path.join(root, file) mod_time = datetime.datetime.fromtimestamp(os.path.getmtime(file_path)) if mod_time \u0026gt; last_check_time: new_md_files.append(file_path) # æ›´æ–°ä¸Šä¸€æ¬¡æ£€æŸ¥çš„æ—¶é—´æˆ³ last_check_time = datetime.datetime.now() # å°†ä¸Šä¸€æ¬¡æ£€æŸ¥çš„æ—¶é—´æˆ³ä¿å­˜åˆ°æ–‡ä»¶ä¸­ with open(\u0026#39;last_check_time.txt\u0026#39;, \u0026#39;w\u0026#39;) as f: f.write(last_check_time.strftime(\u0026#39;%Y-%m-%d %H:%M:%S.%f\u0026#39;)) # æ‰“å°æ‰€æœ‰æ–°ä¿å­˜çš„mdæ–‡ä»¶ for file_path in new_md_files: print(\u0026#34;æ–°ä¿å­˜çš„.mdæ–‡ä»¶ï¼š\u0026#34;, file_path) #æ›´æ–°æ‰€æœ‰æ–°ä¿å­˜çš„mdæ–‡ä»¶ for file_path in new_md_files: convert_markdown_file_to_html(latest_file) è¿™ä¸ªæ€è·¯çœŸä¸é”™ï¼Œå“ˆå“ˆ\nè§£å†³æ–¹æ³• è°ƒæ•™äº†ä¸€ä¸‹ChatGPTåï¼Œå°±å¾—åˆ°äº†æ•´ä¸ªæ›´æ–°é—®é¢˜çš„æ–¹æ³•äº†ï¼š é¦–å…ˆæ•´ç†ä¸€ä¸ªrefresh_md_to_fit_stack.pyæ”¾åœ¨ç½‘ç«™æ ¹ç›®å½•ä¸‹ï¼Œ ç„¶ååœ¨Ræ–‡ä»¶å¤¹çš„ï¼ˆå¦‚æœä½ æ˜¯ç”¨Rblogdownç”Ÿæˆçš„ç½‘ç«™ï¼Œé‚£å°±ä¼šæœ‰è¿™ä¸ªæ–‡ä»¶å¤¹ï¼‰çš„build2.Rä¸­åŠ å…¥ä¸€è¡Œï¼š\nsystem(\u0026quot;python refresh_md_to_fit_stack.py\u0026quot;)\nå³å¯ã€‚ å› ä¸ºRblogdownä¼šåœ¨æ¯æ¬¡å®æ—¶æ¸²æŸ“æˆ‘ä»¬çš„ç½‘ç«™åè¿è¡Œbuild2.Ræ–‡ä»¶ï¼Œç›¸å½“äºè¿è¡Œäº†refresh_md_to_fit_stack.pyæ–‡ä»¶ï¼Œè€Œrefresh_md_to_fit_stack.pyæ–‡ä»¶å°†æœç´¢æ‰€æœ‰æ›´æ–°çš„mdæ–‡ä»¶å¹¶ä¿®æ”¹ä»¥ä¸Šä¸¤ä¸ªé—®é¢˜ï¼Œè¿™æ ·hugoå»ºç«‹çš„ç½‘ç«™å°±èƒ½å¤Ÿå¥‘åˆstack-themeã€‚\nçœ‹çœ‹ç»“æœï¼š å¦‚æœè°ƒè¯•æˆåŠŸçš„è¯ï¼Œä¸‹é¢æ˜¾ç¤ºçš„å³æ˜¯æ­£å¸¸çš„latexå…¬å¼:\n$y=\\frac{1}{2} $\nå¦‚æœä¸æ˜¯ä½¿ç”¨çš„Rblogdownç”Ÿæˆçš„ç½‘ç«™ï¼Œè¿™ç§æ€è·¯çš„æ–¹æ³•ä¹Ÿå¯ä»¥å¸®åŠ©æ”¹å˜stack-themeã€‚\næ­¤å¤–ï¼Œå¦‚æœæ˜¯Rblogdownç”Ÿæˆçš„å…¶ä»–ä¸»é¢˜çš„ç½‘ç«™æœ‰ç±»ä¼¼é—®é¢˜ï¼Œä¹Ÿå¯ä»¥è¿™æ ·ä¿®æ”¹ã€‚\næœ€åï¼ŒChatGPTçœŸä¸é”™ï¼å†æ¥ä¸€ä¸ªæ”»ç•¥\n","date":"2023-03-23T00:00:00Z","image":"/p/chatgpt-stack/ChatGPT_huce8d906dd473ab038e4f784f810328ac_7886_120x120_fill_q75_box_smart1.jpg","permalink":"/p/chatgpt-stack/","title":"ChatGPTå¸®æˆ‘è°ƒæ•´stackä¸»é¢˜"},{"content":"Introduction Zhou, J. \u0026amp; Ning, D. Stochastic Community Assembly: Does It Matter in Microbial Ecology? Microbiol Mol Biol Rev 81, e00002-17 (2017). This review is very comprehensive (1)ï¼\nå‘¨é›†ä¸­è€å¸ˆå®éªŒå®¤çš„é•¿æœŸç ”ç©¶å…´è¶£é›†ä¸­åœ¨ä»åŸºå› ç»„åˆ°ç”Ÿæ€ç³»ç»Ÿçš„ä¸åŒç»„ç»‡å±‚é¢çš„ç¯å¢ƒå¾®ç”Ÿç‰©å­¦ï¼Œå…¶ä¸­ä¸€é¡¹å°±æ˜¯å®åŸºå› ç»„å­¦å’Œå¾®ç”Ÿç‰©ç”Ÿæ€å­¦ï¼šåˆ©ç”¨é«˜é€šé‡åŸºå› ç»„æµ‹åºå’Œç›¸å…³åŸºå› ç»„å­¦æŠ€æœ¯æ£€æŸ¥ä¸åŒæ –æ¯åœ°çš„å¾®ç”Ÿç‰©ç¾¤è½å¤šæ ·æ€§ã€å¾®ç”Ÿç‰©ç”Ÿç‰©åœ°ç†å­¦å’Œå½¢æˆå¾®ç”Ÿç‰©å¤šæ ·æ€§æ¨¡å¼ã€åˆ†å¸ƒå’ŒåŠ¨æ€çš„æœºåˆ¶ï¼›\nUnderstanding the mechanisms controlling community diversity, functions, succession, and biogeography is a central, but poorly understood, topic in ecology, particularly in microbial ecology. Traditional niche-based theory hypothesizes that deterministic factors such as species traits, inter-species interactions (e.g., competition, predation, mutualisms, and trade-offs), and environmental conditions (e.g., pH, temperature, salt, and moisture) govern community structure, which are often referred to as deterministic processes.\nIn contrast, neutral theory assumes that community structures are independent of species traits and governed by stochastic processes of birth, death, colonization, extinction, and speciation.\nAlthough, recently, it has been generally accepted that both deterministic and stochastic processes occur simultaneously in the assembly of local communities, a central debate is on their relative importance in controlling community structure, succession, and biogeography.\nMethods ç›®å‰åœ¨æ–‡ç« ä¸­æ™®éå‡ºç°çš„è®¡ç®—ç¾¤è½æ„å»ºçš„æ–¹æ³•ä¸»è¦æœ‰ä¸‰å¥—ï¼š\n1.Stegen ï¼ˆÎ²NTI \u0026amp; RCbray-basedï¼‰ åŸå§‹çš„æ–‡ç«  (2), (3)\nåœ¨ç¡®å®šæ€§ä¸éšæœºæ€§äºŒåˆ†æ³•çš„èƒŒæ™¯ä¸‹å¡‘é€ å¾®ç”Ÿç‰©ç¾¤è½å¤šæ ·æ€§çš„ç”Ÿæ€è¿‡ç¨‹ã€‚è¯¥æ–¹æ¡ˆæ˜¾ç¤ºäº†åœ¨æ–‡ä¸­è®¨è®ºçš„å‡è®¾ä¸‹ï¼ŒåŸºäºç³»ç»Ÿå‘è‚²å’Œåˆ†ç±»å¤šæ ·æ€§åˆ’åˆ†å„ç§ç”Ÿæ€è¿‡ç¨‹çš„ä¸åŒæ­¥éª¤ã€‚ NTIï¼ˆæœ€è¿‘åˆ†ç±»å•å…ƒæŒ‡æ•°ï¼‰åŸºäºç³»ç»Ÿå‘è‚²å¤šæ ·æ€§æŒ‡æ•° MNTDï¼ˆå¹³å‡æœ€è¿‘åˆ†ç±»å•å…ƒè·ç¦»ï¼‰çš„ç©ºæ¨¡å‹æ£€éªŒï¼ŒRCBrayï¼ˆä¿®æ­£çš„ Raup-Crick æŒ‡æ•°ï¼‰åŸºäº Bray-Curtis çš„ç©ºæ¨¡å‹æ£€éªŒåˆ†ç±»å¤šæ ·æ€§æŒ‡æ•°ã€‚è¿™ä¸¤ä¸ªæ¡†åˆ†åˆ«è¡¨ç¤ºç¡®å®šæ€§é€‰æ‹©å’Œæœªæ”¯é…éƒ¨åˆ†çš„ä¸»è¦ç»„æˆéƒ¨åˆ†ã€‚é™¤äº†å½±å“è¾ƒå°çš„é€‰æ‹©å¤–ï¼Œæœªæ”¯é…éƒ¨åˆ†çš„å¼±é€‰æ‹©ä¹Ÿå¯èƒ½æ˜¯ç”±äºæŠµæ¶ˆäº†æœ‰å½±å“çš„é€‰æ‹©å› ç´ å’Œ/æˆ–ä¸åŒåˆ†ç±»ç¾¤çš„å¯¹æ¯”é€‰æ‹©ã€‚è¯¥å›¾ä¸»è¦æ˜¯æ ¹æ® Stegen ç­‰äººå…ˆå‰æŠ¥å‘Šçš„æ•°æ®åˆ¶ä½œçš„ã€‚\nbeta-NTIï¼ˆnearest taxon indexï¼‰ï¼š ä½¿ç”¨ NTI/NRI æŒ‡ç¤ºå•ä¸ªç¾¤è½å†…å…±å­˜çš„åˆ†ç±»å•å…ƒç›¸æ¯”å¶ç„¶é¢„æœŸçš„å…³ç³»æ›´ä¸ºç´§å¯†è¿˜æ˜¯åˆ†æ•£ï¼Œä½¿ç”¨ Î²NTI/Î²NRI æŒ‡ç¤ºä¸¤ä¸¤ç¾¤è½é—´çš„å˜åŒ–å—ç¡®å®šæ€§æˆ–éšæœºæ€§å› ç´ å½±å“çš„å¤§å°ã€‚ MNTD å³mean-nearest-taxon-distance (æœ€è¿‘ç§é—´å¹³å‡è¿›åŒ–è·ç¦») ï¼Œ å…³äº NTI/NRIã€Î²NTI/Î²NRI çš„ç»“æœè§£é‡Šæ—¶å…¶æ˜¾è‘—æ€§çš„åˆ¤æ–­ä¾æ®æ˜¯å…¶ä¸´ç•Œå€¼æ˜¯å¦å¤§äº|2|ï¼Œå®é™…ä¸Šè¿™æ˜¯ä¾æ®æ ‡å‡†æ­£æ€åˆ†å¸ƒçš„ 95%ç½®ä¿¡åŒºé—´å¾—åˆ°çš„ï¼Œä¸€èˆ¬è®¤ä¸º NRI æˆ–è€… NTI å¤§äº 1.96 æˆ–è€…å°äº-1.96 çš„ç»“æœï¼Œåœ¨ 95%çš„æ°´å¹³æ˜¯æ˜¾è‘—çš„ã€‚\nRCbray: ç›¸å¼‚æŒ‡æ•°çš„ä¸€ç§ã€‚\ncode https://blog.csdn.net/weixin_43367441/article/details/118515090\néå¸¸é‡è¦çš„ä¸€ç‚¹ï¼šè¿™ç±»æ–¹æ³•æ˜¯åŸºäºç³»ç»Ÿå‘è‚²æ ‘æ¨æ–­çš„ï¼Œæ‰€ä»¥ä¸€å®šè¦æœ‰è·Ÿtaxè¡¨å¯¹åº”çš„ç³»ç»Ÿå‘è‚²æ ‘ã€‚ ä½†äº‹å®ä¸Šï¼Œé™¤éç”¨çš„æ˜¯16S/ITSæµ‹åºï¼Œå¦åˆ™æˆ‘ä»¬å¾ˆéš¾ç»™è‡ªå·±çš„æ•°æ®å»ºä¸€ä¸ªæ ‘ã€‚ æ‰€ä»¥ï¼Œæ›¿ä»£æ–¹æ³•æ˜¯åˆ©ç”¨é˜¶å±‚åˆ†ç±»å…³ç³»ï¼ˆç•Œé—¨çº²ç›®ç§‘å±ç§ï¼‰æ¥åšä¸€ä¸ªæ‹Ÿç³»ç»Ÿå‘è‚²æ ‘ï¼ˆæé•¿éƒ½ä¸º1ï¼‰ å‚è§è‡ªå·±å†™çš„df2treeå‡½æ•°\n1 2 3 4 5 data(otutab) df2tree(taxonomy)-\u0026gt;phylo #è®¡ç®— nti_rc(otutab,phylo,metadata[,\u0026#34;Group\u0026#34;,drop=F])-\u0026gt;nti_res ## [1] \u0026quot;Result saved as nti_rc_res.rda\u0026quot; 1 2 3 4 5 #å¯è§†åŒ– nti_res$type=factor(nti_res$type,levels = c(\u0026#34;Homo_S\u0026#34;,\u0026#34;Heter_S\u0026#34;,\u0026#34;Homo_D\u0026#34;,\u0026#34;D_limit\u0026#34;,\u0026#34;Undominated\u0026#34;)) table(nti_res$type,nti_res$variable)%\u0026gt;%reshape2::melt()-\u0026gt;com_p colnames(com_p)=c(\u0026#34;type\u0026#34;,\u0026#34;variable\u0026#34;,\u0026#34;n\u0026#34;) ggplot(com_p,aes(x=variable,y=n))+geom_bar(stat = \u0026#34;identity\u0026#34;,aes(fill=type),position = \u0026#34;fill\u0026#34;) iCAMP ç°åœ¨å¤§å®¶ç»å¸¸ç”¨çš„iCAMPåŒ…å°±æ˜¯åŸºäºè¿™ä¸ªç†è®ºæ¡†æ¶è¿›è¡Œåˆ†æçš„ (4)ã€‚\n2.STï¼ŒNSTï¼ŒMST ï¼ˆstochasticity ratioï¼‰ PNASï¼šNSTæ–¹æ³•å®šé‡ç”Ÿæ€è¿‡ç¨‹ä¸­çš„éšæœºæ€§\nå‘¨è€å¸ˆçš„æ–‡ç« ï¼Œå¼€å‘å‡ºæ–°çš„æ–¹æ³•å¯¹ç”Ÿæ€è¿‡ç¨‹ä¸­çš„éšæœºæ€§è¿›è¡Œäº†å®šé‡ã€‚æå‡ºäº†ä¸€ä¸ªæ–°çš„æŒ‡æ•°ï¼Œnormalized stochasticity ratio (NST)ï¼Œä½œä¸ºç¡®å®šæ€§ä¸»å¯¼ï¼ˆdeterministic, \u0026lt;50%ï¼‰å’Œéšæœºæ€§ä¸»å¯¼ï¼ˆstochastic, \u0026gt;50%ï¼‰çš„è¾¹ç•Œç‚¹ (5)ã€‚\ncode å·²ç»æœ‰ç›¸åº”çš„åŒ…äº†,NST\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 #install.packages(\u0026#34;NST\u0026#34;) library(NST) data(tda) comm=tda$comm bray=beta.g(comm,dist.method=\u0026#34;bray\u0026#34;) bray.3col=dist.3col(bray) group=tda$group tnst=tNST(comm=comm, group=group, rand=20, output.rand=TRUE, nworker=1) #æ£€éªŒå„ç»„STã€NSTçš„åˆ†å¸ƒæƒ…å†µåŠå„ç»„STã€NSTå·®å¼‚çš„æ˜¾è‘—æ€§ã€‚ nst.bt=nst.boot(nst.result=tnst, group=NULL, rand=99, trace=TRUE, two.tail=FALSE, out.detail=FALSE, between.group=FALSE, nworker=1) #STå’ŒNSTç»„é—´è¿›è¡ŒPermutational multivariate ANOVA nst.pova=nst.panova(nst.result=tnst, rand=99) #å¯è§†åŒ– pcutils::group_box(tnst$index.pair.grp,col = 8,group = tnst$index.pair.grp$group) example åœ°ä¸‹æ°´å¾®ç”Ÿç‰©ç¾¤è½æ¼”æ›¿è¿‡ç¨‹ä¸­ä¼°è®¡çš„ NST åŠ¨æ€å˜åŒ–å¯¹ä¹³åŒ–æ¤ç‰©æ²¹æ³¨å…¥çš„å“åº”ã€‚ NST æ˜¯åŸºäº (A) Jaccard å’Œ (B) Ru ziË‡ cka æŒ‡æ ‡ä½¿ç”¨ç©ºæ¨¡å‹ç®—æ³• PF è®¡ç®—çš„ã€‚åœ¨é›¶æ¨¡å‹ PF ä¸­ï¼Œç±»ç¾¤å‘ç”Ÿçš„æ¦‚ç‡ä¸è§‚å¯Ÿåˆ°çš„å‘ç”Ÿé¢‘ç‡æˆæ­£æ¯”ï¼Œå¹¶ä¸”æ¯ä¸ªæ ·æœ¬ä¸­çš„ç±»ç¾¤ä¸°å¯Œåº¦æ˜¯å›ºå®šçš„ï¼ˆ19ï¼‰ã€‚å½“ä½¿ç”¨åŸºäºä¸°åº¦çš„æŒ‡æ ‡ Ru ziË‡ cka æ—¶ï¼Œæ¯ä¸ªæ ·æœ¬ä¸­çš„ç©ºåˆ†ç±»ç¾¤ä¸°åº¦è¢«è®¡ç®—ä¸ºè§‚å¯Ÿåˆ°çš„ä¸ªä½“æ•°é‡çš„éšæœºæŠ½å–ï¼Œå…¶æ¦‚ç‡ä¸æ ·æœ¬ä¸­ç©ºåˆ†ç±»ç¾¤çš„åŒºåŸŸç›¸å¯¹ä¸°åº¦æˆæ¯”ä¾‹ï¼ˆ26ï¼‰ã€‚ W8 æ˜¯æ¤ç‰©æ²¹å¯¹å…¶æ²¡æœ‰å½±å“æˆ–å½±å“æœ€å°çš„å¯¹ç…§äº•ã€‚\n3.Solan NCM åªæœ‰å½“ç‰©ç§æ­»äº¡æˆ–ç¦»å¼€è¿™ä¸ªç³»ç»Ÿæ—¶ï¼Œç¾¤è½ç»“æ„æ‰ä¼šå‘ç”Ÿæ”¹å˜ã€‚æ­¤æ—¶ï¼Œç¦»å¼€ä¸ªä½“çš„ç”Ÿæ€ä½å°±ä¼šç©ºä½™å‡ºæ¥ï¼Œå…¶å®ƒä¸ªä½“ä¼šé€šè¿‡æ¥è‡ªç¾¤è½å¤–çš„è¿ç§»æˆ–ç¾¤è½å†…éƒ¨çš„ç¹æ®–æ¥å¡«è¡¥ç©ºå‡ºçš„ç”Ÿæ€ä½ã€‚å› æ­¤å¯ä»¥æŠŠç¾¤è½çš„åŠ¨æ€æè¿°ä¸ºæ­»äº¡â€”â€”ç¹æ®–/æ‰©æ•£â€”â€”æ­»äº¡è¿™æ ·çš„å¾ªç¯ (6)ã€‚\nè®¡ç®—å…¬å¼ï¼š\n-$Pr(\\frac{N_i+1}{N_i})=(\\frac{N_T-N_i}{N_T})[mp_i+(1+\\alpha_i)(1-m)(\\frac{N_i}{N_T-1})$\n-$Pr(\\frac{N_i}{N_i})=\\frac{N_i}{N_T}[mp_i+{(1+\\alpha_i)}(1-m)(\\frac{N_i-1}{N_T-1})]+(\\frac{N_T-N_i}{N_T})[m(1-p_i)+{red}{(1-\\alpha_i)}(1-m)(\\frac{N_T-N_i-1}{N_T-1})]$\n-$Pr(\\frac{N_i-1}{N_i})=\\frac{N_i}{N_T}[m(1-p_i)+(1-\\alpha_i)(1-m)(\\frac{N_T-N_i}{N_T-1})]$\nç‰©ç§ i å å±…çš„é¢‘ç‡ï¼ˆoccurrence frequency: row sums of binary OTU table/number of sitesï¼‰ä¸ºå…¶æ¦‚ç‡å¯†åº¦å‡½æ•°çš„ç§¯åˆ†ã€‚ æ­¤æ—¶è¯¥åˆ†å¸ƒæ˜¯ä¸€ä¸ªbetaåˆ†å¸ƒï¼Œæˆ‘ä»¬å°±å¯ä»¥åœ¨Rè¯­è¨€ä¸­åˆ©ç”¨betaåˆ†å¸ƒå¯¹å…¶è¿›è¡Œ[æ‹Ÿåˆ]ï¼Œè·å¾—å‚æ•°mçš„è¯„ä¼°å€¼ã€‚\ncode 1 2 3 4 library(devtools) install_github(\u0026#34;Russel88/MicEco\u0026#34;) library(MicEco) neutral.fit(t(otutab))#ä½¿ç”¨çš„æ˜¯æœ€å¤§ä¼¼ç„¶ä¼°è®¡æ‹Ÿåˆæ¨¡å‹ï¼ŒR2è®¡ç®—æ–¹æ³•ä¹Ÿä¸åŒ å¦ä¸€ä¸ªä»£ç æ¥è‡ªhttps://mp.weixin.qq.com/s/opFXl-TvkJfmPcWKFwhCFAï¼Œæ¯”è¾ƒç»å…¸ï¼Œç”¨çš„æ˜¯éçº¿æ€§æ¨¡å‹:\nNæè¿°äº†å®ç¾¤è½è§„æ¨¡ï¼ˆmetacommunity sizeï¼‰ï¼Œåœ¨æœ¬æ–‡ä¸­ä¸ºæ¯ä¸ªæ ·æœ¬ä¸­æ‰€æœ‰OTUçš„æ€»ä¸°åº¦ã€‚ mé‡åŒ–äº†ç¾¤è½å±‚é¢çš„è¿ç§»ç‡ï¼ˆmigration rateï¼‰ï¼Œè¯¥å€¼å¯¹äºæ¯ä¸ªç¾¤è½æˆå‘˜éƒ½æ˜¯ç»Ÿä¸€çš„ï¼ˆä¸ç‰©ç§æ— å…³ï¼‰ï¼Œmå€¼è¶Šå°è¯´æ˜æ•´ä¸ªç¾¤è½ä¸­ç‰©ç§æ‰©æ•£è¶Šå—é™åˆ¶ï¼Œåä¹‹må€¼è¶Šé«˜åˆ™è¡¨æ˜ç‰©ç§å—åˆ°æ‰©æ•£é™åˆ¶è¶Šä½ã€‚ Nmæ˜¯å…ƒç¾¤è½è§„æ¨¡ï¼ˆNï¼‰ä¸è¿ç§»ç‡ï¼ˆmï¼‰çš„ä¹˜ç§¯ (Nm = N*m)ï¼Œé‡åŒ–äº†å¯¹ç¾¤è½ä¹‹é—´æ‰©æ•£çš„ä¼°è®¡ï¼Œå†³å®šäº†å‘ç”Ÿé¢‘ç‡å’ŒåŒºåŸŸç›¸å¯¹ä¸°åº¦ä¹‹é—´çš„ç›¸å…³æ€§ã€‚\nè‡ªå·±çš„ç»˜å›¾ä»£ç ï¼š\n1 2 3 data(otutab) ncm(otutab)-\u0026gt;ncm_res plot(ncm_res) R2ä»£è¡¨äº†ä¸­æ€§ç¾¤è½æ¨¡å‹çš„æ•´ä½“æ‹Ÿåˆä¼˜åº¦ï¼ŒR2è¶Šé«˜è¡¨æ˜è¶Šæ¥è¿‘ä¸­æ€§æ¨¡å‹ï¼Œå³ç¾¤è½çš„æ„å»ºå—éšæœºæ€§è¿‡ç¨‹çš„å½±å“è¶Šå¤§ï¼Œå—ç¡®å®šæ€§è¿‡ç¨‹çš„å½±å“è¶Šå°ã€‚\nå€¼å¾—æ³¨æ„ï¼ŒRæ–¹ä¸æ˜¯æŸä¸ªæ•°å€¼çš„å¹³æ–¹ï¼Œå¯ä»¥æ˜¯è´Ÿå€¼ã€‚å› ä¸ºæ‹Ÿåˆç¨‹åº¦æ²¡æœ‰ä¸‹é™ï¼Œå¯ä»¥æ— é™å·®ï¼ŒRæ–¹çš„èŒƒå›´æ˜¯(âˆ’âˆ,1]ã€‚Ræ–¹çš„å–å€¼ï¼Œæœ‰ä»¥ä¸‹çš„å¯èƒ½æ€§ï¼š\nç­‰äº1ã€‚ç†æƒ³çŠ¶å†µï¼Œè¯¥æ¨¡å‹å¯¹æ‰€æœ‰çš„çœŸå€¼é¢„æµ‹å‡†ç¡®ï¼Œæ²¡æœ‰åå·®ã€‚æ³¼ä¸ªå†·æ°´ï¼Œå¦‚æœæŸç¯‡æ–‡ç« é‡Œå‡ºç°äº†Ræ–¹=1ï¼Œè¦ä¹ˆæ˜¯é—®é¢˜è¿‡äºç®€å•æ²¡æœ‰ç ”ç©¶ä»·å€¼ï¼Œè¦ä¹ˆæ˜¯æ¨¡å‹è¿‡äºå¤æ‚ï¼Œå¯¹æ•°æ®è¿›è¡Œäº†è¿‡åº¦æ‹Ÿåˆã€‚\nå°äº1å¤§äº0ã€‚è¿™æ˜¯å¸¸è§çŠ¶å†µï¼Œè¡¨æ˜è¯¥æ¨¡å‹çš„æ‹Ÿåˆæ°´å¹³æ¯”å‡å€¼æ¨¡å‹å¥½ã€‚\nç­‰äº0ã€‚è¯¥æ¨¡å‹çš„æ‹Ÿåˆæ°´å¹³æ¥è¿‘äºå‡å€¼æ¨¡å‹ã€‚è¯¥æ¨¡å‹æ²¡æœ‰ä»·å€¼ã€‚\nå°äº0ã€‚è¯¥æ¨¡å‹çš„æ‹Ÿåˆæ°´å¹³ä¸å¦‚å‡å€¼æ¨¡å‹ã€‚åŒæ ·ï¼Œè¯¥æ¨¡å‹æ²¡æœ‰ä»·å€¼ã€‚\nexample **éšæœºè¿‡ç¨‹ï¼Œä¾‹å¦‚æ•£å¸ƒã€å‡ºç”Ÿã€æ­»äº¡ã€ç­ç»å’Œç§»æ°‘ï¼Œåœ¨å‘¼æ°”ç»†èŒå’ŒçœŸèŒç¾¤è½çš„ç»„è£…ä¸­å‘æŒ¥ä½œç”¨ã€‚**çœŸèŒå¾®ç”Ÿç‰©ç¾¤çš„ SNM æ‹Ÿåˆæ€§èƒ½ï¼ˆå›¾ 2ï¼‰ä¼˜äºç»†èŒï¼ˆç»†èŒ R2 = 0.353ï¼ŒçœŸèŒ R2 = 0.683ï¼‰ã€‚è¿™ç§å·®å¼‚è¡¨æ˜éšæœºè¿‡ç¨‹å¯¹äº EBC çœŸèŒç¾¤è½çš„ç»„è£…å¯èƒ½ç›¸å¯¹æ›´é‡è¦ï¼Œè€Œå¯¹ EBC ç»†èŒç¾¤è½çš„ç»„è£…åˆ™ä¸å¤ªé‡è¦ã€‚è¿™ç§ç°è±¡å¯èƒ½ä¸ç»†èŒå’ŒçœŸèŒä¹‹é—´çš„å¤§å°å·®å¼‚æœ‰å…³ï¼Œè¾ƒå°çš„ç»†èŒå—æ‰©æ•£é™åˆ¶çš„å½±å“è¾ƒå°ï¼Œè€Œå—ç¡®å®šæ€§è¿‡ç¨‹çš„å½±å“æ›´å¤§ (7)ã€‚\nStochastic processes played a role in assembling expiratory bacterial (A) and fungal (B) communities based on Sloan neutral model fitting. The black solid line represents the best fit, and the dotted lines represent the 95% CI (confidence interval) around the model fit. The blue dots refer to taxa that occur more frequently than predicted, and the red dots refer to taxa that occur less frequently than predicted. The green dots refer to taxa that occur in a manner consistent with predicted values.\nåŸæ ¸ç”Ÿç‰©ç»†èƒç›´å¾„å¤§æ¦‚åœ¨0.5 ~ 2.0 Î¼mï¼› å¾®çœŸæ ¸ç”Ÿç‰©ä¸ªä½“å¤§å°å¤§æ¦‚åœ¨1 ~ 200 mmï¼› ä¹‹å‰çš„ç ”ç©¶å·²ç»æŠ¥é“äº†è¾ƒå°çš„ç”Ÿç‰©ä¸å¤ªå¯èƒ½å—åˆ°æ‰©æ•£é™åˆ¶çš„å½±å“ï¼Œå› ä¸ºå®ƒä»¬ä¸è¾ƒå¤§çš„ç”Ÿç‰©ç›¸æ¯”å…·æœ‰æ›´é«˜çš„æ‰©æ•£èƒ½åŠ›ã€‚å› æ­¤å‡è®¾åœ¨ç»†èŒç¾¤è½ä¸­ç”Ÿæ€ä½è¿‡ç¨‹çš„ç›¸å¯¹å½±å“å¯èƒ½æ¯”åœ¨å¾®çœŸæ ¸ç”Ÿç‰©ç¾¤è½ä¸­æ›´å¼ºã€‚å¾®çœŸæ ¸ç”Ÿç‰©ä¸ªä½“å¤§ï¼Œå¯èƒ½ä¼šå½±å“å…¶æ‰©æ•£è¿‡ç¨‹ã€‚\nOthers å‚è€ƒè‡ªå†ç¥å…¬ä¼—å·æ–‡ç« ï¼šhttps://mp.weixin.qq.com/s/nwNuPlY7x6VScJA44c0MjQ\nCompetitive lottery åŸºäºç«äº‰å½©ç¥¨æ¨¡å‹(competitive lottery model)çš„ç¾¤è½æ„å»º å‡è®¾ä¸€ä¸ªä¸¤æ­¥æ¨¡å‹:åœ¨ç¬¬ä¸€æ­¥ä¸­ï¼Œæ ·æœ¬çš„æ€»ä¸°åº¦(100%)æ ¹æ®æŸä¸ªæœªçŸ¥çš„è¿‡ç¨‹åœ¨ç»„ä¹‹é—´åˆ†é…ã€‚ ç„¶ååœ¨ç¬¬äºŒæ­¥ä¸­ï¼Œåˆ†é…ç»™æ¯ä¸ªå°ç»„çš„ä¸°åº¦ä¼šæ ¹æ®ä¸€ä¸ªç«äº‰å½©ç¥¨æ¨¡å¼åœ¨å°ç»„æˆå‘˜ä¹‹é—´è¿›è¡Œåˆ†é…ã€‚ ç«äº‰å½©ç¥¨æ¨¡å‹çš„æ¦‚å¿µè¯´æ˜:\nåœ¨ç¬¬ä¸€é˜¶æ®µï¼Œæ¯ä¸ªæ ·æœ¬çš„æ€»ä¸°åº¦(100%)åœ¨ä¸€ç»„é¢„å®šä¹‰çš„ç»„ä¹‹é—´è¿›è¡Œåˆ†å‰²ã€‚\nåœ¨ç¬¬äºŒé˜¶æ®µï¼Œæ¯ä¸€ç»„çš„ä¸°åº¦åˆ†é…æ ¹æ®ç«äº‰å½©ç¥¨æ¨¡å‹åœ¨å­ç»„ä¹‹é—´è¿›è¡Œåˆ†é…ï¼Œå…¶ä¸­ä¸€ä¸ªå­ç»„è·å¾—äº†å¤§éƒ¨åˆ†çš„ä¸°åº¦ã€‚\nDNCI åœ¨PER-SIMPERæ–¹æ³•çš„åŸºç¡€ä¸Šï¼Œæå‡ºäº†ä¸€ä¸ªæ–°çš„åº¦é‡æŒ‡æ ‡: dispersalâ€“niche continuum index (DNCI)ï¼Œè¯¥æŒ‡æ•°å¯ä¼°è®¡æ˜¯æ‰©æ•£è¿‡ç¨‹è¿˜æ˜¯ç”Ÿæ€ä½è¿‡ç¨‹ä¸»å¯¼ç¾¤è½çš„æ„å»ºï¼Œå¹¶ä¾¿äºä¸åŒæ•°æ®é›†ä¹‹é—´çš„æ¯”è¾ƒã€‚\nPER-SIMPERåˆ©ç”¨ç‰©ç§åœ¨ä¸åŒç«™ç‚¹ä¹‹é—´çš„çŸ©é˜µï¼Œåœ¨æ’åˆ—è¿‡ç¨‹ä¸­ç”Ÿæˆä¸‰ç§ä¸åŒçš„é›¶æ¨¡å‹ï¼š é€šè¿‡çº¦æŸè¡Œ(ç”Ÿæ€ä½æ„å»º)ã€çº¦æŸåˆ—(æ‰©æ•£æ„å»º)æˆ–ä¸¤è€…éƒ½çº¦æŸã€‚ PER-SIMPERåˆ©ç”¨SIMPERæ–¹æ³•å¯¹åŸå§‹ç¾¤è½çŸ©é˜µç»„æˆç›¸ä¼¼åº¦æ¨¡å¼è¿›è¡Œå»ºæ¨¡ï¼Œå¹¶ä¸ä¸‰ä¸ªé›¶æ¨¡å‹æ¯”è¾ƒã€‚ PER-SIMPERé€šè¿‡è¯†åˆ«å“ªä¸ªé›¶æ¨¡å‹ä¸ç»éªŒåˆ†ææœ€åŒ¹é…æ¥è¿›è¡Œå®šæ€§è¯„ä¼°ã€‚ç„¶è€Œï¼Œå¤§å¤šæ•°ç¾¤è½éƒ½æ˜¯ç”±ç”Ÿæ€ä½å’Œæ‰©æ•£è¿‡ç¨‹å…±åŒæ„æˆçš„ï¼Œè¿™é™åˆ¶äº†æ„å»ºæœºåˆ¶å®šæ€§æ–¹æ³•çš„æ•æ„Ÿæ€§ã€‚æ­¤å¤–ç®€å•å†³ç­–è¿‡ç¨‹çš„å®šæ€§ç‰¹æ€§ä½¿ä¸åŒç¾¤è½ä¹‹é—´çš„æ„å»ºè¿‡ç¨‹éš¾ä»¥è¿›è¡Œç²¾ç¡®æ¯”è¾ƒã€‚\nPER-SIMPERåˆ†æè¿”å›ä¸‰ä¸ªE-metricåˆ†å¸ƒ,è¿™ä¸SIMPERç»éªŒå€¼ä¸ä¸‰ä¸ªPER-SIMPERé›¶æ¨¡å‹ä¹‹é—´çš„åå·®ç›¸å…³ã€‚æœ¬æ–‡æå‡ºçš„æ–°çš„DNCIæ˜¯ç”±è¿™äº›è®¡ç®—çš„Eå€¼æ¨å¯¼è€Œæ¥çš„ã€‚ å®šé‡ç»“æœæ˜¯åŸºäºæ ‡å‡†æ•ˆåº”é‡En(å³æ¥è‡ªâ€ç”Ÿæ€ä½â€æ¨¡å‹çš„E-metricåˆ†å¸ƒ)å‡å»æ ‡å‡†æ•ˆåº”é‡Ed (å³æ¥è‡ªâ€æ‰©æ•£â€æ¨¡å‹çš„E-metricåˆ†å¸ƒ)ã€‚ DNCIæä¾›äº†ä¸€ç§æ–¹æ³•æ¥é‡åŒ–å’Œæ¯”è¾ƒè·¨æ•°æ®é›†æ„å»ºè¿‡ç¨‹çš„å¼ºåº¦ã€‚DNCIå€¼æ­£æˆ–è´Ÿè¡¨æ˜ç”Ÿæ€ä½æˆ–åˆ†æ•£è¿‡ç¨‹åˆ†åˆ«æ˜¯ç¾¤ç»„æ„å»ºçš„ä¸»è¦è¿‡ç¨‹ã€‚æŒ‡æ•°çš„ç»å¯¹å€¼è¶Šé«˜ï¼Œä»£è¡¨å ä¸»å¯¼åœ°ä½çš„æ„å»ºè¿‡ç¨‹çš„æ½œåŠ›è¶Šå¤§ã€‚ $DNCI=SES_d-SES_n=\\frac{1}{n}\\sum_{i=1}^n\\left(\\frac{E_{d(i)}-\\overline {E_{dn}}}{\\sigma E_{dn}}\\right)-\\frac{1}{n}\\sum_{i=1}^n\\left(\\frac{E_{n(i)}-\\overline {E_{dn}}}{\\sigma E_{dn}}\\right)$\nå¦‚æœDNCIä¸0å·®å¼‚ä¸æ˜¾è‘—ï¼Œåˆ™å¯ä»¥è®¤ä¸ºæ‰©æ•£è¿‡ç¨‹å’Œç”Ÿæ€ä½è¿‡ç¨‹å¯¹ç¾¤è½æ„å»ºçš„å½±å“æ˜¯ç›¸ç­‰çš„ã€‚ å½“DNCIæ˜¾è‘—ä½äº0æ—¶ï¼Œæ‰©æ•£è¿‡ç¨‹æ˜¯ç¾¤è½æ„å»ºçš„ä¸»å¯¼é©±åŠ¨å› ç´ ; å¦‚æœDNCIæ˜¾è‘—é«˜äº0ï¼Œç”Ÿæ€ä½è¿‡ç¨‹æ˜¯ç¾¤è½æ„å»ºçš„ä¸»è¦å†³å®šå› ç´ ã€‚ æ³¨æ„ï¼Œè¡¨æ˜æ‰©æ•£è¿‡ç¨‹ä¼˜åŠ¿çš„è´ŸDNCIå€¼å¹¶ä¸èƒ½æä¾›å®é™…æ‰©æ•£é€Ÿç‡çš„ä¿¡æ¯ã€‚\nReferences 1. J. Zhou, D. Ning, Stochastic Community Assembly: Does It Matter in Microbial Ecology? Microbiology and Molecular Biology Reviews. 81, e00002â€“17 (2017).\n2. J. C. Stegen, X. Lin, J. K. Fredrickson, X. Chen, D. W. Kennedy, C. J. Murray, M. L. Rockhold, A. Konopka, Quantifying community assembly processes and identifying features that impose them. The ISME Journal. 7, 2069â€“2079 (2013).\n3. J. C. Stegen, X. Lin, A. E. Konopka, J. K. Fredrickson, Stochastic and deterministic assembly processes in subsurface microbial communities. The ISME Journal. 6, 1653â€“1664 (2012).\n4. D. Ning, M. Yuan, L. Wu, Y. Zhang, X. Guo, X. Zhou, Y. Yang, A. P. Arkin, M. K. Firestone, J. Zhou, A quantitative framework reveals ecological drivers of grassland microbial community assembly in response to warming. Nature Communications. 11, 4717 (2020).\n5. D. Ning, Y. Deng, J. M. Tiedje, J. Zhou, A general framework for quantitatively assessing ecological stochasticity. Proceedings of the National Academy of Sciences. 116, 16892â€“16898 (2019).\n6. W. T. Sloan, M. Lunn, S. Woodcock, I. M. Head, S. Nee, T. P. Curtis, Quantifying the roles of immigration and chance in shaping prokaryote community structure. Environmental Microbiology. 8, 732â€“740 (2006).\n7. Y. Zhang, F. Shen, Y. Yang, M. Niu, D. Chen, L. Chen, S. Wang, Y. Zheng, Y. Sun, F. Zhou, H. Qian, Y. Wu, T. Zhu, Insights into the Profile of the Human Expiratory Microbiota and Its Associations with Indoor Microbiotas. Environmental Science \u0026amp; Technology. 56, 6282â€“6293 (2022).\n","date":"2023-03-17T00:00:00Z","image":"/p/community-assembly/comm_hub260f10f12bf64e0acb74c7ee8e930d5_36974_120x120_fill_q75_box_smart1.jpg","permalink":"/p/community-assembly/","title":"å¾®ç”Ÿç‰©ç¾¤è½æ„å»ºï¼ˆcommunity assemblyï¼‰"},{"content":"ç®€ä»‹ linux, pythonå’ŒRè¯­è¨€åº”è¯¥æ˜¯ç”Ÿä¿¡å­¦ä¹ ä¸­æœ€é‡è¦çš„å‡ ä¸ªéƒ¨åˆ†ã€‚\nlinuxæ˜¯ä¸€ç§æ“ä½œç³»ç»Ÿï¼Œç”±äºè®¸å¤šç”Ÿç‰©ä¿¡æ¯å­¦è½¯ä»¶ä»…æä¾›æ”¯æŒlinuxå¹³å°çš„å‘½ä»¤è¡Œç‰ˆæœ¬ï¼Œè€Œä¸æ˜¯å›¾å½¢åŒ–ç•Œé¢ï¼Œæ‰€ä»¥æŒæ¡è¯¥æ“ä½œç³»ç»Ÿçš„åŸºç¡€æ–‡ä»¶ç®¡ç†ï¼Œå®‰è£…ä½¿ç”¨è½¯ä»¶ï¼Œè¾“å…¥è¾“å‡ºé€»è¾‘ï¼Œç®€å•shellè„šæœ¬ç¼–å†™ç­‰ååˆ†é‡è¦ã€‚\npythonä¸Réƒ½æ˜¯å…è´¹å¼€æºå¤šå¹³å°çš„ç¼–ç¨‹è¯­è¨€ï¼Œå¹¶ä¸”éƒ½æ˜¯è¾ƒä¸ºå®¹æ˜“å­¦ä¹ ä¸Šæ‰‹çš„æ¨¡ä»¿è‡ªç„¶è¯­è¨€è¯­æ³•çš„ç¼–ç¨‹è¯­è¨€ï¼Œä¸”æ”¯æŒé¢å‘å¯¹è±¡ç¼–ç¨‹ï¼Œä¸¤è€…åœ¨æ•°æ®ç§‘å­¦ä¸Šéƒ½æœ‰ç€éå¸¸é‡è¦çš„åº”ç”¨ã€‚Pythonçš„ç”Ÿæ€ç³»ç»Ÿéå¸¸ä¸°å¯Œï¼Œæ‹¥æœ‰å¤§é‡çš„æ•°æ®ç§‘å­¦åº“å’Œæ¡†æ¶ï¼Œä¾‹å¦‚ï¼šNumPyã€Pandasã€Matplotlibã€Seabornã€Scikit-learnã€PyTorchã€TensorFlowç­‰ï¼Œè¿™äº›åº“å¯ä»¥å¸®åŠ©æ•°æ®ç§‘å­¦å®¶å¿«é€Ÿå¤„ç†å’Œåˆ†ææ•°æ®ï¼Œæ„å»ºæ¨¡å‹ã€‚\nRæ˜¯ä¸€ç§ä¸“é—¨ç”¨äºç»Ÿè®¡åˆ†æå’Œæ•°æ®å¯è§†åŒ–çš„è¯­è¨€ï¼Œå…¶ç”Ÿæ€ç³»ç»Ÿä¹Ÿéå¸¸ä¸°å¯Œï¼Œæ‹¥æœ‰å¤§é‡çš„ç»Ÿè®¡åˆ†æåº“å’Œå¯è§†åŒ–å·¥å…·ï¼Œä¾‹å¦‚ï¼šggplot2ã€dplyrã€tidyrã€shinyç­‰ã€‚ Ræ‹¥æœ‰éå¸¸å¼ºå¤§çš„æ•°æ®åˆ†æå’Œå¯è§†åŒ–èƒ½åŠ›ï¼Œå®ƒæä¾›äº†å¾ˆå¤šä¸“ä¸šçš„ç»Ÿè®¡åˆ†æå‡½æ•°å’Œå›¾å½¢ï¼Œè¿™äº›å‡½æ•°å’Œå›¾å½¢å¯ä»¥ç›´æ¥ç”¨äºæ•°æ®åˆ†æå’Œå¯è§†åŒ–ï¼Œä½¿åˆ†æå’Œå¯è§†åŒ–å˜å¾—æ›´åŠ è½»æ¾å’Œé«˜æ•ˆã€‚\nåœ¨æ­¤ï¼Œæˆ‘æƒ³å…ˆè®°å½•ä¸€ä¸‹æˆ‘ä½¿ç”¨çš„æœ€å¤šçš„Rè¯­è¨€ã€‚\nå¸¸ç”¨åŠŸèƒ½ å…¨é¢æ•™ç¨‹ å°ç™½ä¸Šæ‰‹é¦–æ¨åŒ—å¤§æè€å¸ˆçš„è¯¾ç¨‹è®²ä¹‰ã€ŠRè¯­è¨€æ•™ç¨‹ã€‹ï¼Œä¸­æ–‡è®²ä¹‰ï¼Œç®€å•æ˜“è¯»ï¼Œç”šè‡³æ•´æœ¬ä¹¦å°±æ˜¯ç”¨Rbookdownç¼–å†™çš„ï¼Œç”µå­ä¹¦ä¹Ÿæ¯”è¾ƒå¥½å¤åˆ¶ä»£ç è¿›è¡Œå­¦ä¹ ã€‚\nã€ŠRè¯­è¨€å®æˆ˜ã€‹,ä¹Ÿæœ‰ä¸­æ–‡ç‰ˆï¼Œä»‹ç»åœ°æ›´åŠ å…¨é¢ä¸”æœ‰ä¸å°‘è¿›é˜¶çŸ¥è¯†ï¼Œå€¼å¾—ä¸€çœ‹ï¼\nç„¶åæ˜¯è‘—åçš„è‹±æ–‡ä¹¦å’Œå‚è€ƒæ‰‹å†Œï¼š\nã€ŠAn Introduction to Rã€‹ ã€ŠR Cookbookã€‹ æ›´å¤šå…³äºRçš„ä¹¦å¯ä»¥åœ¨Home | Bookdownè¿™é‡Œæ‰¾åˆ°ã€‚\næ•°æ®å¤„ç† æˆ‘ç›®å‰ç”¨çš„æœ€å¤šçš„æ˜¯dplyråŒ…è¿›è¡Œæ•°æ®å¤„ç†ï¼Œæœ€å¼€å§‹æ˜¯å†²ç€ç±»ä¼¼linuxä¸‹çš„|ç®¡é“ç¬¦å»çš„ï¼Œ%\u0026gt;%ç¬¦å·çœŸçš„æŒºå¥½ç”¨çš„ï¼Œå¯ä»¥è®©æˆ‘ä»¬æ— éœ€äº§ç”Ÿè®¸å¤šä¸­é—´ç»“æœ (å‡†ç¡®æ¥è¯´%\u0026gt;%æ¥è‡ªmagrittråŒ…ï¼Œå¹¶ä¸”R4.1+ä¹Ÿæ”¯æŒäº†åŸç”Ÿç®¡é“ç¬¦|\u0026gt;ï¼Œä½†ç”¨èµ·æ¥è¿˜æ˜¯%\u0026gt;%é¡ºæ‰‹ï¼Œè¿˜æœ‰%\u0026lt;\u0026gt;%ç­‰å˜ä½“)ï¼š\n1 2 library(dplyr) head(iris)%\u0026gt;%select(Species)%\u0026gt;%unique() éšåä¾¿å‘ç°äº†tidyverseå…¨å®¶æ¡¶ï¼Œå…¶ä¸­åŒ…å«ggplot2ï¼Œtibbleï¼Œdplyrï¼Œreadrï¼Œstringrç­‰å¸¸ç”¨çš„å…¨é¢çš„æ•°æ®å¤„ç†åŒ…ï¼Œèƒ½å¤Ÿå¾ˆå¥½çš„æ»¡è¶³æˆ‘ä»¬ä¸‹æœ‰æ•°æ®å¤„ç†éœ€æ±‚ï¼š\nè¯»å–æ•°æ®\næ¸…æ´—æ•°æ®\nè½¬æ¢æ•°æ®\nåˆå¹¶æ•°æ®\nç­›é€‰æ•°æ®\nå¯è§†åŒ–\nè¿™é‡Œç»™å‡ºå®˜æ–¹æ•™ç¨‹ï¼šã€ŠR for Data Scienceã€‹ï¼Œéå¸¸å»ºè®®ç†Ÿè¯»å¹¶ä½¿ç”¨ã€‚\nå¯è§†åŒ– å¯è§†åŒ–ä¸€ç›´æ˜¯Rçš„çªå‡ºä¼˜ç‚¹ï¼Œbasic graphicå’Œggplotæ˜¯æˆ‘æœ€å¸¸ç”¨çš„ç»˜å›¾ç³»ç»Ÿï¼ˆå¶å°”ä¼šç”¨plotlyç”»ä¸€äº›äº¤äº’å›¾å½¢ï¼Œä½†å¤§å¤šæ•°æ˜¯åªéœ€è¦presentationå’Œæ–‡ç« é‡Œè¦ç”¨çš„é™æ€å›¾å½¢ï¼‰ï¼Œä¸¤è€…çš„ç»˜å›¾é€»è¾‘æœ‰æ‰€å·®å¼‚ï¼Œæ¨èåœ¨å­¦ä¼šRçš„åŸºç¡€ä½¿ç”¨å’Œæ•°æ®å¤„ç†åå°±ä½“éªŒggplotã€‚\nggplotæ˜¯ç”±Hadley Wickhamåˆ›å»ºçš„ï¼Œå¹¶è¢«åŒ…å«åœ¨Rè¯­è¨€çš„ggplot2åŒ…ä¸­ã€‚ä¸»è¦æ€æƒ³æ˜¯å°†æ•°æ®å¯è§†åŒ–çœ‹ä½œæ˜¯å›¾å±‚çš„å †å ï¼Œå…¶ä¸­æ¯ä¸ªå›¾å±‚ä»£è¡¨äº†ä¸€ä¸ªæ•°æ®å±æ€§çš„å¯è§†åŒ–ã€‚ggplotæä¾›äº†ä¸€ç³»åˆ—çš„å‡½æ•°å’Œå‚æ•°ï¼Œè®©ç”¨æˆ·èƒ½å¤Ÿè½»æ¾åœ°ç»„åˆè¿™äº›å›¾å±‚ï¼Œä»¥åŠè°ƒæ•´é¢œè‰²ã€æ ‡ç­¾ã€è½´ç­‰å…¶ä»–å±æ€§ã€‚\nggplotæ”¯æŒçš„å›¾å½¢ç±»å‹åŒ…æ‹¬æ•£ç‚¹å›¾ã€æŠ˜çº¿å›¾ã€ç›´æ–¹å›¾ã€å¯†åº¦å›¾ã€ç®±çº¿å›¾ç­‰ç­‰ï¼Œå¯ä»¥æ»¡è¶³å¤§å¤šæ•°æ•°æ®å¯è§†åŒ–çš„éœ€æ±‚ã€‚ä¼˜ç‚¹åœ¨äºå…¶è¯­æ³•ç®€æ´ã€æ˜“äºç†è§£å’Œä½¿ç”¨ï¼Œå¹¶ä¸”ç”Ÿæˆçš„å›¾è¡¨è´¨é‡é«˜ã€ç¾è§‚ã€æ˜“äºç†è§£ã€‚å®ƒä¹Ÿè¢«å¹¿æ³›åœ°åº”ç”¨äºå­¦æœ¯ç ”ç©¶ã€æ•°æ®åˆ†æã€å•†ä¸šæŠ¥å‘Šç­‰é¢†åŸŸã€‚\nåŒæ ·ç»™å‡ºå®˜æ–¹æ•™ç¨‹ï¼šã€Šggplot2: Elegant Graphics for Data Analysisã€‹ï¼Œä¼˜é›…ï¼Œå¤ªä¼˜é›…äº†ã€‚è¿™æœ¬ä¹¦ä¹Ÿæ˜¯å¯ä»¥æ‰¾åˆ°å¤§ä½¬ä»¬ç¿»è¯‘çš„ä¸­æ–‡ç‰ˆçš„ï¼Œå¯ä»¥å½“ä½œä½œå›¾å·¥å…·ä¹¦ä½¿ç”¨ï¼Œè®¸å¤šæ— æ³•ç›´æ¥Googleåˆ°çš„ç»†èŠ‚é—®é¢˜å¯èƒ½èƒ½åœ¨ä¹¦ä¸­æ‰¾åˆ°ã€‚\næ­¤å¤–è¦æä¸€ä¸‹ggpubråŒ…ï¼Œå…¶åä¸ºPublication Ready Plotsï¼Œæä¾›ä¸€äº›æ–¹ä¾¿çš„åšå‡ºå‡ºç‰ˆçº§figureçš„å‡½æ•°ã€‚ggpubr: Publication Ready Plots - Articles - STHDA è¿™ä¸ªç½‘ç«™æä¾›äº†ä¸å°‘å¥½çœ‹å›¾çš„ç»˜åˆ¶æµç¨‹ã€‚\nå½“æŒæ¡äº†åŸºæœ¬çš„ggplotç»˜åˆ¶é€»è¾‘åï¼Œè¿˜å¯ä»¥å°è¯•å„ç§åŸºäºåŒæ ·é€»è¾‘çš„æ‰©å±•åŒ…ï¼Œå¦‚ggcorï¼Œggtreeç­‰ç­‰ã€‚\ngg_extensions è¿™ä¸ªç½‘ç«™æ”¶é›†äº†å¾ˆå¤šæ­¤ç±»æ‹“å±•åŒ…å¹¶æ”¯æŒåˆ¶ä½œä¸Šä¼ è‡ªåˆ›çš„ggæ‹“å±•ï¼ˆå½“ç„¶æš‚æ—¶æœ‰ç‚¹éš¾ğŸ˜®â€ğŸ’¨ï¼‰\næœ€åï¼Œå¼ºçƒˆæ¨èä¸€ä¸ªä¸ºå¯è§†åŒ–è€Œå»ºçš„ç½‘ç«™From data to Viz | Find the graphic you need (data-to-viz.com)ï¼Œå°±åƒç½‘ç«™åä¸€æ ·ï¼Œä¸°å¯Œå¤šå½©çš„å¯è§†åŒ–å½¢å¼å¸®æˆ‘ä»¬æ‰¾åˆ°é€‚åˆè‡ªå·±æ•°æ®çš„æ ·å¼ï¼Œå¹¶æä¾›ç”»æŸä¸€ç±»å›¾çš„pythonï¼ŒRç”šè‡³D3.jsä»£ç ï¼ŒçœŸçš„éå¸¸æ–¹ä¾¿åœ°copyä»£ç ï¼Œæ›¿æ¢æˆ‘ä»¬çš„æ•°æ®ï¼Œå°‘é‡çš„ä¿®æ”¹å°±èƒ½æœ‰å¾ˆä¸é”™çš„æ•ˆæœğŸ˜„ã€‚\nRç¼–ç¨‹ Ræ˜¯ä¸€ä¸ªå®åº“ï¼Œå‡ ä¹æ€»èƒ½åœ¨ä¸Šé¢æ‰¾åˆ°åˆé€‚çš„åŒ…å®ç°æˆ‘ä»¬æƒ³è¦çš„åŠŸèƒ½ï¼Œä½†ä»–ä¹Ÿæ˜¯ä¸€ç§ç¼–ç¨‹è¯­è¨€ï¼Œç†Ÿæ‚‰å…¶ç¼–ç¨‹è¯­æ³•å¯¹è¿›é˜¶ä½¿ç”¨ååˆ†é‡è¦ã€‚\nåŸºæœ¬çš„æ•°æ®è¯»å–ä¸è¾“å‡ºï¼Œif elseã€switchã€forå¾ªç¯ä¸ç®€å•å‡½æ•°ç¼–å†™éœ€è¦æŒæ¡ã€‚\nåŒæ—¶å› ä¸ºRæ˜¯ä¸€ä¸ªæ¯”è¾ƒ\u0026quot;æ…¢\u0026quot;çš„è¯­è¨€ï¼Œå°½é‡ä½¿ç”¨å‘é‡å¼ç¼–ç¨‹ã€applyæ›¿ä»£forå¾ªç¯ã€RCppç¼–å†™å‡½æ•°ç­‰æ–¹æ³•æé«˜å…¶æ•ˆç‡ï¼ˆåé¢å¯èƒ½ä¼šä¸“é—¨è®²è®²ï¼‰ã€‚\nè¿™é‡Œæ¨èå¤§ä½¬çš„ã€ŠAdvanced Rã€‹ï¼Œå¯¹Ré«˜çº§ç¼–ç¨‹æŠ€æœ¯è¿›è¡Œè®²è§£ã€‚\nRmarkdown R Markdownæ˜¯ä¸€ç§æ–‡æœ¬æ ¼å¼å’Œå·¥å…·ï¼Œç”¨äºåˆ›å»ºå…·æœ‰ä»£ç ã€æ–‡æœ¬ã€å›¾å½¢å’Œè¾“å‡ºç»“æœçš„å¯é‡å¤æ€§æŠ¥å‘Šã€‚å®ƒæ˜¯åœ¨Rè¯­è¨€ç¯å¢ƒä¸­å¼€å‘çš„ï¼Œä½†ä¹Ÿå¯ä»¥ä¸å…¶ä»–ç¼–ç¨‹è¯­è¨€ï¼ˆå¦‚Pythonï¼‰ç»“åˆä½¿ç”¨ã€‚\nä½¿ç”¨R Markdownï¼Œæ‚¨å¯ä»¥å°†ä»£ç ã€æ–‡æœ¬å’Œå›¾å½¢ç»„åˆåˆ°ä¸€ä¸ªæ–‡ä»¶ä¸­ï¼Œå¹¶ä½¿ç”¨R Markdownè¯­æ³•å°†å®ƒä»¬ç»„ç»‡æˆç»“æ„åŒ–çš„æ–‡æ¡£ã€‚ç„¶åï¼Œæ‚¨å¯ä»¥ä½¿ç”¨R Markdownç¼–è¯‘å™¨å°†æ–‡æ¡£è½¬æ¢ä¸ºHTMLã€PDFã€Wordæˆ–å…¶ä»–æ ¼å¼çš„æŠ¥å‘Šã€‚\nR Markdownå…·æœ‰ä»¥ä¸‹ä¼˜ç‚¹ï¼š\nå¯é‡å¤æ€§ï¼šæŠ¥å‘Šä¸­çš„æ‰€æœ‰ä»£ç å’Œç»“æœéƒ½æ˜¯å¯é‡å¤çš„ï¼Œè¿™æœ‰åŠ©äºç¡®ä¿ç ”ç©¶ç»“æœçš„å¯é æ€§å’Œé€æ˜åº¦ã€‚\næ•ˆç‡ï¼šä½¿ç”¨R Markdownï¼Œæ‚¨å¯ä»¥åœ¨å•ä¸ªæ–‡ä»¶ä¸­ç»„ç»‡å’Œè®°å½•æ‰€æœ‰å†…å®¹ï¼Œä»è€ŒèŠ‚çœæ—¶é—´å’Œç²¾åŠ›ã€‚\nçµæ´»æ€§ï¼šR Markdownæ”¯æŒå¤šç§æ ¼å¼å’Œè¾“å‡ºé€‰é¡¹ï¼Œå› æ­¤æ‚¨å¯ä»¥æ ¹æ®éœ€è¦è‡ªå®šä¹‰æŠ¥å‘Šçš„æ ·å¼å’Œå¸ƒå±€ã€‚\nYihui Xieå¤§ä½¬çš„å®˜æ–¹æ–‡æ¡£ä»‹ç»ï¼šR Markdown: The Definitive Guide (bookdown.org)\nä»¥åŠå‚è€ƒä¹¦ï¼šR Markdown Cookbook (bookdown.org)\nRbookdown Rçš„bookdownæ‰©å±•åŒ…(https://github.com/rstudio/bookdown) æ˜¯ç»§knitrå’Œrmarkdownæ‰©å±•åŒ…ä¹‹åï¼Œ å¦ä¸€ä¸ªå¢å¼ºmarkdownæ ¼å¼çš„æ‰©å±•ï¼Œ ä½¿å¾—Rmdæ ¼å¼å¯ä»¥æ”¯æŒå…¬å¼ã€å®šç†ã€å›¾è¡¨è‡ªåŠ¨ç¼–å·å’Œå¼•ç”¨ã€é“¾æ¥ï¼Œ æ–‡çŒ®å¼•ç”¨å’Œé“¾æ¥ç­‰é€‚ç”¨äºç¼–å†™ä¹¦ç±çš„åŠŸèƒ½ã€‚ç›¸å½“æ–¹ä¾¿ï¼Œæˆ‘ä¹Ÿç¨å¾®å°è¯•å†™äº†ä¸€ä¸‹ï¼šMetaNet Tutorial (asa12138.github.io)ã€‚\nå‚è€ƒä¹¦ï¼šbookdown: Authoring Books and Technical Documents with R Markdown\nRblogdown Ræ‰©å±•åŒ…blogdownå¯ä»¥ä¸Hugoè½¯ä»¶é…åˆåˆ¶ä½œç®€å•çš„é™æ€ç½‘ç«™ã€‚ ç½‘ç«™çš„æ‰€æœ‰æ–‡ä»¶éƒ½å­˜åœ¨äºä¸€ä¸ªç›®å½•ä¸­ï¼Œ åªè¦ä¸Šä¼ åˆ°ä»»æ„çš„ç½‘ç«™æœåŠ¡å™¨å°±å¯ä»¥å‘å¸ƒï¼Œ æ²¡æœ‰ä»»ä½•é™åˆ¶ã€‚è¿™ç¯‡åšå®¢å°±æ˜¯åŸºäºRblogdownå†™çš„ï¼Œè¿˜æ˜¯éå¸¸å‹å¥½æ˜“ä¸Šæ‰‹çš„ã€‚\nå‚è€ƒä¹¦ï¼šblogdown: Creating Websites with R Markdown (bookdown.org)\n3.21æ›´æ–°ï¼š\nå¤§å¤šæ•°ç½‘ç«™çš„ä¿®æ”¹è¦åœ¨themesä¸­å®ç°ï¼Œæ¯”å¦‚æˆ‘ç°åœ¨ä½¿ç”¨çš„ä¸»é¢˜ä¸æ”¯æŒlatexæ¸²æŸ“ï¼Œæƒ³è¦åŠ ä¸Šè¿™ä¸ªåŠŸèƒ½ï¼Œæˆ‘å…ˆæ‰¾åˆ°äº†yihuiå¤§ä½¬çš„ä¸»é¢˜å®ç°è¿™ä¸ªåŠŸèƒ½çš„Javascriptä»£ç ï¼Œå³hugo-lithium/layouts/partials/footer_mathjax.htmlï¼Œç„¶åæŠŠå®ƒå¤åˆ¶åˆ°ç›®å‰ç”¨çš„ä¸»é¢˜çš„footerç›®å½•ä¸‹ï¼ˆå¯èƒ½æ²¡æœ‰è¿™ä¸ªç›®å½•ï¼Œè€Œæ˜¯footer.htmlåŒç›®å½•ä¸‹ï¼‰ï¼Œè®°å¾—åœ¨include.htmlæˆ–è€…å…¶ä»–layoutæ–‡ä»¶ä¸­åŠ å…¥{{ partial \u0026quot;footer/footer_mathjax.html\u0026quot; . }}ï¼Œè¿™æ ·å°±èƒ½é¡ºåˆ©è°ƒç”¨mathjaxäº†ã€‚\nR Presentation R Markdownæ–‡ä»¶(.Rmd)æ”¯æŒç”Ÿæˆç½‘é¡µæ ¼å¼çš„å¹»ç¯ç‰‡(slidy_presentation)ï¼Œ ä»¥åŠLaTeX beameræ ¼å¼çš„PDFå¹»ç¯ç‰‡(beamer_presentation)ï¼Œ å’ŒMicrosoft Officeçš„PowerPointå¹»ç¯ç‰‡(powerpoint_presentation)æ ¼å¼ã€‚\nç›®å‰ç¨å¾®å°è¯•äº†ä¸€äº›Yihuiå¤§ä½¬çš„\u0026quot;å†™è½®çœ¼\u0026quot;åŒ…ï¼Œä½†æ²¡æœ‰è¯•ç€åšè‡ªå·±çš„slidesï¼Œä»¥åæœ‰æœºä¼šä¸€å®šè¯•è¯•ã€‚\nå†™RåŒ… åŒ…æ˜¯å¯é‡ç° R ä»£ç çš„åŸºæœ¬å•å…ƒï¼ŒåŒ…æ‹¬å¯é‡ç”¨çš„ R å‡½æ•°ã€æè¿°å¦‚ä½•ä½¿ç”¨å®ƒä»¬çš„æ–‡æ¡£å’Œç¤ºä¾‹æ•°æ®ã€‚ä¸€ä¸ªåŒ…å°†ä»£ç ã€æ•°æ®ã€æ–‡æ¡£å’Œæµ‹è¯•æ†ç»‘åœ¨ä¸€èµ·ï¼Œå¹¶ä¸”å¾ˆå®¹æ˜“ä¸ä»–äººå…±äº«ã€‚\nç§¯æå°è¯•ï¼ˆä»¥åè®²è®²ï¼‰\nå‚è€ƒä¹¦ï¼šR Packages (2e) (r-pkgs.org)\nåˆ¶ä½œshinyåº”ç”¨ Shiny æ˜¯ä¸€ä¸ª R åŒ…ï¼Œå¯è½»æ¾åœ°ç›´æ¥ä» R æ„å»ºäº¤äº’å¼ Web åº”ç”¨ç¨‹åºã€‚è¿˜å¯ä»¥åœ¨ç½‘é¡µä¸Šæ‰˜ç®¡ç‹¬ç«‹åº”ç”¨ç¨‹åºæˆ–å°†å®ƒä»¬åµŒå…¥ R Markdown æ–‡æ¡£æˆ–æ„å»ºä»ªè¡¨æ¿ï¼Œè¿˜å¯ä»¥ä½¿ç”¨ CSS ä¸»é¢˜ã€html å°éƒ¨ä»¶å’Œ JavaScript æ“ä½œæ‰©å±•æ‚¨çš„ Shiny åº”ç”¨ç¨‹åºã€‚\nç§¯æå°è¯•ï¼ˆä»¥åè®²è®²ï¼‰\nå®˜æ–¹æ•™ç¨‹ï¼šShiny Learning Resources\nå‚è€ƒä¹¦ï¼šMastering Shiny\n","date":"2023-03-16T00:00:00Z","image":"/p/r-learning/images/data2viz_hu2949f787b14e5432e8dbe93255a87ee8_671473_120x120_fill_box_smart1_3.png","permalink":"/p/r-learning/","title":"Rè¯­è¨€å­¦ä¹ "},{"content":"æœ€è¿‘å€’è…¾äº†ä¸å°‘æ–°ç©æ„ï¼Œæ¯”å¦‚è¿™ä¸ªåšå®¢ç³»ç»Ÿï¼Œåœ¨æ­¤å†™ä¸‹ç¬¬ä¸€ç¯‡åšå®¢ã€‚\nä»åˆšå¼€å§‹æ¥è§¦ç”Ÿä¿¡åˆ°ç°åœ¨å·²ç»3å¹´äº†ï¼Œæˆ‘ä¹Ÿä»æœ¬ç§‘ç”Ÿå˜æˆäº†åšå£«ç”Ÿï¼Œä¸“ä¸šä»ç”Ÿç‰©ç§‘å­¦å˜æˆäº†ç”Ÿç‰©ä¿¡æ¯å­¦ã€‚èµ°ä¸Šç§‘ç ”é“è·¯ï¼Œå¯èƒ½æ˜¯ç§ç§å·§åˆä¸é€‰æ‹©çš„ç»“æœï¼Œä½†ç°åœ¨è„‘å­é‡Œæƒ³çš„å°±æ˜¯å°†äºŒåæ¥å¹´çš„å„ç§çŸ¥è¯†è¿ç”¨åœ¨ç ”ç©¶ä¸Šï¼Œåšä¸€äº›æœ‰æ„æ€çš„ä¸œè¥¿ã€‚\nå¸Œæœ›è‡ªå·±æœ‰ç©ºå¯ä»¥å¤šæ›´æ–°ï¼Œå¸®åŠ©è‡ªå·±æ•´ç†æ€è·¯ï¼Œè®°å½•ä¸€äº›å®éªŒå’Œæ•°æ®åˆ†æçš„æ–¹æ³•æŠ€å·§ï¼Œè°ƒèŠ‚ä¸€ä¸‹å¿ƒæƒ…ğŸ˜‚ã€‚\n","date":"2023-03-14T00:00:00Z","image":"/p/%E6%98%A5%E4%B9%8B%E4%BC%8A%E5%A7%8B/spring_hu0533df8c600b6ebf5e775c57536fef00_394558_120x120_fill_q75_box_smart1.jpeg","permalink":"/p/%E6%98%A5%E4%B9%8B%E4%BC%8A%E5%A7%8B/","title":"æ˜¥ä¹‹ä¼Šå§‹"},{"content":"This article offers a sample of basic Markdown syntax that can be used in Hugo content files, also it shows whether basic HTML elements are decorated with CSS in a Hugo theme.\nFormula $a=sum_i^2$ $a=sum_i$\nHeadings The following HTML \u0026lt;h1\u0026gt;â€”\u0026lt;h6\u0026gt; elements represent six levels of section headings. \u0026lt;h1\u0026gt; is the highest section level while \u0026lt;h6\u0026gt; is the lowest.\nH1 H2 H3 H4 H5 H6 Paragraph Xerum, quo qui aut unt expliquam qui dolut labo. Aque venitatiusda cum, voluptionse latur sitiae dolessi aut parist aut dollo enim qui voluptate ma dolestendit peritin re plis aut quas inctum laceat est volestemque commosa as cus endigna tectur, offic to cor sequas etum rerum idem sintibus eiur? Quianimin porecus evelectur, cum que nis nust voloribus ratem aut omnimi, sitatur? Quiatem. Nam, omnis sum am facea corem alique molestrunt et eos evelece arcillit ut aut eos eos nus, sin conecerem erum fuga. Ri oditatquam, ad quibus unda veliamenimin cusam et facea ipsamus es exerum sitate dolores editium rerore eost, temped molorro ratiae volorro te reribus dolorer sperchicium faceata tiustia prat.\nItatur? Quiatae cullecum rem ent aut odis in re eossequodi nonsequ idebis ne sapicia is sinveli squiatum, core et que aut hariosam ex eat.\nBlockquotes The blockquote element represents content that is quoted from another source, optionally with a citation which must be within a footer or cite element, and optionally with in-line changes such as annotations and abbreviations.\nBlockquote without attribution Tiam, ad mint andaepu dandae nostion secatur sequo quae. Note that you can use Markdown syntax within a blockquote.\nBlockquote with attribution Don\u0026rsquo;t communicate by sharing memory, share memory by communicating.\nâ€” Rob Pike1\nTables Tables aren\u0026rsquo;t part of the core Markdown spec, but Hugo supports supports them out-of-the-box.\nName Age Bob 27 Alice 23 Inline Markdown within tables Italics Bold Code italics bold code A B C D E F Lorem ipsum dolor sit amet, consectetur adipiscing elit. Phasellus ultricies, sapien non euismod aliquam, dui ligula tincidunt odio, at accumsan nulla sapien eget ex. Proin eleifend dictum ipsum, non euismod ipsum pulvinar et. Vivamus sollicitudin, quam in pulvinar aliquam, metus elit pretium purus Proin sit amet velit nec enim imperdiet vehicula. Ut bibendum vestibulum quam, eu egestas turpis gravida nec Sed scelerisque nec turpis vel viverra. Vivamus vitae pretium sapien Code Blocks Code block with backticks 1 2 3 4 5 6 7 8 9 10 \u0026lt;!doctype html\u0026gt; \u0026lt;html lang=\u0026#34;en\u0026#34;\u0026gt; \u0026lt;head\u0026gt; \u0026lt;meta charset=\u0026#34;utf-8\u0026#34;\u0026gt; \u0026lt;title\u0026gt;Example HTML5 Document\u0026lt;/title\u0026gt; \u0026lt;/head\u0026gt; \u0026lt;body\u0026gt; \u0026lt;p\u0026gt;Test\u0026lt;/p\u0026gt; \u0026lt;/body\u0026gt; \u0026lt;/html\u0026gt; Code block indented with four spaces \u0026lt;!doctype html\u0026gt; \u0026lt;html lang=\u0026quot;en\u0026quot;\u0026gt; \u0026lt;head\u0026gt; \u0026lt;meta charset=\u0026quot;utf-8\u0026quot;\u0026gt; \u0026lt;title\u0026gt;Example HTML5 Document\u0026lt;/title\u0026gt; \u0026lt;/head\u0026gt; \u0026lt;body\u0026gt; \u0026lt;p\u0026gt;Test\u0026lt;/p\u0026gt; \u0026lt;/body\u0026gt; \u0026lt;/html\u0026gt; Code block with Hugo\u0026rsquo;s internal highlight shortcode 1 2 3 4 5 6 7 8 9 10 \u0026lt;!doctype html\u0026gt; \u0026lt;html lang=\u0026#34;en\u0026#34;\u0026gt; \u0026lt;head\u0026gt; \u0026lt;meta charset=\u0026#34;utf-8\u0026#34;\u0026gt; \u0026lt;title\u0026gt;Example HTML5 Document\u0026lt;/title\u0026gt; \u0026lt;/head\u0026gt; \u0026lt;body\u0026gt; \u0026lt;p\u0026gt;Test\u0026lt;/p\u0026gt; \u0026lt;/body\u0026gt; \u0026lt;/html\u0026gt; Diff code block 1 2 3 4 5 [dependencies.bevy] git = \u0026#34;https://github.com/bevyengine/bevy\u0026#34; rev = \u0026#34;11f52b8c72fc3a568e8bb4a4cd1f3eb025ac2e13\u0026#34; - features = [\u0026#34;dynamic\u0026#34;] + features = [\u0026#34;jpeg\u0026#34;, \u0026#34;dynamic\u0026#34;] List Types Ordered List First item Second item Third item Unordered List List item Another item And another item Nested list Fruit Apple Orange Banana Dairy Milk Cheese Other Elements â€” abbr, sub, sup, kbd, mark GIF is a bitmap image format.\nH2O\nXn + Yn = Zn\nPress CTRL+ALT+Delete to end the session.\nMost salamanders are nocturnal, and hunt for insects, worms, and other small creatures.\nHyperlinked image The above quote is excerpted from Rob Pike\u0026rsquo;s talk during Gopherfest, November 18, 2015.\u0026#160;\u0026#x21a9;\u0026#xfe0e;\n","date":"2019-03-11T00:00:00Z","image":"/p/markdown-syntax-guide/pawel-czerwinski-8uZPynIu-rQ-unsplash_hud7e36f7e20e71be184458283bdae4646_55974_120x120_fill_q75_box_smart1.jpg","permalink":"/p/markdown-syntax-guide/","title":"Markdown Syntax Guide"}]